{"ast":null,"code":"import { isUndefined, isString, DOMEvent, isFunction } from 'maverick.js/std';\nimport { R as coerceToError, U as loadScript } from '../../media-core.js';\nclass HLSLibLoader {\n  constructor(_lib, _context, _callback) {\n    this._lib = _lib;\n    this._context = _context;\n    this._callback = _callback;\n    this._startLoading();\n  }\n  async _startLoading() {\n    this._context.logger?.info(\"\\u{1F3D7}\\uFE0F Loading HLS Library\");\n    const callbacks = {\n      onLoadStart: this._onLoadStart.bind(this),\n      onLoaded: this._onLoaded.bind(this),\n      onLoadError: this._onLoadError.bind(this)\n    };\n    let ctor = await loadHLSScript(this._lib, callbacks);\n    if (isUndefined(ctor) && !isString(this._lib)) ctor = await importHLS(this._lib, callbacks);\n    if (!ctor) return null;\n    if (!ctor.isSupported()) {\n      const message = \"[vidstack]: `hls.js` is not supported in this environment\";\n      this._context.logger?.error(message);\n      this._context.player.dispatchEvent(new DOMEvent(\"hls-unsupported\"));\n      this._context.delegate._dispatch(\"error\", {\n        detail: {\n          message,\n          code: 4\n        }\n      });\n      return null;\n    }\n    return ctor;\n  }\n  _onLoadStart() {\n    {\n      this._context.logger?.infoGroup(\"Starting to load `hls.js`\").labelledLog(\"URL\", this._lib).dispatch();\n    }\n    this._context.player.dispatchEvent(new DOMEvent(\"hls-lib-load-start\"));\n  }\n  _onLoaded(ctor) {\n    {\n      this._context.logger?.infoGroup(\"Loaded `hls.js`\").labelledLog(\"Library\", this._lib).labelledLog(\"Constructor\", ctor).dispatch();\n    }\n    this._context.player.dispatchEvent(new DOMEvent(\"hls-lib-loaded\", {\n      detail: ctor\n    }));\n    this._callback(ctor);\n  }\n  _onLoadError(e) {\n    const error = coerceToError(e);\n    {\n      this._context.logger?.errorGroup(\"Failed to load `hls.js`\").labelledLog(\"Library\", this._lib).labelledLog(\"Error\", e).dispatch();\n    }\n    this._context.player.dispatchEvent(new DOMEvent(\"hls-lib-load-error\", {\n      detail: error\n    }));\n    this._context.delegate._dispatch(\"error\", {\n      detail: {\n        message: error.message,\n        code: 4\n      }\n    });\n  }\n}\nasync function importHLS(loader, callbacks = {}) {\n  if (isUndefined(loader)) return void 0;\n  callbacks.onLoadStart?.();\n  if (loader.prototype && loader.prototype !== Function) {\n    callbacks.onLoaded?.(loader);\n    return loader;\n  }\n  try {\n    const ctor = (await loader())?.default;\n    if (ctor && !!ctor.isSupported) {\n      callbacks.onLoaded?.(ctor);\n    } else {\n      throw Error(true ? \"[vidstack] failed importing `hls.js`. Dynamic import returned invalid constructor.\" : \"\");\n    }\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nasync function loadHLSScript(src, callbacks = {}) {\n  if (!isString(src)) return void 0;\n  callbacks.onLoadStart?.();\n  try {\n    await loadScript(src);\n    if (!isFunction(window.Hls)) {\n      throw Error(true ? \"[vidstack] failed loading `hls.js`. Could not find a valid `Hls` constructor on window\" : \"\");\n    }\n    const ctor = window.Hls;\n    callbacks.onLoaded?.(ctor);\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nexport { HLSLibLoader as H };","map":{"version":3,"names":["isUndefined","isString","DOMEvent","isFunction","R","coerceToError","U","loadScript","HLSLibLoader","constructor","_lib","_context","_callback","_startLoading","logger","info","callbacks","onLoadStart","_onLoadStart","bind","onLoaded","_onLoaded","onLoadError","_onLoadError","ctor","loadHLSScript","importHLS","isSupported","message","error","player","dispatchEvent","delegate","_dispatch","detail","code","infoGroup","labelledLog","dispatch","e","errorGroup","loader","prototype","Function","default","Error","err","src","window","Hls","H"],"sources":["/Users/user/Documents/mobilestreamapp/client/node_modules/vidstack/dist/dev/providers/hls/lib-loader.js"],"sourcesContent":["import { isUndefined, isString, DOMEvent, isFunction } from 'maverick.js/std';\nimport { R as coerceToError, U as loadScript } from '../../media-core.js';\n\nclass HLSLibLoader {\n  constructor(_lib, _context, _callback) {\n    this._lib = _lib;\n    this._context = _context;\n    this._callback = _callback;\n    this._startLoading();\n  }\n  async _startLoading() {\n    this._context.logger?.info(\"\\u{1F3D7}\\uFE0F Loading HLS Library\");\n    const callbacks = {\n      onLoadStart: this._onLoadStart.bind(this),\n      onLoaded: this._onLoaded.bind(this),\n      onLoadError: this._onLoadError.bind(this)\n    };\n    let ctor = await loadHLSScript(this._lib, callbacks);\n    if (isUndefined(ctor) && !isString(this._lib))\n      ctor = await importHLS(this._lib, callbacks);\n    if (!ctor)\n      return null;\n    if (!ctor.isSupported()) {\n      const message = \"[vidstack]: `hls.js` is not supported in this environment\";\n      this._context.logger?.error(message);\n      this._context.player.dispatchEvent(new DOMEvent(\"hls-unsupported\"));\n      this._context.delegate._dispatch(\"error\", { detail: { message, code: 4 } });\n      return null;\n    }\n    return ctor;\n  }\n  _onLoadStart() {\n    {\n      this._context.logger?.infoGroup(\"Starting to load `hls.js`\").labelledLog(\"URL\", this._lib).dispatch();\n    }\n    this._context.player.dispatchEvent(new DOMEvent(\"hls-lib-load-start\"));\n  }\n  _onLoaded(ctor) {\n    {\n      this._context.logger?.infoGroup(\"Loaded `hls.js`\").labelledLog(\"Library\", this._lib).labelledLog(\"Constructor\", ctor).dispatch();\n    }\n    this._context.player.dispatchEvent(\n      new DOMEvent(\"hls-lib-loaded\", {\n        detail: ctor\n      })\n    );\n    this._callback(ctor);\n  }\n  _onLoadError(e) {\n    const error = coerceToError(e);\n    {\n      this._context.logger?.errorGroup(\"Failed to load `hls.js`\").labelledLog(\"Library\", this._lib).labelledLog(\"Error\", e).dispatch();\n    }\n    this._context.player.dispatchEvent(\n      new DOMEvent(\"hls-lib-load-error\", {\n        detail: error\n      })\n    );\n    this._context.delegate._dispatch(\"error\", {\n      detail: { message: error.message, code: 4 }\n    });\n  }\n}\nasync function importHLS(loader, callbacks = {}) {\n  if (isUndefined(loader))\n    return void 0;\n  callbacks.onLoadStart?.();\n  if (loader.prototype && loader.prototype !== Function) {\n    callbacks.onLoaded?.(loader);\n    return loader;\n  }\n  try {\n    const ctor = (await loader())?.default;\n    if (ctor && !!ctor.isSupported) {\n      callbacks.onLoaded?.(ctor);\n    } else {\n      throw Error(\n        true ? \"[vidstack] failed importing `hls.js`. Dynamic import returned invalid constructor.\" : \"\"\n      );\n    }\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nasync function loadHLSScript(src, callbacks = {}) {\n  if (!isString(src))\n    return void 0;\n  callbacks.onLoadStart?.();\n  try {\n    await loadScript(src);\n    if (!isFunction(window.Hls)) {\n      throw Error(\n        true ? \"[vidstack] failed loading `hls.js`. Could not find a valid `Hls` constructor on window\" : \"\"\n      );\n    }\n    const ctor = window.Hls;\n    callbacks.onLoaded?.(ctor);\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\n\nexport { HLSLibLoader as H };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}