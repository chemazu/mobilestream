{"ast":null,"code":"import { ComponentController, defineProp, Component, defineElement } from 'maverick.js/element';\nimport { signal, peek, effect, getScope, scoped, createContext, useContext, StoreFactory, tick, onDispose, computed } from 'maverick.js';\nimport { EventsTarget, DOMEvent, listenEvent, isUndefined, isFunction, waitTimeout, isKeyboardClick, setAttribute, isArray, isNumber, isKeyboardEvent, appendTriggerEvent, isNull, deferredPromise, isString, noop, animationFrameThrottle, setStyle } from 'maverick.js/std';\nimport { i as isHTMLMediaElement } from './providers/type-check.js';\nimport { A as AudioProviderLoader } from './providers/audio/loader.js';\nimport { H as HLSProviderLoader } from './providers/hls/loader.js';\nimport { V as VideoProviderLoader } from './providers/video/loader.js';\nconst LIST_ADD = Symbol(\"LIST_ADD\");\nconst LIST_REMOVE = Symbol(\"LIST_REMOVE\");\nconst LIST_RESET = Symbol(\"LIST_RESET\");\nconst LIST_SELECT = Symbol(\"LIST_SELECT\");\nconst LIST_READONLY = Symbol(\"LIST_READONLY\");\nconst LIST_SET_READONLY = Symbol(\"LIST_SET_READONLY\");\nconst LIST_ON_RESET = Symbol(\"LIST_ON_RESET\");\nconst LIST_ON_REMOVE = Symbol(\"LIST_ON_REMOVE\");\nconst LIST_ON_USER_SELECT = Symbol(\"LIST_ON_USER_SELECT\");\nclass List extends EventsTarget {\n  _items = [];\n  /* @internal */\n  [LIST_READONLY] = false;\n  get length() {\n    return this._items.length;\n  }\n  get readonly() {\n    return this[LIST_READONLY];\n  }\n  /**\n   * Transform list to an array.\n   */\n  toArray() {\n    return [...this._items];\n  }\n  [Symbol.iterator]() {\n    return this._items.values();\n  }\n  /* @internal */\n  [LIST_ADD](item, trigger) {\n    const index = this._items.length;\n    if (!(\"\" + index in this)) {\n      Object.defineProperty(this, index, {\n        get() {\n          return this._items[index];\n        }\n      });\n    }\n    if (this._items.includes(item)) return;\n    this._items.push(item);\n    this.dispatchEvent(new DOMEvent(\"add\", {\n      detail: item,\n      trigger\n    }));\n  }\n  /* @internal */\n  [LIST_REMOVE](item, trigger) {\n    const index = this._items.indexOf(item);\n    if (index >= 0) {\n      this[LIST_ON_REMOVE]?.(item, trigger);\n      this._items.splice(index, 1);\n      this.dispatchEvent(new DOMEvent(\"remove\", {\n        detail: item,\n        trigger\n      }));\n    }\n  }\n  /* @internal */\n  [LIST_RESET](trigger) {\n    for (const item of [...this._items]) this[LIST_REMOVE](item, trigger);\n    this._items = [];\n    this[LIST_SET_READONLY](false, trigger);\n    this[LIST_ON_RESET]?.();\n  }\n  /* @internal */\n  [LIST_SET_READONLY](readonly, trigger) {\n    if (this[LIST_READONLY] === readonly) return;\n    this[LIST_READONLY] = readonly;\n    this.dispatchEvent(new DOMEvent(\"readonly-change\", {\n      detail: readonly,\n      trigger\n    }));\n  }\n}\nvar key = {\n  fullscreenEnabled: 0,\n  fullscreenElement: 1,\n  requestFullscreen: 2,\n  exitFullscreen: 3,\n  fullscreenchange: 4,\n  fullscreenerror: 5,\n  fullscreen: 6\n};\nvar webkit = ['webkitFullscreenEnabled', 'webkitFullscreenElement', 'webkitRequestFullscreen', 'webkitExitFullscreen', 'webkitfullscreenchange', 'webkitfullscreenerror', '-webkit-full-screen'];\nvar moz = ['mozFullScreenEnabled', 'mozFullScreenElement', 'mozRequestFullScreen', 'mozCancelFullScreen', 'mozfullscreenchange', 'mozfullscreenerror', '-moz-full-screen'];\nvar ms = ['msFullscreenEnabled', 'msFullscreenElement', 'msRequestFullscreen', 'msExitFullscreen', 'MSFullscreenChange', 'MSFullscreenError', '-ms-fullscreen'];\n// so it doesn't throw if no window or document\nvar document$1 = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar vendor = 'fullscreenEnabled' in document$1 && Object.keys(key) || webkit[0] in document$1 && webkit || moz[0] in document$1 && moz || ms[0] in document$1 && ms || [];\nvar fscreen = {\n  requestFullscreen: function (element) {\n    return element[vendor[key.requestFullscreen]]();\n  },\n  requestFullscreenFunction: function (element) {\n    return element[vendor[key.requestFullscreen]];\n  },\n  get exitFullscreen() {\n    return document$1[vendor[key.exitFullscreen]].bind(document$1);\n  },\n  get fullscreenPseudoClass() {\n    return \":\" + vendor[key.fullscreen];\n  },\n  addEventListener: function (type, handler, options) {\n    return document$1.addEventListener(vendor[key[type]], handler, options);\n  },\n  removeEventListener: function (type, handler, options) {\n    return document$1.removeEventListener(vendor[key[type]], handler, options);\n  },\n  get fullscreenEnabled() {\n    return Boolean(document$1[vendor[key.fullscreenEnabled]]);\n  },\n  set fullscreenEnabled(val) {},\n  get fullscreenElement() {\n    return document$1[vendor[key.fullscreenElement]];\n  },\n  set fullscreenElement(val) {},\n  get onfullscreenchange() {\n    return document$1[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()];\n  },\n  set onfullscreenchange(handler) {\n    return document$1[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()] = handler;\n  },\n  get onfullscreenerror() {\n    return document$1[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()];\n  },\n  set onfullscreenerror(handler) {\n    return document$1[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()] = handler;\n  }\n};\nvar fscreen$1 = fscreen;\nconst CAN_FULLSCREEN = fscreen$1.fullscreenEnabled;\nclass FullscreenController extends ComponentController {\n  /**\n   * Tracks whether we're the active fullscreen event listener. Fullscreen events can only be\n   * listened to globally on the document so we need to know if they relate to the current host\n   * element or not.\n   */\n  _listening = false;\n  _active = false;\n  get active() {\n    return this._active;\n  }\n  get supported() {\n    return CAN_FULLSCREEN;\n  }\n  onConnect() {\n    listenEvent(fscreen$1, \"fullscreenchange\", this._onFullscreenChange.bind(this));\n    listenEvent(fscreen$1, \"fullscreenerror\", this._onFullscreenError.bind(this));\n  }\n  async onDisconnect() {\n    if (CAN_FULLSCREEN) await this.exit();\n  }\n  _onFullscreenChange(event) {\n    const active = isFullscreen(this.el);\n    if (active === this._active) return;\n    if (!active) this._listening = false;\n    this._active = active;\n    this.dispatch(\"fullscreen-change\", {\n      detail: active,\n      trigger: event\n    });\n  }\n  _onFullscreenError(event) {\n    if (!this._listening) return;\n    this.dispatch(\"fullscreen-error\", {\n      detail: null,\n      trigger: event\n    });\n    this._listening = false;\n  }\n  async enter() {\n    try {\n      this._listening = true;\n      if (!this.el || isFullscreen(this.el)) return;\n      assertFullscreenAPI();\n      return fscreen$1.requestFullscreen(this.el);\n    } catch (error) {\n      this._listening = false;\n      throw error;\n    }\n  }\n  async exit() {\n    if (!this.el || !isFullscreen(this.el)) return;\n    assertFullscreenAPI();\n    return fscreen$1.exitFullscreen();\n  }\n}\nfunction canFullscreen() {\n  return CAN_FULLSCREEN;\n}\nfunction isFullscreen(host) {\n  if (fscreen$1.fullscreenElement === host) return true;\n  try {\n    return host.matches(\n    // @ts-expect-error - `fullscreenPseudoClass` is missing from `@types/fscreen`.\n    fscreen$1.fullscreenPseudoClass);\n  } catch (error) {\n    return false;\n  }\n}\nfunction assertFullscreenAPI() {\n  if (CAN_FULLSCREEN) return;\n  throw Error(\"[vidstack] fullscreen API is not enabled or supported in this environment\");\n}\nconst UA = navigator?.userAgent.toLowerCase();\nconst IS_IOS = /iphone|ipad|ipod|ios|crios|fxios/i.test(UA);\nconst IS_IPHONE = /(iphone|ipod)/gi.test(navigator?.platform);\nconst IS_CHROME = !!window.chrome;\nconst IS_SAFARI = !!window.safari || IS_IOS;\nfunction canOrientScreen() {\n  return !isUndefined(screen.orientation) && isFunction(screen.orientation.lock) && isFunction(screen.orientation.unlock);\n}\nfunction canPlayHLSNatively(video) {\n  if (!video) video = document.createElement(\"video\");\n  return video.canPlayType(\"application/vnd.apple.mpegurl\").length > 0;\n}\nfunction canUsePictureInPicture(video) {\n  return !!document.pictureInPictureEnabled && !video.disablePictureInPicture;\n}\nfunction canUseVideoPresentation(video) {\n  return isFunction(video.webkitSupportsPresentationMode) && isFunction(video.webkitSetPresentationMode);\n}\nasync function canChangeVolume() {\n  const video = document.createElement(\"video\");\n  video.volume = 0.5;\n  await waitTimeout(0);\n  return video.volume === 0.5;\n}\nfunction getMediaSource() {\n  return window?.MediaSource ?? window?.WebKitMediaSource;\n}\nfunction getSourceBuffer() {\n  return window?.SourceBuffer ?? window?.WebKitSourceBuffer;\n}\nfunction isHLSSupported() {\n  const MediaSource = getMediaSource();\n  if (isUndefined(MediaSource)) return false;\n  const isTypeSupported = MediaSource && isFunction(MediaSource.isTypeSupported) && MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\n  const SourceBuffer = getSourceBuffer();\n  const isSourceBufferValid = isUndefined(SourceBuffer) || !isUndefined(SourceBuffer.prototype) && isFunction(SourceBuffer.prototype.appendBuffer) && isFunction(SourceBuffer.prototype.remove);\n  return !!isTypeSupported && !!isSourceBufferValid;\n}\nconst CAN_USE_SCREEN_ORIENTATION_API = canOrientScreen();\nclass ScreenOrientationController extends ComponentController {\n  _type = signal(getScreenOrientation());\n  _locked = signal(false);\n  _currentLock;\n  /**\n   * The current screen orientation type.\n   *\n   * @signal\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation}\n   * @see https://w3c.github.io/screen-orientation/#screen-orientation-types-and-locks\n   */\n  get type() {\n    return this._type();\n  }\n  /**\n   * Whether the screen orientation is currently locked.\n   *\n   * @signal\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation}\n   * @see https://w3c.github.io/screen-orientation/#screen-orientation-types-and-locks\n   */\n  get locked() {\n    return this._locked();\n  }\n  /**\n   * Whether the viewport is in a portrait orientation.\n   *\n   * @signal\n   */\n  get portrait() {\n    return this._type().startsWith(\"portrait\");\n  }\n  /**\n   * Whether the viewport is in a landscape orientation.\n   *\n   * @signal\n   */\n  get landscape() {\n    return this._type().startsWith(\"landscape\");\n  }\n  /**\n   * Whether the native Screen Orientation API is available.\n   */\n  get supported() {\n    return CAN_USE_SCREEN_ORIENTATION_API;\n  }\n  onConnect() {\n    if (CAN_USE_SCREEN_ORIENTATION_API) {\n      listenEvent(screen.orientation, \"change\", this._onOrientationChange.bind(this));\n    } else {\n      const query = window.matchMedia(\"(orientation: landscape)\");\n      query.onchange = this._onOrientationChange.bind(this);\n      return () => query.onchange = null;\n    }\n  }\n  async onDisconnect() {\n    if (CAN_USE_SCREEN_ORIENTATION_API && this._locked()) await this.unlock();\n  }\n  _onOrientationChange(event) {\n    this._type.set(getScreenOrientation());\n    this.dispatch(\"orientation-change\", {\n      detail: {\n        orientation: peek(this._type),\n        lock: this._currentLock\n      },\n      trigger: event\n    });\n  }\n  /**\n   * Locks the orientation of the screen to the desired orientation type using the\n   * Screen Orientation API.\n   *\n   * @param lockType - The screen lock orientation type.\n   * @throws Error - If screen orientation API is unavailable.\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation}\n   * @see {@link https://w3c.github.io/screen-orientation}\n   */\n  async lock(lockType) {\n    if (peek(this._locked) || this._currentLock === lockType) return;\n    assertScreenOrientationAPI();\n    await screen.orientation.lock(lockType);\n    this._locked.set(true);\n    this._currentLock = lockType;\n  }\n  /**\n   * Unlocks the orientation of the screen to it's default state using the Screen Orientation\n   * API. This method will throw an error if the API is unavailable.\n   *\n   * @throws Error - If screen orientation API is unavailable.\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation}\n   * @see {@link https://w3c.github.io/screen-orientation}\n   */\n  async unlock() {\n    if (!peek(this._locked)) return;\n    assertScreenOrientationAPI();\n    this._currentLock = void 0;\n    await screen.orientation.unlock();\n    this._locked.set(false);\n  }\n}\nfunction assertScreenOrientationAPI() {\n  if (CAN_USE_SCREEN_ORIENTATION_API) return;\n  throw Error(\"[vidstack] screen orientation API is not available\");\n}\nfunction getScreenOrientation() {\n  if (CAN_USE_SCREEN_ORIENTATION_API) return window.screen.orientation.type;\n  return window.innerWidth >= window.innerHeight ? \"landscape-primary\" : \"portrait-primary\";\n}\nfunction setAttributeIfEmpty(target, name, value) {\n  if (!target.hasAttribute(name)) target.setAttribute(name, value);\n}\nfunction setARIALabel(target, label) {\n  if (target.hasAttribute(\"aria-label\") || target.hasAttribute(\"aria-describedby\")) return;\n  function updateAriaDescription() {\n    setAttribute(target, \"aria-label\", label());\n  }\n  effect(updateAriaDescription);\n}\nfunction isElementParent(owner, node, test) {\n  while (node) {\n    if (node === owner) {\n      return true;\n    } else if (node.localName === owner.localName || test?.(node)) {\n      break;\n    } else {\n      node = node.parentElement;\n    }\n  }\n  return false;\n}\nfunction onPress(target, handler) {\n  listenEvent(target, \"pointerup\", event => {\n    if (event.button === 0) handler(event);\n  });\n  listenEvent(target, \"keydown\", event => {\n    if (isKeyboardClick(event)) handler(event);\n  });\n}\nfunction scopedRaf(callback) {\n  const scope = getScope();\n  requestAnimationFrame(() => scoped(callback, scope));\n}\nconst mediaContext = createContext();\nfunction useMedia() {\n  return useContext(mediaContext);\n}\nconst MEDIA_ATTRIBUTES = [\"autoplay\", \"autoplayError\", \"canFullscreen\", \"canPictureInPicture\", \"canLoad\", \"canPlay\", \"canSeek\", \"ended\", \"error\", \"fullscreen\", \"loop\", \"live\", \"liveEdge\", \"mediaType\", \"muted\", \"paused\", \"pictureInPicture\", \"playing\", \"playsinline\", \"seeking\", \"started\", \"streamType\", \"userIdle\", \"viewType\", \"waiting\"];\nconst MEDIA_KEY_SHORTCUTS = {\n  togglePaused: \"k Space\",\n  toggleMuted: \"m\",\n  toggleFullscreen: \"f\",\n  togglePictureInPicture: \"i\",\n  toggleCaptions: \"c\",\n  seekBackward: \"ArrowLeft\",\n  seekForward: \"ArrowRight\",\n  volumeUp: \"ArrowUp\",\n  volumeDown: \"ArrowDown\"\n};\nconst MODIFIER_KEYS = /* @__PURE__ */new Set([\"Shift\", \"Alt\", \"Meta\", \"Control\"]),\n  BUTTON_SELECTORS = 'button, [role=\"button\"]',\n  IGNORE_SELECTORS = 'input, textarea, select, [contenteditable], [role^=\"menuitem\"]';\nclass MediaKeyboardController extends ComponentController {\n  constructor(instance, _media) {\n    super(instance);\n    this._media = _media;\n  }\n  onConnect() {\n    effect(this._onTargetChange.bind(this));\n  }\n  _onTargetChange() {\n    const {\n      keyDisabled,\n      keyTarget\n    } = this.$props;\n    if (keyDisabled()) return;\n    const target = keyTarget() === \"player\" ? this.el : document,\n      $active = signal(false);\n    if (target === this.el) {\n      this.listen(\"focusin\", () => $active.set(true));\n      this.listen(\"focusout\", event => {\n        if (!this.el.contains(event.target)) $active.set(false);\n      });\n    } else {\n      if (!peek($active)) $active.set(document.querySelector(\"media-player\") === this.el);\n      listenEvent(document, \"focusin\", event => {\n        const activePlayer = event.composedPath().find(el => el instanceof Element && el.localName === \"media-player\");\n        if (activePlayer !== void 0) $active.set(this.el === activePlayer);\n      });\n    }\n    effect(() => {\n      if (!$active()) return;\n      listenEvent(target, \"keyup\", this._onKeyUp.bind(this));\n      listenEvent(target, \"keydown\", this._onKeyDown.bind(this));\n      listenEvent(target, \"keydown\", this._onPreventVideoKeys.bind(this), {\n        capture: true\n      });\n    });\n  }\n  _onKeyUp(event) {\n    const focused = document.activeElement,\n      sliderFocused = focused?.hasAttribute(\"data-media-slider\");\n    if (!event.key || !this.$store.canSeek() || sliderFocused || focused?.matches(IGNORE_SELECTORS)) {\n      return;\n    }\n    const method = this._getMatchingMethod(event);\n    if (method?.startsWith(\"seek\")) {\n      event.preventDefault();\n      event.stopPropagation();\n      if (this._timeSlider) {\n        this._forwardTimeKeyboardEvent(event);\n        this._timeSlider = null;\n      } else {\n        this._media.remote.seek(this._seekTotal, event);\n        this._seekTotal = void 0;\n      }\n    }\n    if (method?.startsWith(\"volume\")) {\n      const volumeSlider = this.el.querySelector(\"media-volume-slider\");\n      volumeSlider?.dispatchEvent(new DOMEvent(\"keyup\", {\n        trigger: event\n      }));\n    }\n  }\n  _onKeyDown(event) {\n    if (!event.key || MODIFIER_KEYS.has(event.key)) return;\n    const focused = document.activeElement;\n    if (focused?.matches(IGNORE_SELECTORS) || isKeyboardClick(event) && focused?.matches(BUTTON_SELECTORS)) {\n      return;\n    }\n    const sliderFocused = focused?.hasAttribute(\"data-media-slider\"),\n      method = this._getMatchingMethod(event);\n    if (!method && !event.metaKey && /[0-9]/.test(event.key) && !sliderFocused) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._media.remote.seek(this.$store.duration() / 10 * Number(event.key), event);\n      return;\n    }\n    if (!method || /volume|seek/.test(method) && sliderFocused) return;\n    event.preventDefault();\n    event.stopPropagation();\n    switch (method) {\n      case \"seekForward\":\n      case \"seekBackward\":\n        this._seeking(event, method);\n        break;\n      case \"volumeUp\":\n      case \"volumeDown\":\n        const volumeSlider = this.el.querySelector(\"media-volume-slider\");\n        if (volumeSlider) {\n          volumeSlider.dispatchEvent(new DOMEvent(\"keydown\", {\n            trigger: event\n          }));\n        } else {\n          const value = event.shiftKey ? 0.1 : 0.05;\n          this._media.remote.changeVolume(this.$store.volume() + (method === \"volumeUp\" ? +value : -value), event);\n        }\n        break;\n      case \"toggleFullscreen\":\n        this._media.remote.toggleFullscreen(\"prefer-media\", event);\n        break;\n      default:\n        this._media.remote[method]?.(event);\n    }\n  }\n  _onPreventVideoKeys(event) {\n    if (isHTMLMediaElement(event.target) && this._getMatchingMethod(event)) {\n      event.preventDefault();\n    }\n  }\n  _getMatchingMethod(event) {\n    const keyShortcuts = {\n      ...this.$props.keyShortcuts(),\n      ...this._media.ariaKeys\n    };\n    return Object.keys(keyShortcuts).find(method => keyShortcuts[method].split(\" \").some(keys => replaceSymbolKeys(keys).replace(/Control/g, \"Ctrl\").split(\"+\").every(key => MODIFIER_KEYS.has(key) ? event[key.toLowerCase() + \"Key\"] : event.key === key.replace(\"Space\", \" \"))));\n  }\n  _seekTotal;\n  _calcSeekAmount(event, type) {\n    const seekBy = event.shiftKey ? 10 : 5;\n    return this._seekTotal = Math.max(0, Math.min((this._seekTotal ?? this.$store.currentTime()) + (type === \"seekForward\" ? +seekBy : -seekBy), this.$store.duration()));\n  }\n  _timeSlider = null;\n  _forwardTimeKeyboardEvent(event) {\n    this._timeSlider?.dispatchEvent(new DOMEvent(event.type, {\n      trigger: event\n    }));\n  }\n  _seeking(event, type) {\n    if (!this.$store.canSeek()) return;\n    if (!this._timeSlider) this._timeSlider = this.el.querySelector(\"media-time-slider\");\n    if (this._timeSlider) {\n      this._forwardTimeKeyboardEvent(event);\n    } else {\n      this._media.remote.seeking(this._calcSeekAmount(event, type), event);\n    }\n  }\n}\nconst SYMBOL_KEY_MAP = [\"!\", \"@\", \"#\", \"$\", \"%\", \"^\", \"&\", \"*\", \"(\", \")\"];\nfunction replaceSymbolKeys(key) {\n  return key.replace(/Shift\\+(\\d)/g, (_, num) => SYMBOL_KEY_MAP[num - 1]);\n}\nconst mediaPlayerProps = {\n  autoplay: false,\n  aspectRatio: defineProp({\n    value: null,\n    type: {\n      from(value) {\n        if (!value) return null;\n        if (!value.includes(\"/\")) return +value;\n        const [width, height] = value.split(\"/\").map(Number);\n        return +(width / height).toFixed(4);\n      }\n    }\n  }),\n  controls: false,\n  currentTime: 0,\n  crossorigin: null,\n  fullscreenOrientation: \"landscape\",\n  load: \"visible\",\n  logLevel: \"silent\",\n  loop: false,\n  muted: false,\n  paused: true,\n  playsinline: false,\n  playbackRate: 1,\n  poster: \"\",\n  preload: \"metadata\",\n  preferNativeHLS: defineProp({\n    value: false,\n    attribute: \"prefer-native-hls\"\n  }),\n  src: \"\",\n  userIdleDelay: 2e3,\n  viewType: \"unknown\",\n  streamType: \"unknown\",\n  volume: 1,\n  liveEdgeTolerance: 10,\n  minLiveDVRWindow: 60,\n  keyDisabled: false,\n  keyTarget: \"player\",\n  keyShortcuts: MEDIA_KEY_SHORTCUTS,\n  title: \"\",\n  thumbnails: null,\n  textTracks: defineProp({\n    value: [],\n    attribute: false\n  }),\n  smallBreakpointX: 600,\n  largeBreakpointX: 980,\n  smallBreakpointY: 380,\n  largeBreakpointY: 600\n};\nclass TimeRange {\n  _ranges;\n  get length() {\n    return this._ranges.length;\n  }\n  constructor(start, end) {\n    if (isArray(start)) {\n      this._ranges = start;\n    } else if (!isUndefined(start) && !isUndefined(end)) {\n      this._ranges = [[start, end]];\n    } else {\n      this._ranges = [];\n    }\n  }\n  start(index) {\n    throwIfEmpty(this._ranges.length);\n    throwIfOutOfRange(\"start\", index, this._ranges.length - 1);\n    return this._ranges[index][0] ?? Infinity;\n  }\n  end(index) {\n    throwIfEmpty(this._ranges.length);\n    throwIfOutOfRange(\"end\", index, this._ranges.length - 1);\n    return this._ranges[index][1] ?? Infinity;\n  }\n}\nfunction getTimeRangesStart(range) {\n  if (!range.length) return null;\n  let min = range.start(0);\n  for (let i = 1; i < range.length; i++) {\n    const value = range.start(i);\n    if (value < min) min = value;\n  }\n  return min;\n}\nfunction getTimeRangesEnd(range) {\n  if (!range.length) return null;\n  let max = range.end(0);\n  for (let i = 1; i < range.length; i++) {\n    const value = range.end(i);\n    if (value > max) max = value;\n  }\n  return max;\n}\nfunction throwIfEmpty(length) {\n  if (!length) throw new Error(\"`TimeRanges` object is empty.\");\n}\nfunction throwIfOutOfRange(fnName, index, end) {\n  if (!isNumber(index) || index < 0 || index > end) {\n    throw new Error(`Failed to execute '${fnName}' on 'TimeRanges': The index provided (${index}) is non-numeric or out of bounds (0-${end}).`);\n  }\n}\nconst MediaStoreFactory = new StoreFactory({\n  audioTracks: [],\n  audioTrack: null,\n  autoplay: false,\n  autoplayError: void 0,\n  buffered: new TimeRange(),\n  duration: 0,\n  canLoad: false,\n  canFullscreen: false,\n  canPictureInPicture: false,\n  canPlay: false,\n  controls: false,\n  crossorigin: null,\n  poster: \"\",\n  currentTime: 0,\n  ended: false,\n  error: void 0,\n  fullscreen: false,\n  loop: false,\n  logLevel: \"warn\",\n  mediaType: \"unknown\",\n  muted: false,\n  paused: true,\n  played: new TimeRange(),\n  playing: false,\n  playsinline: false,\n  pictureInPicture: false,\n  preload: \"metadata\",\n  playbackRate: 1,\n  qualities: [],\n  quality: null,\n  autoQuality: false,\n  canSetQuality: true,\n  seekable: new TimeRange(),\n  seeking: false,\n  source: {\n    src: \"\",\n    type: \"\"\n  },\n  sources: [],\n  started: false,\n  title: \"\",\n  textTracks: [],\n  textTrack: null,\n  thumbnails: null,\n  thumbnailCues: [],\n  volume: 1,\n  waiting: false,\n  get viewType() {\n    return this.providedViewType !== \"unknown\" ? this.providedViewType : this.mediaType;\n  },\n  get streamType() {\n    return this.providedStreamType !== \"unknown\" ? this.providedStreamType : this.inferredStreamType;\n  },\n  get currentSrc() {\n    return this.source;\n  },\n  get bufferedStart() {\n    return getTimeRangesStart(this.buffered) ?? 0;\n  },\n  get bufferedEnd() {\n    return getTimeRangesEnd(this.buffered) ?? 0;\n  },\n  get seekableStart() {\n    return getTimeRangesStart(this.seekable) ?? 0;\n  },\n  get seekableEnd() {\n    return this.canPlay ? getTimeRangesEnd(this.seekable) ?? Infinity : 0;\n  },\n  get seekableWindow() {\n    return Math.max(0, this.seekableEnd - this.seekableStart);\n  },\n  // ~~ responsive design ~~\n  touchPointer: false,\n  orientation: \"landscape\",\n  mediaWidth: 0,\n  mediaHeight: 0,\n  breakpointX: \"sm\",\n  breakpointY: \"sm\",\n  // ~~ user props ~~\n  userIdle: false,\n  userBehindLiveEdge: false,\n  // ~~ live props ~~\n  liveEdgeTolerance: 10,\n  minLiveDVRWindow: 60,\n  get canSeek() {\n    return /unknown|on-demand|:dvr/.test(this.streamType) && Number.isFinite(this.seekableWindow) && (!this.live || /:dvr/.test(this.streamType) && this.seekableWindow >= this.minLiveDVRWindow);\n  },\n  get live() {\n    return this.streamType.includes(\"live\") || !Number.isFinite(this.duration);\n  },\n  get liveEdgeStart() {\n    return this.live && Number.isFinite(this.seekableEnd) ? Math.max(0, (this.liveSyncPosition ?? this.seekableEnd) - this.liveEdgeTolerance) : 0;\n  },\n  get liveEdge() {\n    return this.live && (!this.canSeek || !this.userBehindLiveEdge && this.currentTime >= this.liveEdgeStart);\n  },\n  get liveEdgeWindow() {\n    return this.live && Number.isFinite(this.seekableEnd) ? this.seekableEnd - this.liveEdgeStart : 0;\n  },\n  // ~~ internal props ~~\n  autoplaying: false,\n  providedViewType: \"unknown\",\n  providedStreamType: \"unknown\",\n  inferredStreamType: \"unknown\",\n  liveSyncPosition: null\n});\nconst DO_NOT_RESET_ON_SRC_CHANGE = /* @__PURE__ */new Set([\"autoplay\", \"breakpointX\", \"breakpointY\", \"canFullscreen\", \"canLoad\", \"canPictureInPicture\", \"controls\", \"fullscreen\", \"logLevel\", \"loop\", \"mediaHeight\", \"mediaWidth\", \"muted\", \"orientation\", \"pictureInPicture\", \"playsinline\", \"poster\", \"preload\", \"providedStreamType\", \"providedViewType\", \"source\", \"sources\", \"textTrack\", \"textTracks\", \"thumbnailCues\", \"thumbnails\", \"title\", \"touchPointer\", \"volume\"]);\nfunction softResetMediaStore($media) {\n  MediaStoreFactory.reset($media, prop => !DO_NOT_RESET_ON_SRC_CHANGE.has(prop));\n  tick();\n}\nconst SELECTED = Symbol(\"SELECTED\");\nclass SelectList extends List {\n  get selected() {\n    return this._items.find(item => item.selected) ?? null;\n  }\n  get selectedIndex() {\n    return this._items.findIndex(item => item.selected);\n  }\n  /* @internal */\n  [LIST_ON_REMOVE](item, trigger) {\n    this[LIST_SELECT](item, false, trigger);\n  }\n  /* @internal */\n  [LIST_ADD](item, trigger) {\n    item[SELECTED] = false;\n    Object.defineProperty(item, \"selected\", {\n      get() {\n        return this[SELECTED];\n      },\n      set: selected => {\n        if (this.readonly) return;\n        this[LIST_ON_USER_SELECT]?.();\n        this[LIST_SELECT](item, selected);\n      }\n    });\n    super[LIST_ADD](item, trigger);\n  }\n  /* @internal */\n  [LIST_SELECT](item, selected, trigger) {\n    if (selected === item[SELECTED]) return;\n    const prev = this.selected;\n    item[SELECTED] = selected;\n    const changed = !selected ? prev === item : prev !== item;\n    if (changed) {\n      if (prev) prev[SELECTED] = false;\n      this.dispatchEvent(new DOMEvent(\"change\", {\n        detail: {\n          prev,\n          current: this.selected\n        },\n        trigger\n      }));\n    }\n  }\n}\nconst SET_AUTO_QUALITY = Symbol(\"SET_AUTO_QUALITY\");\nconst ENABLE_AUTO_QUALITY = Symbol(\"ENABLE_AUTO_QUALITY\");\nclass VideoQualityList extends SelectList {\n  _auto = false;\n  /**\n   * Configures quality switching:\n   *\n   * - `current`: Trigger an immediate quality level switch. This will abort the current fragment\n   * request if any, flush the whole buffer, and fetch fragment matching with current position\n   * and requested quality level.\n   *\n   * - `next`: Trigger a quality level switch for next fragment. This could eventually flush\n   * already buffered next fragment.\n   *\n   * - `load`: Set quality level for next loaded fragment.\n   *\n   * @see {@link https://vidstack.io/docs/player/core-concepts/quality#switch}\n   * @see {@link https://github.com/video-dev/hls.js/blob/master/docs/API.md#quality-switch-control-api}\n   */\n  switch = \"current\";\n  /**\n   * Whether automatic quality selection is enabled.\n   */\n  get auto() {\n    return this._auto || this.readonly;\n  }\n  /* @internal */\n  [ENABLE_AUTO_QUALITY];\n  /* @internal */\n  [LIST_ON_USER_SELECT]() {\n    this[SET_AUTO_QUALITY](false);\n  }\n  /* @internal */\n  [LIST_ON_RESET](trigger) {\n    this[SET_AUTO_QUALITY](false, trigger);\n  }\n  /**\n   * Request automatic quality selection (if supported). This will be a no-op if the list is\n   * `readonly` as that already implies auto-selection.\n   */\n  autoSelect(trigger) {\n    if (this.readonly || this._auto || !this[ENABLE_AUTO_QUALITY]) return;\n    this[ENABLE_AUTO_QUALITY]();\n    this[SET_AUTO_QUALITY](true, trigger);\n  }\n  /* @internal */\n  [SET_AUTO_QUALITY](auto, trigger) {\n    if (this._auto === auto) return;\n    this._auto = auto;\n    this.dispatchEvent(new DOMEvent(\"auto-change\", {\n      detail: auto,\n      trigger\n    }));\n  }\n}\nconst MEDIA_EVENTS = [\"abort\", \"can-play\", \"can-play-through\", \"duration-change\", \"emptied\", \"ended\", \"error\", \"fullscreen-change\", \"loaded-data\", \"loaded-metadata\", \"load-start\", \"media-type-change\", \"pause\", \"play\", \"playing\", \"progress\", \"seeked\", \"seeking\", \"source-change\", \"sources-change\", \"stalled\", \"started\", \"suspend\", \"stream-type-change\", \"replay\",\n// 'time-update',\n\"view-type-change\", \"volume-change\", \"waiting\"];\nclass MediaEventsLogger extends ComponentController {\n  constructor(instance, _media) {\n    super(instance);\n    this._media = _media;\n  }\n  onConnect() {\n    const handler = this._onMediaEvent.bind(this);\n    for (const eventType of MEDIA_EVENTS) this.listen(eventType, handler);\n  }\n  _onMediaEvent(event) {\n    this._media.logger?.infoGroup(`\\u{1F4E1} dispatching \\`${event.type}\\``).labelledLog(\"Media Store\", {\n      ...this.$store\n    }).labelledLog(\"Event\", event).dispatch();\n  }\n}\nclass MediaLoadController extends ComponentController {\n  constructor(instance, _callback) {\n    super(instance);\n    this._callback = _callback;\n  }\n  async onAttach(el) {\n    const load = this.$props.load();\n    if (load === \"eager\") {\n      requestAnimationFrame(this._callback);\n    } else if (load === \"idle\") {\n      const {\n        waitIdlePeriod\n      } = await import('maverick.js/std');\n      waitIdlePeriod(this._callback);\n    } else if (load === \"visible\") {\n      const observer = new IntersectionObserver(entries => {\n        if (entries[0].isIntersecting) {\n          observer.disconnect();\n          this._callback();\n        }\n      });\n      observer.observe(el);\n      return observer.disconnect.bind(observer);\n    }\n  }\n}\nclass MediaPlayerDelegate {\n  constructor(_handle, _media) {\n    this._handle = _handle;\n    this._media = _media;\n  }\n  _dispatch(type, ...init) {\n    this._handle(new DOMEvent(type, init?.[0]));\n  }\n  async _ready(info, trigger) {\n    const {\n      $store,\n      logger\n    } = this._media;\n    if (peek($store.canPlay)) return;\n    this._dispatch(\"can-play\", {\n      detail: info,\n      trigger\n    });\n    tick();\n    {\n      logger?.infoGroup(\"-~-~-~-~-~-~-~-~- \\u2705 MEDIA READY -~-~-~-~-~-~-~-~-\").labelledLog(\"Media Store\", {\n        ...$store\n      }).labelledLog(\"Trigger Event\", trigger).dispatch();\n    }\n    if ($store.canPlay() && $store.autoplay() && !$store.started()) {\n      await this._attemptAutoplay();\n    }\n  }\n  async _attemptAutoplay() {\n    const {\n      player,\n      $store\n    } = this._media;\n    $store.autoplaying.set(true);\n    try {\n      await player.play();\n      this._dispatch(\"autoplay\", {\n        detail: {\n          muted: $store.muted()\n        }\n      });\n    } catch (error) {\n      this._dispatch(\"autoplay-fail\", {\n        detail: {\n          muted: $store.muted(),\n          error\n        }\n      });\n    } finally {\n      $store.autoplaying.set(false);\n    }\n  }\n}\nclass Queue {\n  _queue = /* @__PURE__ */new Map();\n  /**\n   * Queue the given `item` under the given `key` to be processed at a later time by calling\n   * `serve(key)`.\n   */\n  _enqueue(key, item) {\n    if (!this._queue.has(key)) this._queue.set(key, /* @__PURE__ */new Set());\n    this._queue.get(key).add(item);\n  }\n  /**\n   * Process all items in queue for the given `key`.\n   */\n  _serve(key, callback) {\n    const items = this._queue.get(key);\n    if (items) for (const item of items) callback(item);\n    this._queue.delete(key);\n  }\n  /**\n   * Removes all queued items under the given `key`.\n   */\n  _delete(key) {\n    this._queue.delete(key);\n  }\n  /**\n   * The number of items currently queued under the given `key`.\n   */\n  _size(key) {\n    return this._queue.get(key)?.size ?? 0;\n  }\n  /**\n   * Clear all items in the queue.\n   */\n  _reset() {\n    this._queue.clear();\n  }\n}\nfunction coerceToError(error) {\n  return error instanceof Error ? error : Error(JSON.stringify(error));\n}\nclass MediaUserController extends ComponentController {\n  _idleTimer = -2;\n  _delay = 2e3;\n  _pausedTracking = false;\n  _focusedItem = null;\n  /**\n   * Whether the media user is currently idle.\n   */\n  get idling() {\n    return this.$store.userIdle();\n  }\n  /**\n   * The amount of delay in milliseconds while media playback is progressing without user\n   * activity to indicate an idle state.\n   *\n   * @defaultValue 2000\n   */\n  get idleDelay() {\n    return this._delay;\n  }\n  set idleDelay(newDelay) {\n    this._delay = newDelay;\n  }\n  /**\n   * Change the user idle state.\n   */\n  idle(idle, delay = this._delay, trigger) {\n    this._clearIdleTimer();\n    if (!this._pausedTracking) this._requestIdleChange(idle, delay, trigger);\n  }\n  /**\n   * Whether all idle tracking should be paused until resumed again.\n   */\n  pauseIdleTracking(paused, trigger) {\n    this._pausedTracking = paused;\n    if (paused) {\n      this._clearIdleTimer();\n      this._requestIdleChange(false, 0, trigger);\n    }\n  }\n  onConnect() {\n    effect(this._watchPaused.bind(this));\n    listenEvent(this.el, \"play\", this._onMediaPlay.bind(this));\n    listenEvent(this.el, \"pause\", this._onMediaPause.bind(this));\n  }\n  _watchPaused() {\n    if (this.$store.paused()) return;\n    const onStopIdle = this._onStopIdle.bind(this);\n    for (const eventType of [\"pointerup\", \"keydown\"]) {\n      listenEvent(this.el, eventType, onStopIdle);\n    }\n    effect(() => {\n      if (!this.$store.touchPointer()) listenEvent(this.el, \"pointermove\", onStopIdle);\n    });\n  }\n  _onMediaPlay(event) {\n    this.idle(true, this._delay, event);\n  }\n  _onMediaPause(event) {\n    this.idle(false, 0, event);\n  }\n  _clearIdleTimer() {\n    window.clearTimeout(this._idleTimer);\n    this._idleTimer = -1;\n  }\n  _onStopIdle(event) {\n    if (event.MEDIA_GESTURE) return;\n    if (isKeyboardEvent(event)) {\n      if (event.key === \"Escape\") {\n        this.el?.focus();\n        this._focusedItem = null;\n      } else if (this._focusedItem) {\n        event.preventDefault();\n        requestAnimationFrame(() => {\n          this._focusedItem?.focus();\n          this._focusedItem = null;\n        });\n      }\n    }\n    this.idle(false, 0, event);\n    this.idle(true, this._delay, event);\n  }\n  _requestIdleChange(idle, delay, trigger) {\n    if (delay === 0) {\n      this._onIdleChange(idle, trigger);\n      return;\n    }\n    this._idleTimer = window.setTimeout(() => {\n      this._onIdleChange(idle && !this._pausedTracking, trigger);\n    }, delay);\n  }\n  _onIdleChange(idle, trigger) {\n    if (this.$store.userIdle() === idle) return;\n    this.$store.userIdle.set(idle);\n    if (idle && document.activeElement && this.el?.contains(document.activeElement)) {\n      this._focusedItem = document.activeElement;\n      requestAnimationFrame(() => this.el?.focus());\n    }\n    this.dispatch(\"user-idle-change\", {\n      detail: idle,\n      trigger\n    });\n  }\n}\nclass MediaRequestContext {\n  _seeking = false;\n  _looping = false;\n  _replaying = false;\n  _queue = new Queue();\n}\nclass MediaRequestManager extends ComponentController {\n  constructor(instance, _stateMgr, _request, _media) {\n    super(instance);\n    this._stateMgr = _stateMgr;\n    this._request = _request;\n    this._media = _media;\n    this._store = _media.$store;\n    this._provider = _media.$provider;\n    this._user = new MediaUserController(instance);\n    this._fullscreen = new FullscreenController(instance);\n    this._orientation = new ScreenOrientationController(instance);\n  }\n  _user;\n  _fullscreen;\n  _orientation;\n  _store;\n  _provider;\n  onConnect() {\n    effect(this._onIdleDelayChange.bind(this));\n    effect(this._onFullscreenSupportChange.bind(this));\n    effect(this._onPiPSupportChange.bind(this));\n    const names = Object.getOwnPropertyNames(Object.getPrototypeOf(this)),\n      handle = this._handleRequest.bind(this);\n    for (const name of names) {\n      if (name.startsWith(\"media-\")) {\n        this.listen(name, handle);\n      }\n    }\n    this.listen(\"fullscreen-change\", this._onFullscreenChange.bind(this));\n  }\n  _handleRequest(event) {\n    event.stopPropagation();\n    {\n      this._media.logger?.infoGroup(`\\u{1F4EC} received \\`${event.type}\\``).labelledLog(\"Request\", event).dispatch();\n    }\n    if (peek(this._provider)) this[event.type]?.(event);\n  }\n  async _play() {\n    const {\n      canPlay,\n      paused,\n      ended,\n      autoplaying,\n      seekableStart\n    } = this._store;\n    if (!peek(paused)) return;\n    try {\n      const provider = peek(this._provider);\n      throwIfNotReadyForPlayback(provider, peek(canPlay));\n      if (peek(ended)) {\n        provider.currentTime = seekableStart() + 0.1;\n      }\n      return provider.play();\n    } catch (error) {\n      const errorEvent = this.createEvent(\"play-fail\", {\n        detail: coerceToError(error)\n      });\n      errorEvent.autoplay = autoplaying();\n      this._stateMgr._handle(errorEvent);\n      throw error;\n    }\n  }\n  async _pause() {\n    const {\n      canPlay,\n      paused\n    } = this._store;\n    if (peek(paused)) return;\n    const provider = peek(this._provider);\n    throwIfNotReadyForPlayback(provider, peek(canPlay));\n    return provider.pause();\n  }\n  _seekToLiveEdge() {\n    const {\n      canPlay,\n      live,\n      liveEdge,\n      canSeek,\n      liveSyncPosition,\n      seekableEnd,\n      userBehindLiveEdge\n    } = this._store;\n    userBehindLiveEdge.set(false);\n    if (peek(() => !live() || liveEdge() || !canSeek())) return;\n    const provider = peek(this._provider);\n    throwIfNotReadyForPlayback(provider, peek(canPlay));\n    provider.currentTime = liveSyncPosition() ?? seekableEnd() - 2;\n  }\n  _wasPIPActive = false;\n  async _enterFullscreen(target = \"prefer-media\") {\n    const provider = peek(this._provider);\n    const adapter = target === \"prefer-media\" && this._fullscreen.supported || target === \"media\" ? this._fullscreen : provider?.fullscreen;\n    throwIfFullscreenNotSupported(target, adapter);\n    if (adapter.active) return;\n    if (peek(this._store.pictureInPicture)) {\n      this._wasPIPActive = true;\n      await this._exitPictureInPicture();\n    }\n    return adapter.enter();\n  }\n  async _exitFullscreen(target = \"prefer-media\") {\n    const provider = peek(this._provider);\n    const adapter = target === \"prefer-media\" && this._fullscreen.supported || target === \"media\" ? this._fullscreen : provider?.fullscreen;\n    throwIfFullscreenNotSupported(target, adapter);\n    if (!adapter.active) return;\n    if (this._orientation.locked) await this._orientation.unlock();\n    try {\n      const result = await adapter.exit();\n      if (this._wasPIPActive && peek(this._store.canPictureInPicture)) {\n        await this._enterPictureInPicture();\n      }\n      return result;\n    } finally {\n      this._wasPIPActive = false;\n    }\n  }\n  async _enterPictureInPicture() {\n    this._throwIfPIPNotSupported();\n    if (this._store.pictureInPicture()) return;\n    return await this._provider().pictureInPicture.enter();\n  }\n  async _exitPictureInPicture() {\n    this._throwIfPIPNotSupported();\n    if (!this._store.pictureInPicture()) return;\n    return await this._provider().pictureInPicture.exit();\n  }\n  _throwIfPIPNotSupported() {\n    if (this._store.canPictureInPicture()) return;\n    throw Error(`[vidstack] picture-in-picture is not currently available`);\n  }\n  _onIdleDelayChange() {\n    this._user.idleDelay = this.$props.userIdleDelay();\n  }\n  _onFullscreenSupportChange() {\n    const {\n        canLoad,\n        canFullscreen\n      } = this._store,\n      supported = this._fullscreen.supported || this._provider()?.fullscreen?.supported || false;\n    if (canLoad() && peek(canFullscreen) === supported) return;\n    canFullscreen.set(supported);\n  }\n  _onPiPSupportChange() {\n    const {\n        canLoad,\n        canPictureInPicture\n      } = this._store,\n      supported = this._provider()?.pictureInPicture?.supported || false;\n    if (canLoad() && peek(canPictureInPicture) === supported) return;\n    canPictureInPicture.set(supported);\n  }\n  [\"media-audio-track-change-request\"](event) {\n    if (this._media.audioTracks.readonly) {\n      {\n        this._media.logger?.warnGroup(`[vidstack] attempted to change audio track but it is currently read-only`).labelledLog(\"Event\", event).dispatch();\n      }\n      return;\n    }\n    const index = event.detail,\n      track = this._media.audioTracks[index];\n    if (track) {\n      this._request._queue._enqueue(\"audioTrack\", event);\n      track.selected = true;\n    } else {\n      this._media.logger?.warnGroup(\"[vidstack] failed audio track change request (invalid index)\").labelledLog(\"Audio Tracks\", this._media.audioTracks.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n  async [\"media-enter-fullscreen-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"fullscreen\", event);\n      await this._enterFullscreen(event.detail);\n    } catch (error) {\n      this._onFullscreenError(error);\n    }\n  }\n  async [\"media-exit-fullscreen-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"fullscreen\", event);\n      await this._exitFullscreen(event.detail);\n    } catch (error) {\n      this._onFullscreenError(error);\n    }\n  }\n  async _onFullscreenChange(event) {\n    if (!event.detail) return;\n    try {\n      const lockType = peek(this.$props.fullscreenOrientation);\n      if (this._orientation.supported && !isUndefined(lockType)) {\n        await this._orientation.lock(lockType);\n      }\n    } catch (e) {}\n  }\n  _onFullscreenError(error) {\n    this._stateMgr._handle(this.createEvent(\"fullscreen-error\", {\n      detail: coerceToError(error)\n    }));\n  }\n  async [\"media-enter-pip-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"pip\", event);\n      await this._enterPictureInPicture();\n    } catch (error) {\n      this._onPictureInPictureError(error);\n    }\n  }\n  async [\"media-exit-pip-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"pip\", event);\n      await this._exitPictureInPicture();\n    } catch (error) {\n      this._onPictureInPictureError(error);\n    }\n  }\n  _onPictureInPictureError(error) {\n    this._stateMgr._handle(this.createEvent(\"picture-in-picture-error\", {\n      detail: coerceToError(error)\n    }));\n  }\n  [\"media-live-edge-request\"](event) {\n    const {\n      live,\n      liveEdge,\n      canSeek\n    } = this._store;\n    if (!live() || liveEdge() || !canSeek()) return;\n    this._request._queue._enqueue(\"seeked\", event);\n    try {\n      this._seekToLiveEdge();\n    } catch (e) {\n      this._media.logger?.error(\"seek to live edge fail\", e);\n    }\n  }\n  [\"media-loop-request\"]() {\n    window.requestAnimationFrame(async () => {\n      try {\n        this._request._looping = true;\n        this._request._replaying = true;\n        await this._play();\n      } catch (e) {\n        this._request._looping = false;\n        this._request._replaying = false;\n      }\n    });\n  }\n  async [\"media-pause-request\"](event) {\n    if (this._store.paused()) return;\n    try {\n      this._request._queue._enqueue(\"pause\", event);\n      await this._provider().pause();\n    } catch (e) {\n      this._request._queue._delete(\"pause\");\n      this._media.logger?.error(\"pause-fail\", e);\n    }\n  }\n  async [\"media-play-request\"](event) {\n    if (!this._store.paused()) return;\n    try {\n      this._request._queue._enqueue(\"play\", event);\n      await this._provider().play();\n    } catch (e) {\n      const errorEvent = this.createEvent(\"play-fail\", {\n        detail: coerceToError(e)\n      });\n      this._stateMgr._handle(errorEvent);\n    }\n  }\n  [\"media-rate-change-request\"](event) {\n    if (this._store.playbackRate() === event.detail) return;\n    this._request._queue._enqueue(\"rate\", event);\n    this._provider().playbackRate = event.detail;\n  }\n  [\"media-quality-change-request\"](event) {\n    if (this._media.qualities.readonly) {\n      {\n        this._media.logger?.warnGroup(`[vidstack] attempted to change video quality but it is currently read-only`).labelledLog(\"Event\", event).dispatch();\n      }\n      return;\n    }\n    this._request._queue._enqueue(\"quality\", event);\n    const index = event.detail;\n    if (index < 0) {\n      this._media.qualities.autoSelect(event);\n    } else {\n      const quality = this._media.qualities[index];\n      if (quality) {\n        quality.selected = true;\n      } else {\n        this._media.logger?.warnGroup(\"[vidstack] failed quality change request (invalid index)\").labelledLog(\"Qualities\", this._media.qualities.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n      }\n    }\n  }\n  [\"media-resume-user-idle-request\"](event) {\n    this._request._queue._enqueue(\"userIdle\", event);\n    this._user.pauseIdleTracking(false, event);\n  }\n  [\"media-pause-user-idle-request\"](event) {\n    this._request._queue._enqueue(\"userIdle\", event);\n    this._user.pauseIdleTracking(true, event);\n  }\n  [\"media-seek-request\"](event) {\n    const {\n      seekableStart,\n      seekableEnd,\n      ended,\n      canSeek,\n      live,\n      userBehindLiveEdge\n    } = this._store;\n    if (ended()) this._request._replaying = true;\n    this._request._seeking = false;\n    this._request._queue._delete(\"seeking\");\n    const boundTime = Math.min(Math.max(seekableStart() + 0.1, event.detail), seekableEnd() - 0.1);\n    if (!Number.isFinite(boundTime) || !canSeek()) return;\n    this._request._queue._enqueue(\"seeked\", event);\n    this._provider().currentTime = boundTime;\n    if (live() && event.isOriginTrusted && Math.abs(seekableEnd() - boundTime) >= 2) {\n      userBehindLiveEdge.set(true);\n    }\n  }\n  [\"media-seeking-request\"](event) {\n    this._request._queue._enqueue(\"seeking\", event);\n    this._store.seeking.set(true);\n    this._request._seeking = true;\n  }\n  [\"media-start-loading\"](event) {\n    if (this._store.canLoad()) return;\n    this._request._queue._enqueue(\"load\", event);\n    this._stateMgr._handle(this.createEvent(\"can-load\"));\n  }\n  [\"media-text-track-change-request\"](event) {\n    const {\n        index,\n        mode\n      } = event.detail,\n      track = this._media.textTracks[index];\n    if (track) {\n      this._request._queue._enqueue(\"textTrack\", event);\n      track.setMode(mode, event);\n    } else {\n      this._media.logger?.warnGroup(\"[vidstack] failed text track change request (invalid index)\").labelledLog(\"Text Tracks\", this._media.textTracks.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n  [\"media-mute-request\"](event) {\n    if (this._store.muted()) return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._provider().muted = true;\n  }\n  [\"media-unmute-request\"](event) {\n    const {\n      muted,\n      volume\n    } = this._store;\n    if (!muted()) return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._media.$provider().muted = false;\n    if (volume() === 0) {\n      this._request._queue._enqueue(\"volume\", event);\n      this._provider().volume = 0.25;\n    }\n  }\n  [\"media-volume-change-request\"](event) {\n    const {\n      muted,\n      volume\n    } = this._store;\n    const newVolume = event.detail;\n    if (volume() === newVolume) return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._provider().volume = newVolume;\n    if (newVolume > 0 && muted()) {\n      this._request._queue._enqueue(\"volume\", event);\n      this._provider().muted = false;\n    }\n  }\n}\nfunction throwIfNotReadyForPlayback(provider, canPlay) {\n  if (provider && canPlay) return;\n  throw Error(`[vidstack] media is not ready - wait for \\`can-play\\` event.`);\n}\nfunction throwIfFullscreenNotSupported(target, fullscreen) {\n  if (fullscreen?.supported) return;\n  throw Error(`[vidstack] fullscreen is not currently available on target \\`${target}\\``);\n}\nvar functionDebounce = debounce;\nfunction debounce(fn, wait, callFirst) {\n  var timeout = null;\n  var debouncedFn = null;\n  var clear = function () {\n    if (timeout) {\n      clearTimeout(timeout);\n      debouncedFn = null;\n      timeout = null;\n    }\n  };\n  var flush = function () {\n    var call = debouncedFn;\n    clear();\n    if (call) {\n      call();\n    }\n  };\n  var debounceWrapper = function () {\n    if (!wait) {\n      return fn.apply(this, arguments);\n    }\n    var context = this;\n    var args = arguments;\n    var callNow = callFirst && !timeout;\n    clear();\n    debouncedFn = function () {\n      fn.apply(context, args);\n    };\n    timeout = setTimeout(function () {\n      timeout = null;\n      if (!callNow) {\n        var call = debouncedFn;\n        debouncedFn = null;\n        return call();\n      }\n    }, wait);\n    if (callNow) {\n      return debouncedFn();\n    }\n  };\n  debounceWrapper.cancel = clear;\n  debounceWrapper.flush = flush;\n  return debounceWrapper;\n}\nvar functionThrottle = throttle;\nfunction throttle(fn, interval, options) {\n  var timeoutId = null;\n  var throttledFn = null;\n  var leading = options && options.leading;\n  var trailing = options && options.trailing;\n  if (leading == null) {\n    leading = true; // default\n  }\n\n  if (trailing == null) {\n    trailing = !leading; //default\n  }\n\n  if (leading == true) {\n    trailing = false; // forced because there should be invocation per call\n  }\n\n  var cancel = function () {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n      timeoutId = null;\n    }\n  };\n  var flush = function () {\n    var call = throttledFn;\n    cancel();\n    if (call) {\n      call();\n    }\n  };\n  var throttleWrapper = function () {\n    var callNow = leading && !timeoutId;\n    var context = this;\n    var args = arguments;\n    throttledFn = function () {\n      return fn.apply(context, args);\n    };\n    if (!timeoutId) {\n      timeoutId = setTimeout(function () {\n        timeoutId = null;\n        if (trailing) {\n          return throttledFn();\n        }\n      }, interval);\n    }\n    if (callNow) {\n      callNow = false;\n      return throttledFn();\n    }\n  };\n  throttleWrapper.cancel = cancel;\n  throttleWrapper.flush = flush;\n  return throttleWrapper;\n}\nconst ATTACH_VIDEO = Symbol(\"ATTACH_VIDEO\");\nconst TEXT_TRACK_CROSSORIGIN = Symbol(\"TEXT_TRACK_CROSSORIGIN\");\nconst TEXT_TRACK_READY_STATE = Symbol(\"TEXT_TRACK_READY_STATE\");\nconst TEXT_TRACK_UPDATE_ACTIVE_CUES = Symbol(\"TEXT_TRACK_UPDATE_ACTIVE_CUES\");\nconst TEXT_TRACK_CAN_LOAD = Symbol(\"TEXT_TRACK_CAN_LOAD\");\nconst TEXT_TRACK_ON_MODE_CHANGE = Symbol(\"TEXT_TRACK_ON_MODE_CHANGE\");\nconst TEXT_TRACK_NATIVE = Symbol(\"TEXT_TRACK_NATIVE\");\nconst TEXT_TRACK_NATIVE_HLS = Symbol(\"TEXT_TRACK_NATIVE_HLS\");\nconst TRACKED_EVENT = /* @__PURE__ */new Set([\"autoplay\", \"autoplay-fail\", \"can-load\", \"sources-change\", \"source-change\", \"load-start\", \"abort\", \"error\", \"loaded-metadata\", \"loaded-data\", \"can-play\", \"play\", \"play-fail\", \"pause\", \"playing\", \"seeking\", \"seeked\", \"waiting\"]);\nclass MediaStateManager extends ComponentController {\n  constructor(instance, _request, _media) {\n    super(instance);\n    this._request = _request;\n    this._media = _media;\n    this._store = _media.$store;\n  }\n  _store;\n  _trackedEvents = /* @__PURE__ */new Map();\n  _skipInitialSrcChange = true;\n  _firingWaiting = false;\n  _waitingTrigger;\n  onAttach(el) {\n    el.setAttribute(\"aria-busy\", \"true\");\n  }\n  onConnect(el) {\n    this._addTextTrackListeners();\n    this._addQualityListeners();\n    this._addAudioTrackListeners();\n    this.listen(\"fullscreen-change\", this[\"fullscreen-change\"].bind(this));\n    this.listen(\"fullscreen-error\", this[\"fullscreen-error\"].bind(this));\n  }\n  _handle(event) {\n    const type = event.type;\n    this[event.type]?.(event);\n    {\n      if (TRACKED_EVENT.has(type)) this._trackedEvents.set(type, event);\n      this.el?.dispatchEvent(event);\n    }\n  }\n  _resetTracking() {\n    this._stopWaiting();\n    this._request._replaying = false;\n    this._request._looping = false;\n    this._firingWaiting = false;\n    this._waitingTrigger = void 0;\n    this._trackedEvents.clear();\n  }\n  _satisfyRequest(request, event) {\n    this._request._queue._serve(request, requestEvent => {\n      event.request = requestEvent;\n      appendTriggerEvent(event, requestEvent);\n    });\n  }\n  _addTextTrackListeners() {\n    this._onTextTracksChange();\n    this._onTextTrackModeChange();\n    const textTracks = this._media.textTracks;\n    listenEvent(textTracks, \"add\", this._onTextTracksChange.bind(this));\n    listenEvent(textTracks, \"remove\", this._onTextTracksChange.bind(this));\n    listenEvent(textTracks, \"mode-change\", this._onTextTrackModeChange.bind(this));\n  }\n  _addQualityListeners() {\n    const qualities = this._media.qualities;\n    listenEvent(qualities, \"add\", this._onQualitiesChange.bind(this));\n    listenEvent(qualities, \"remove\", this._onQualitiesChange.bind(this));\n    listenEvent(qualities, \"change\", this._onQualityChange.bind(this));\n    listenEvent(qualities, \"auto-change\", this._onAutoQualityChange.bind(this));\n    listenEvent(qualities, \"readonly-change\", this._onCanSetQualityChange.bind(this));\n  }\n  _addAudioTrackListeners() {\n    const audioTracks = this._media.audioTracks;\n    listenEvent(audioTracks, \"add\", this._onAudioTracksChange.bind(this));\n    listenEvent(audioTracks, \"remove\", this._onAudioTracksChange.bind(this));\n    listenEvent(audioTracks, \"change\", this._onAudioTrackChange.bind(this));\n  }\n  _onTextTracksChange(event) {\n    const {\n      textTracks\n    } = this._store;\n    textTracks.set(this._media.textTracks.toArray());\n    this.dispatch(\"text-tracks-change\", {\n      detail: textTracks(),\n      trigger: event\n    });\n  }\n  _onTextTrackModeChange(event) {\n    if (event) this._satisfyRequest(\"textTrack\", event);\n    const current = this._media.textTracks.selected,\n      {\n        textTrack\n      } = this._store;\n    if (textTrack() !== current) {\n      textTrack.set(current);\n      this.dispatch(\"text-track-change\", {\n        detail: current,\n        trigger: event\n      });\n    }\n  }\n  _onAudioTracksChange(event) {\n    const {\n      audioTracks\n    } = this._store;\n    audioTracks.set(this._media.audioTracks.toArray());\n    this.dispatch(\"audio-tracks-change\", {\n      detail: audioTracks(),\n      trigger: event\n    });\n  }\n  _onAudioTrackChange(event) {\n    const {\n      audioTrack\n    } = this._store;\n    audioTrack.set(this._media.audioTracks.selected);\n    this._satisfyRequest(\"audioTrack\", event);\n    this.dispatch(\"audio-track-change\", {\n      detail: audioTrack(),\n      trigger: event\n    });\n  }\n  _onQualitiesChange(event) {\n    const {\n      qualities\n    } = this._store;\n    qualities.set(this._media.qualities.toArray());\n    this.dispatch(\"qualities-change\", {\n      detail: qualities(),\n      trigger: event\n    });\n  }\n  _onQualityChange(event) {\n    const {\n      quality\n    } = this._store;\n    quality.set(this._media.qualities.selected);\n    this._satisfyRequest(\"quality\", event);\n    this.dispatch(\"quality-change\", {\n      detail: quality(),\n      trigger: event\n    });\n  }\n  _onAutoQualityChange() {\n    this._store.autoQuality.set(this._media.qualities.auto);\n  }\n  _onCanSetQualityChange() {\n    this._store.canSetQuality.set(!this._media.qualities.readonly);\n  }\n  [\"provider-change\"](event) {\n    this._media.$provider.set(event.detail);\n  }\n  [\"autoplay\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n    this._store.autoplayError.set(void 0);\n  }\n  [\"autoplay-fail\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play-fail\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n    this._store.autoplayError.set(event.detail);\n    this._resetTracking();\n  }\n  [\"can-load\"](event) {\n    this._store.canLoad.set(true);\n    this._trackedEvents.set(\"can-load\", event);\n    this._satisfyRequest(\"load\", event);\n    this._media.textTracks[TEXT_TRACK_CAN_LOAD]();\n  }\n  [\"media-type-change\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    const viewType = this._store.viewType();\n    this._store.mediaType.set(event.detail);\n    if (viewType !== this._store.viewType()) {\n      setTimeout(() => this.dispatch(\"view-type-change\", {\n        detail: this._store.viewType(),\n        trigger: event\n      }), 0);\n    }\n  }\n  [\"stream-type-change\"](event) {\n    const {\n      streamType,\n      inferredStreamType\n    } = this._store;\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    inferredStreamType.set(event.detail);\n    event.detail = streamType();\n  }\n  [\"rate-change\"](event) {\n    this._store.playbackRate.set(event.detail);\n    this._satisfyRequest(\"rate\", event);\n  }\n  [\"sources-change\"](event) {\n    this._store.sources.set(event.detail);\n  }\n  [\"source-change\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"sources-change\"));\n    this._store.source.set(event.detail);\n    this.el?.setAttribute(\"aria-busy\", \"true\");\n    {\n      this._media.logger?.infoGroup(\"\\u{1F4FC} Media source change\").labelledLog(\"Source\", event.detail).dispatch();\n    }\n    if (this._skipInitialSrcChange) {\n      this._skipInitialSrcChange = false;\n      return;\n    }\n    this._media.audioTracks[LIST_RESET](event);\n    this._media.qualities[LIST_RESET](event);\n    this._resetTracking();\n    softResetMediaStore(this._media.$store);\n    this._trackedEvents.set(event.type, event);\n  }\n  [\"abort\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-load\"));\n  }\n  [\"load-start\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n  }\n  [\"error\"](event) {\n    this._store.error.set(event.detail);\n    appendTriggerEvent(event, this._trackedEvents.get(\"abort\"));\n  }\n  [\"loaded-metadata\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"load-start\"));\n  }\n  [\"loaded-data\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"load-start\"));\n  }\n  [\"can-play\"](event) {\n    if (event.trigger?.type !== \"loadedmetadata\") {\n      appendTriggerEvent(event, this._trackedEvents.get(\"loaded-metadata\"));\n    }\n    this._onCanPlayDetail(event.detail);\n    this.el?.setAttribute(\"aria-busy\", \"false\");\n  }\n  [\"can-play-through\"](event) {\n    this._onCanPlayDetail(event.detail);\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n  }\n  _onCanPlayDetail(detail) {\n    const {\n      seekable,\n      seekableEnd,\n      buffered,\n      duration,\n      canPlay\n    } = this._store;\n    seekable.set(detail.seekable);\n    buffered.set(detail.buffered);\n    duration.set(seekableEnd);\n    canPlay.set(true);\n  }\n  [\"duration-change\"](event) {\n    const {\n        live,\n        duration\n      } = this._store,\n      time = event.detail;\n    if (!live()) duration.set(!Number.isNaN(time) ? time : 0);\n  }\n  [\"progress\"](event) {\n    const {\n        buffered,\n        seekable,\n        live,\n        duration,\n        seekableEnd\n      } = this._store,\n      detail = event.detail;\n    buffered.set(detail.buffered);\n    seekable.set(detail.seekable);\n    if (live()) {\n      duration.set(seekableEnd);\n      this.dispatch(\"duration-change\", {\n        detail: seekableEnd(),\n        trigger: event\n      });\n    }\n  }\n  [\"play\"](event) {\n    const {\n      paused,\n      autoplayError,\n      ended,\n      autoplaying\n    } = this._store;\n    event.autoplay = autoplaying();\n    if (this._request._looping || !paused()) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    appendTriggerEvent(event, this._trackedEvents.get(\"waiting\"));\n    this._satisfyRequest(\"play\", event);\n    paused.set(false);\n    autoplayError.set(void 0);\n    if (ended() || this._request._replaying) {\n      this._request._replaying = false;\n      ended.set(false);\n      this._handle(this.createEvent(\"replay\", {\n        trigger: event\n      }));\n    }\n  }\n  [\"play-fail\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play\"));\n    this._satisfyRequest(\"play\", event);\n    const {\n      paused,\n      playing\n    } = this._store;\n    paused.set(true);\n    playing.set(false);\n    this._resetTracking();\n  }\n  [\"playing\"](event) {\n    const playEvent = this._trackedEvents.get(\"play\");\n    if (playEvent) {\n      appendTriggerEvent(event, this._trackedEvents.get(\"waiting\"));\n      appendTriggerEvent(event, playEvent);\n    } else {\n      appendTriggerEvent(event, this._trackedEvents.get(\"seeked\"));\n    }\n    setTimeout(() => this._resetTracking(), 0);\n    const {\n      paused,\n      playing,\n      seeking,\n      ended\n    } = this._store;\n    paused.set(false);\n    playing.set(true);\n    seeking.set(false);\n    ended.set(false);\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      this._request._looping = false;\n      return;\n    }\n    this[\"started\"](event);\n  }\n  [\"started\"](event) {\n    const {\n      started,\n      live,\n      liveSyncPosition,\n      seekableEnd\n    } = this._store;\n    if (!started()) {\n      if (live()) {\n        const end = liveSyncPosition() ?? seekableEnd() - 2;\n        if (Number.isFinite(end)) this._media.$provider().currentTime = end;\n      }\n      started.set(true);\n      this._handle(this.createEvent(\"started\", {\n        trigger: event\n      }));\n    }\n  }\n  [\"pause\"](event) {\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    appendTriggerEvent(event, this._trackedEvents.get(\"seeked\"));\n    this._satisfyRequest(\"pause\", event);\n    const {\n      paused,\n      playing,\n      seeking\n    } = this._store;\n    paused.set(true);\n    playing.set(false);\n    seeking.set(false);\n    this._resetTracking();\n  }\n  [\"time-update\"](event) {\n    const {\n        currentTime,\n        played,\n        waiting\n      } = this._store,\n      detail = event.detail;\n    currentTime.set(detail.currentTime);\n    played.set(detail.played);\n    waiting.set(false);\n    for (const track of this._media.textTracks) {\n      track[TEXT_TRACK_UPDATE_ACTIVE_CUES](detail.currentTime, event);\n    }\n  }\n  [\"volume-change\"](event) {\n    const {\n        volume,\n        muted\n      } = this._store,\n      detail = event.detail;\n    volume.set(detail.volume);\n    muted.set(detail.muted || detail.volume === 0);\n    this._satisfyRequest(\"volume\", event);\n  }\n  [\"seeking\"] = functionThrottle(event => {\n    const {\n      seeking,\n      currentTime,\n      paused\n    } = this._store;\n    seeking.set(true);\n    currentTime.set(event.detail);\n    this._satisfyRequest(\"seeking\", event);\n    if (paused()) {\n      this._waitingTrigger = event;\n      this._fireWaiting();\n    }\n  }, 150, {\n    leading: true\n  });\n  [\"seeked\"](event) {\n    const {\n      seeking,\n      currentTime,\n      paused,\n      duration,\n      ended\n    } = this._store;\n    if (this._request._seeking) {\n      seeking.set(true);\n      event.stopImmediatePropagation();\n    } else if (seeking()) {\n      const waitingEvent = this._trackedEvents.get(\"waiting\");\n      appendTriggerEvent(event, waitingEvent);\n      if (waitingEvent?.trigger?.type !== \"seeking\") {\n        appendTriggerEvent(event, this._trackedEvents.get(\"seeking\"));\n      }\n      if (paused()) this._stopWaiting();\n      seeking.set(false);\n      if (event.detail !== duration()) ended.set(false);\n      currentTime.set(event.detail);\n      this._satisfyRequest(\"seeked\", event);\n      const origin = event.originEvent;\n      if (origin && origin.isTrusted && !/seek/.test(origin.type)) {\n        this[\"started\"](event);\n      }\n    }\n  }\n  [\"waiting\"](event) {\n    if (this._firingWaiting || this._request._seeking) return;\n    event.stopImmediatePropagation();\n    this._waitingTrigger = event;\n    this._fireWaiting();\n  }\n  _fireWaiting = functionDebounce(() => {\n    if (!this._waitingTrigger) return;\n    this._firingWaiting = true;\n    const {\n      waiting,\n      playing\n    } = this._store;\n    waiting.set(true);\n    playing.set(false);\n    const event = this.createEvent(\"waiting\", {\n      trigger: this._waitingTrigger\n    });\n    this._trackedEvents.set(\"waiting\", event);\n    this.el.dispatchEvent(event);\n    this._waitingTrigger = void 0;\n    this._firingWaiting = false;\n  }, 300);\n  [\"ended\"](event) {\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    const {\n      paused,\n      playing,\n      seeking,\n      ended\n    } = this._store;\n    paused.set(true);\n    playing.set(false);\n    seeking.set(false);\n    ended.set(true);\n    this._resetTracking();\n  }\n  _stopWaiting() {\n    this._fireWaiting.cancel();\n    this._store.waiting.set(false);\n  }\n  [\"fullscreen-change\"](event) {\n    this._store.fullscreen.set(event.detail);\n    this._satisfyRequest(\"fullscreen\", event);\n  }\n  [\"fullscreen-error\"](event) {\n    this._satisfyRequest(\"fullscreen\", event);\n  }\n  [\"picture-in-picture-change\"](event) {\n    this._store.pictureInPicture.set(event.detail);\n    this._satisfyRequest(\"pip\", event);\n  }\n  [\"picture-in-picture-error\"](event) {\n    this._satisfyRequest(\"pip\", event);\n  }\n}\nclass MediaStoreSync extends ComponentController {\n  onAttach(el) {\n    effect(this._onLogLevelChange.bind(this));\n    effect(this._onAutoplayChange.bind(this));\n    effect(this._onPosterChange.bind(this));\n    effect(this._onLoopChange.bind(this));\n    effect(this._onControlsChange.bind(this));\n    effect(this._onCrossOriginChange.bind(this));\n    effect(this._onPlaysinlineChange.bind(this));\n    effect(this._onLiveToleranceChange.bind(this));\n    effect(this._onLiveChange.bind(this));\n    effect(this._onLiveEdgeChange.bind(this));\n    effect(this._onThumbnailsChange.bind(this));\n  }\n  _onLogLevelChange() {\n    this.$store.logLevel.set(this.$props.logLevel());\n  }\n  _onAutoplayChange() {\n    const autoplay = this.$props.autoplay();\n    this.$store.autoplay.set(autoplay);\n    this.dispatch(\"autoplay-change\", {\n      detail: autoplay\n    });\n  }\n  _onLoopChange() {\n    const loop = this.$props.loop();\n    this.$store.loop.set(loop);\n    this.dispatch(\"loop-change\", {\n      detail: loop\n    });\n  }\n  _onControlsChange() {\n    const controls = this.$props.controls();\n    this.$store.controls.set(controls);\n    this.dispatch(\"controls-change\", {\n      detail: controls\n    });\n  }\n  _onPosterChange() {\n    const poster = this.$props.poster();\n    this.$store.poster.set(poster);\n    this.dispatch(\"poster-change\", {\n      detail: poster\n    });\n  }\n  _onCrossOriginChange() {\n    this.$store.crossorigin.set(this.$props.crossorigin());\n  }\n  _onPlaysinlineChange() {\n    const playsinline = this.$props.playsinline();\n    this.$store.playsinline.set(playsinline);\n    this.dispatch(\"playsinline-change\", {\n      detail: playsinline\n    });\n  }\n  _onLiveChange() {\n    this.dispatch(\"live-change\", {\n      detail: this.$store.live()\n    });\n  }\n  _onLiveToleranceChange() {\n    this.$store.liveEdgeTolerance.set(this.$props.liveEdgeTolerance());\n    this.$store.minLiveDVRWindow.set(this.$props.minLiveDVRWindow());\n  }\n  _onLiveEdgeChange() {\n    this.dispatch(\"live-edge-change\", {\n      detail: this.$store.liveEdge()\n    });\n  }\n  _onThumbnailsChange() {\n    this.$store.thumbnails.set(this.$props.thumbnails());\n  }\n}\nfunction preconnect(url, rel = \"preconnect\") {\n  const exists = document.querySelector(`link[href=\"${url}\"]`);\n  if (!isNull(exists)) return true;\n  const link = document.createElement(\"link\");\n  link.rel = rel;\n  link.href = url;\n  link.crossOrigin = \"true\";\n  document.head.append(link);\n  return true;\n}\nconst pendingRequests = {};\nfunction loadScript(src) {\n  if (pendingRequests[src]) return pendingRequests[src].promise;\n  const promise = deferredPromise(),\n    exists = document.querySelector(`script[src=\"${src}\"]`);\n  if (!isNull(exists)) {\n    promise.resolve();\n    return promise.promise;\n  }\n  const script = document.createElement(\"script\");\n  script.src = src;\n  script.onload = () => {\n    promise.resolve();\n    delete pendingRequests[src];\n  };\n  script.onerror = () => {\n    promise.reject();\n    delete pendingRequests[src];\n  };\n  setTimeout(() => document.head.append(script), 0);\n  return promise.promise;\n}\nfunction getRequestCredentials(crossorigin) {\n  return crossorigin === \"use-credentials\" ? \"include\" : isString(crossorigin) ? \"same-origin\" : void 0;\n}\nfunction findActiveCue(time, cues) {\n  for (let i = 0, len = cues.length; i < len; i++) {\n    if (isCueActive(cues[i], time)) return cues[i];\n  }\n  return null;\n}\nfunction isCueActive(cue, time) {\n  return time >= cue.startTime && time < cue.endTime;\n}\nfunction onTrackChapterChange(tracks, currentTrack, onChange) {\n  const track = tracks.toArray().find(track2 => track2.kind === \"chapters\" && track2.mode === \"showing\");\n  if (track === currentTrack) return;\n  if (!track) {\n    onChange(null);\n    return;\n  }\n  if (track.readyState == 2) {\n    onChange(track);\n  } else {\n    onChange(null);\n    track.addEventListener(\"load\", () => onChange(track), {\n      once: true\n    });\n  }\n}\nclass TextTrack extends EventsTarget {\n  static createId(track) {\n    return `id::${track.type}-${track.kind}-${track.src ?? track.label}`;\n  }\n  src;\n  content;\n  type;\n  encoding;\n  id = \"\";\n  label = \"\";\n  language = \"\";\n  kind;\n  default = false;\n  _canLoad = false;\n  _currentTime = 0;\n  _mode = \"disabled\";\n  _metadata = {};\n  _regions = [];\n  _cues = [];\n  _activeCues = [];\n  /* @internal */\n  [TEXT_TRACK_READY_STATE] = 0;\n  /* @internal */\n  [TEXT_TRACK_CROSSORIGIN];\n  /* @internal */\n  [TEXT_TRACK_ON_MODE_CHANGE] = null;\n  /* @internal */\n  [TEXT_TRACK_NATIVE] = null;\n  get metadata() {\n    return this._metadata;\n  }\n  get regions() {\n    return this._regions;\n  }\n  get cues() {\n    return this._cues;\n  }\n  get activeCues() {\n    return this._activeCues;\n  }\n  /**\n   * - 0: Not Loading\n   * - 1: Loading\n   * - 2: Ready\n   * - 3: Error\n   */\n  get readyState() {\n    return this[TEXT_TRACK_READY_STATE];\n  }\n  get mode() {\n    return this._mode;\n  }\n  set mode(mode) {\n    this.setMode(mode);\n  }\n  constructor(init) {\n    super();\n    for (const prop of Object.keys(init)) this[prop] = init[prop];\n    if (!this.type) this.type = \"vtt\";\n    if (init.content) {\n      import('media-captions').then(({\n        parseText,\n        VTTCue,\n        VTTRegion\n      }) => {\n        if (init.type === \"json\") {\n          this._parseJSON(init.content, VTTCue, VTTRegion);\n        } else {\n          parseText(init.content, {\n            type: init.type\n          }).then(({\n            cues,\n            regions\n          }) => {\n            this._cues = cues;\n            this._regions = regions;\n            this._readyState();\n          });\n        }\n      });\n    } else if (!init.src) this[TEXT_TRACK_READY_STATE] = 2;\n    if (isTrackCaptionKind(this) && !this.label) {\n      throw Error(`[vidstack]: captions text track created without label: \\`${this.src}\\``);\n    }\n  }\n  addCue(cue, trigger) {\n    let i = 0,\n      length = this._cues.length;\n    for (i = 0; i < length; i++) if (cue.endTime <= this._cues[i].startTime) break;\n    if (i === length) this._cues.push(cue);else this._cues.splice(i, 0, cue);\n    if (trigger?.type !== \"cuechange\") {\n      this[TEXT_TRACK_NATIVE]?.track.addCue(cue);\n    }\n    this.dispatchEvent(new DOMEvent(\"add-cue\", {\n      detail: cue,\n      trigger\n    }));\n    if (isCueActive(cue, this._currentTime)) {\n      this[TEXT_TRACK_UPDATE_ACTIVE_CUES](this._currentTime, trigger);\n    }\n  }\n  removeCue(cue, trigger) {\n    const index = this._cues.indexOf(cue);\n    if (index >= 0) {\n      const isActive = this._activeCues.includes(cue);\n      this._cues.splice(index, 1);\n      this[TEXT_TRACK_NATIVE]?.track.removeCue(cue);\n      this.dispatchEvent(new DOMEvent(\"remove-cue\", {\n        detail: cue,\n        trigger\n      }));\n      if (isActive) {\n        this[TEXT_TRACK_UPDATE_ACTIVE_CUES](this._currentTime, trigger);\n      }\n    }\n  }\n  setMode(mode, trigger) {\n    if (this._mode === mode) return;\n    this._mode = mode;\n    if (mode === \"disabled\") {\n      this._activeCues = [];\n      this._activeCuesChanged();\n    } else if (this.readyState === 2) {\n      this[TEXT_TRACK_UPDATE_ACTIVE_CUES](this._currentTime, trigger);\n    } else {\n      this._load();\n    }\n    this.dispatchEvent(new DOMEvent(\"mode-change\", {\n      detail: this,\n      trigger\n    }));\n    this[TEXT_TRACK_ON_MODE_CHANGE]?.();\n  }\n  /* @internal */\n  [TEXT_TRACK_UPDATE_ACTIVE_CUES](currentTime, trigger) {\n    this._currentTime = currentTime;\n    if (this.mode === \"disabled\" || !this._cues.length) return;\n    const activeCues = [];\n    for (let i = 0, length = this._cues.length; i < length; i++) {\n      const cue = this._cues[i];\n      if (isCueActive(cue, currentTime)) activeCues.push(cue);\n    }\n    let changed = activeCues.length !== this._activeCues.length;\n    if (!changed) {\n      for (let i = 0; i < activeCues.length; i++) {\n        if (!this._activeCues.includes(activeCues[i])) {\n          changed = true;\n          break;\n        }\n      }\n    }\n    this._activeCues = activeCues;\n    if (changed) this._activeCuesChanged(trigger);\n  }\n  /* @internal */\n  [TEXT_TRACK_CAN_LOAD]() {\n    this._canLoad = true;\n    if (this._mode !== \"disabled\") this._load();\n  }\n  async _load() {\n    if (!this._canLoad || !this.src || this[TEXT_TRACK_READY_STATE] > 0) return;\n    this[TEXT_TRACK_READY_STATE] = 1;\n    this.dispatchEvent(new DOMEvent(\"load-start\"));\n    try {\n      const {\n          parseResponse,\n          VTTCue,\n          VTTRegion\n        } = await import('media-captions'),\n        crossorigin = this[TEXT_TRACK_CROSSORIGIN]?.();\n      const response = fetch(this.src, {\n        headers: this.type === \"json\" ? {\n          \"Content-Type\": \"application/json\"\n        } : void 0,\n        credentials: getRequestCredentials(crossorigin)\n      });\n      if (this.type === \"json\") {\n        this._parseJSON(await (await response).text(), VTTCue, VTTRegion);\n      } else {\n        const {\n          errors,\n          metadata,\n          regions,\n          cues\n        } = await parseResponse(response, {\n          type: this.type,\n          encoding: this.encoding\n        });\n        if (errors[0]?.code === 0) {\n          throw errors[0];\n        } else {\n          this._metadata = metadata;\n          this._regions = regions;\n          this._cues = cues;\n        }\n      }\n      this._readyState();\n    } catch (error) {\n      this._errorState(error);\n    }\n  }\n  _readyState() {\n    this[TEXT_TRACK_READY_STATE] = 2;\n    if (!this.src || this.type !== \"vtt\") {\n      const nativeTrack = this[TEXT_TRACK_NATIVE]?.track;\n      if (nativeTrack) for (const cue of this._cues) nativeTrack.addCue(cue);\n    }\n    const loadEvent = new DOMEvent(\"load\");\n    this[TEXT_TRACK_UPDATE_ACTIVE_CUES](this._currentTime, loadEvent);\n    this.dispatchEvent(loadEvent);\n  }\n  _errorState(error) {\n    this[TEXT_TRACK_READY_STATE] = 3;\n    this.dispatchEvent(new DOMEvent(\"error\", {\n      detail: error\n    }));\n  }\n  _parseJSON(json, VTTCue, VTTRegion) {\n    try {\n      json = JSON.parse(json);\n      if (json.regions) {\n        this._regions = json.regions.map(json2 => Object.assign(new VTTRegion(), json2));\n      }\n      if (json.cues) {\n        this._cues = json.cues.filter(json2 => isNumber(json2.startTime) && isNumber(json2.endTime)).map(json2 => Object.assign(new VTTCue(0, 0, \"\"), json2));\n      }\n    } catch (error) {\n      {\n        console.error(`[vidstack] failed to parse JSON captions at: \\`${this.src}\\`\n\n`, error);\n      }\n      this._errorState(error);\n    }\n  }\n  _activeCuesChanged(trigger) {\n    this.dispatchEvent(new DOMEvent(\"cue-change\", {\n      trigger\n    }));\n  }\n}\nconst captionRE = /captions|subtitles/;\nfunction isTrackCaptionKind(track) {\n  return captionRE.test(track.kind);\n}\nclass MediaRemoteControl {\n  constructor(_logger) {\n    this._logger = _logger;\n  }\n  _target = null;\n  _player = null;\n  _prevTrackIndex = -1;\n  /**\n   * Set the target from which to dispatch media requests events from. The events should bubble\n   * up from this target to the `<media-player>` element.\n   *\n   * @example\n   * ```ts\n   * const button = document.querySelector('button');\n   * remote.setTarget(button);\n   * ```\n   */\n  setTarget(target) {\n    this._target = target;\n    this._logger?.setTarget(target);\n  }\n  /**\n   * Returns the current `<media-player>` element. This method will attempt to find the player by\n   * searching up from either the given `target` or default target set via `remote.setTarget`.\n   *\n   * @example\n   * ```ts\n   * const player = remote.getPlayer();\n   * ```\n   */\n  getPlayer(target) {\n    if (this._player) return this._player;\n    (target ?? this._target)?.dispatchEvent(new DOMEvent(\"find-media-player\", {\n      detail: player => void (this._player = player),\n      bubbles: true,\n      composed: true\n    }));\n    return this._player;\n  }\n  /**\n   * Set the current `<media-player>` element so the remote can support toggle methods such as\n   * `togglePaused` as they rely on the current media state.\n   */\n  setPlayer(player) {\n    this._player = player;\n  }\n  /**\n   * Dispatch a request to start the media loading process. This will only work if the media\n   * player has been initialized with a custom loading strategy `<media-player load=\"custom\">`.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/loading#loading-strategies}\n   */\n  startLoading(trigger) {\n    this._dispatchRequest(\"media-start-loading\", trigger);\n  }\n  /**\n   * Dispatch a request to begin/resume media playback.\n   */\n  play(trigger) {\n    this._dispatchRequest(\"media-play-request\", trigger);\n  }\n  /**\n   * Dispatch a request to pause media playback.\n   */\n  pause(trigger) {\n    this._dispatchRequest(\"media-pause-request\", trigger);\n  }\n  /**\n   * Dispatch a request to set the media volume to mute (0).\n   */\n  mute(trigger) {\n    this._dispatchRequest(\"media-mute-request\", trigger);\n  }\n  /**\n   * Dispatch a request to unmute the media volume and set it back to it's previous state.\n   */\n  unmute(trigger) {\n    this._dispatchRequest(\"media-unmute-request\", trigger);\n  }\n  /**\n   * Dispatch a request to enter fullscreen.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  enterFullscreen(target, trigger) {\n    this._dispatchRequest(\"media-enter-fullscreen-request\", trigger, target);\n  }\n  /**\n   * Dispatch a request to exit fullscreen.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  exitFullscreen(target, trigger) {\n    this._dispatchRequest(\"media-exit-fullscreen-request\", trigger, target);\n  }\n  /**\n   * Dispatch a request to enter picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  enterPictureInPicture(trigger) {\n    this._dispatchRequest(\"media-enter-pip-request\", trigger);\n  }\n  /**\n   * Dispatch a request to exit picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  exitPictureInPicture(trigger) {\n    this._dispatchRequest(\"media-exit-pip-request\", trigger);\n  }\n  /**\n   * Notify the media player that a seeking process is happening and to seek to the given `time`.\n   */\n  seeking(time, trigger) {\n    this._dispatchRequest(\"media-seeking-request\", trigger, time);\n  }\n  /**\n   * Notify the media player that a seeking operation has completed and to seek to the given `time`.\n   * This is generally called after a series of `remote.seeking()` calls.\n   */\n  seek(time, trigger) {\n    this._dispatchRequest(\"media-seek-request\", trigger, time);\n  }\n  seekToLiveEdge(trigger) {\n    this._dispatchRequest(\"media-live-edge-request\", trigger);\n  }\n  /**\n   * Dispatch a request to update the media volume to the given `volume` level which is a value\n   * between 0 and 1.\n   *\n   * @example\n   * ```ts\n   * remote.changeVolume(0); // 0%\n   * remote.changeVolume(0.05); // 5%\n   * remote.changeVolume(0.5); // 50%\n   * remote.changeVolume(0.75); // 70%\n   * remote.changeVolume(1); // 100%\n   * ```\n   */\n  changeVolume(volume, trigger) {\n    this._dispatchRequest(\"media-volume-change-request\", trigger, Math.max(0, Math.min(1, volume)));\n  }\n  /**\n   * Dispatch a request to change the current audio track.\n   *\n   * @example\n   * ```ts\n   * remote.changeAudioTrack(1); // track at index 1\n   * ```\n   */\n  changeAudioTrack(index, trigger) {\n    this._dispatchRequest(\"media-audio-track-change-request\", trigger, index);\n  }\n  /**\n   * Dispatch a request to change the video quality. The special value `-1` represents auto quality\n   * selection.\n   *\n   * @example\n   * ```ts\n   * remote.changeQuality(-1); // auto\n   * remote.changeQuality(1); // quality at index 1\n   * ```\n   */\n  changeQuality(index, trigger) {\n    this._dispatchRequest(\"media-quality-change-request\", trigger, index);\n  }\n  /**\n   * Dispatch a request to change the mode of the text track at the given index.\n   *\n   * @example\n   * ```ts\n   * remote.changeTextTrackMode(1, 'showing'); // track at index 1\n   * ```\n   */\n  changeTextTrackMode(index, mode, trigger) {\n    this._dispatchRequest(\"media-text-track-change-request\", trigger, {\n      index,\n      mode\n    });\n  }\n  /**\n   * Dispatch a request to change the media playback rate.\n   *\n   * @example\n   * ```ts\n   * remote.changePlaybackRate(0.5); // Half the normal speed\n   * remote.changePlaybackRate(1); // Normal speed\n   * remote.changePlaybackRate(1.5); // 50% faster than normal\n   * remote.changePlaybackRate(2); // Double the normal speed\n   * ```\n   */\n  changePlaybackRate(rate, trigger) {\n    this._dispatchRequest(\"media-rate-change-request\", trigger, rate);\n  }\n  /**\n   * Dispatch a request to resume user idle tracking. Refer to {@link MediaRemoteControl.pauseUserIdle}\n   * for more information.\n   */\n  resumeUserIdle(trigger) {\n    this._dispatchRequest(\"media-resume-user-idle-request\", trigger);\n  }\n  /**\n   * Dispatch a request to pause user idle tracking. Pausing tracking will result in the `user-idle`\n   * attribute and state being `false` until `remote.resumeUserIdle()` is called. This method\n   * is generally used when building custom controls and you'd like to prevent the UI from\n   * dissapearing.\n   *\n   * @example\n   * ```ts\n   * // Prevent user idling while menu is being interacted with.\n   * function onSettingsOpen() {\n   *   remote.pauseUserIdle();\n   * }\n   *\n   * function onSettingsClose() {\n   *   remote.resumeUserIdle();\n   * }\n   * ```\n   */\n  pauseUserIdle(trigger) {\n    this._dispatchRequest(\"media-pause-user-idle-request\", trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media playback state.\n   */\n  togglePaused(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.togglePaused.name);\n      return;\n    }\n    if (player.state.paused) this.play(trigger);else this.pause(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the user idle state.\n   */\n  toggleUserIdle(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleUserIdle.name);\n      return;\n    }\n    player.user.idle(!player.user.idling, 0, trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media muted state.\n   */\n  toggleMuted(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleMuted.name);\n      return;\n    }\n    if (player.state.muted) this.unmute(trigger);else this.mute(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media fullscreen state.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  toggleFullscreen(target, trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleFullscreen.name);\n      return;\n    }\n    if (player.state.fullscreen) this.exitFullscreen(target, trigger);else this.enterFullscreen(target, trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  togglePictureInPicture(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.togglePictureInPicture.name);\n      return;\n    }\n    if (player.state.pictureInPicture) this.exitPictureInPicture(trigger);else this.enterPictureInPicture(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the current captions mode.\n   */\n  toggleCaptions(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleCaptions.name);\n      return;\n    }\n    const tracks = player.state.textTracks,\n      track = player.state.textTrack;\n    if (track) {\n      const index = tracks.indexOf(track);\n      this.changeTextTrackMode(index, \"disabled\", trigger);\n      this._prevTrackIndex = index;\n    } else {\n      let index = this._prevTrackIndex;\n      if (!tracks[index] || !isTrackCaptionKind(tracks[index])) {\n        index = -1;\n      }\n      if (index === -1) {\n        index = tracks.findIndex(track2 => isTrackCaptionKind(track2) && track2.default);\n      }\n      if (index === -1) {\n        index = tracks.findIndex(track2 => isTrackCaptionKind(track2));\n      }\n      if (index >= 0) this.changeTextTrackMode(index, \"showing\", trigger);\n      this._prevTrackIndex = -1;\n    }\n  }\n  _dispatchRequest(type, trigger, detail) {\n    const request = new DOMEvent(type, {\n      bubbles: true,\n      composed: true,\n      detail,\n      trigger\n    });\n    const shouldUsePlayer = trigger?.target && (trigger.target === document || trigger.target === window || trigger.target === document.body || this._player && !this._player.contains(trigger.target));\n    const target = shouldUsePlayer ? this._target ?? this.getPlayer() : trigger?.target ?? this._target;\n    {\n      this._logger?.infoGroup(`\\u{1F4E8} dispatching \\`${type}\\``).labelledLog(\"Target\", target).labelledLog(\"Player\", this._player).labelledLog(\"Request Event\", request).labelledLog(\"Trigger Event\", trigger).dispatch();\n    }\n    target?.dispatchEvent(request);\n  }\n  _noPlayerWarning(method) {\n    {\n      console.warn(`[vidstack] attempted to call \\`MediaRemoteControl.${method}\\`() that requires player but failed because remote could not find a parent player element from target`);\n    }\n  }\n}\nclass ThumbnailsLoader extends ComponentController {\n  _media;\n  onConnect() {\n    this._media = useMedia();\n    effect(this._onLoadCues.bind(this));\n  }\n  _onLoadCues() {\n    const {\n      canLoad,\n      thumbnailCues\n    } = this._media.$store;\n    if (!canLoad()) return;\n    const controller = new AbortController(),\n      {\n        crossorigin,\n        thumbnails\n      } = this._media.$store;\n    const src = thumbnails();\n    if (!src) return;\n    import('media-captions').then(({\n      parseResponse\n    }) => {\n      parseResponse(fetch(src, {\n        signal: controller.signal,\n        credentials: getRequestCredentials(crossorigin())\n      })).then(({\n        cues\n      }) => thumbnailCues.set(cues)).catch(noop);\n    });\n    return () => {\n      controller.abort();\n      thumbnailCues.set([]);\n    };\n  }\n}\nclass AudioTrackList extends SelectList {\n  getById(id) {\n    if (id === \"\") return null;\n    return this._items.find(track => track.id === id) ?? null;\n  }\n}\nclass NativeTextRenderer {\n  priority = 0;\n  _display = true;\n  _video = null;\n  _track = null;\n  _tracks = /* @__PURE__ */new Set();\n  canRender() {\n    return true;\n  }\n  attach(video) {\n    this._video = video;\n    video.textTracks.onchange = this._onChange.bind(this);\n  }\n  addTrack(track) {\n    this._tracks.add(track);\n    this._attachTrack(track);\n  }\n  removeTrack(track) {\n    track[TEXT_TRACK_NATIVE]?.remove?.();\n    track[TEXT_TRACK_NATIVE] = null;\n    this._tracks.delete(track);\n  }\n  changeTrack(track) {\n    const current = track?.[TEXT_TRACK_NATIVE];\n    if (current && current.track.mode !== \"showing\") {\n      current.track.mode = \"showing\";\n    }\n    this._track = track;\n  }\n  setDisplay(display) {\n    this._display = display;\n    this._onChange();\n  }\n  detach() {\n    if (this._video) this._video.textTracks.onchange = null;\n    for (const track of this._tracks) this.removeTrack(track);\n    this._tracks.clear();\n    this._video = null;\n    this._track = null;\n  }\n  _attachTrack(track) {\n    if (!this._video) return;\n    const el = track[TEXT_TRACK_NATIVE] ??= this._createTrackElement(track);\n    if (el instanceof HTMLElement) {\n      this._video.append(el);\n      el.track.mode = el.default ? \"showing\" : \"hidden\";\n    }\n  }\n  _createTrackElement(track) {\n    const el = document.createElement(\"track\"),\n      isDefault = track.default || track.mode === \"showing\",\n      isSupported = track.src && track.type === \"vtt\";\n    el.id = track.id;\n    el.src = isSupported ? track.src : \"https://cdn.jsdelivr.net/npm/vidstack@0.6.12/empty.vtt\";\n    el.label = track.label;\n    el.kind = track.kind;\n    el.default = isDefault;\n    track.language && (el.srclang = track.language);\n    if (isDefault && !isSupported) {\n      this._copyCues(track, el.track);\n    }\n    return el;\n  }\n  _copyCues(track, native) {\n    if (track.src && track.type === \"vtt\" || native.cues?.length) return;\n    for (const cue of track.cues) native.addCue(cue);\n  }\n  _onChange(event) {\n    for (const track of this._tracks) {\n      const nativeTrack = track[TEXT_TRACK_NATIVE]?.track;\n      if (!nativeTrack) continue;\n      if (!this._display) {\n        nativeTrack.mode = \"disabled\";\n        continue;\n      }\n      const isShowing = nativeTrack.mode === \"showing\";\n      if (isShowing) this._copyCues(track, nativeTrack);\n      track.setMode(isShowing ? \"showing\" : \"disabled\", event);\n    }\n  }\n}\nclass TextRenderers {\n  constructor(_media) {\n    this._media = _media;\n    const textTracks = _media.textTracks;\n    this._textTracks = textTracks;\n    effect(this._watchControls.bind(this));\n    onDispose(this._detach.bind(this));\n    listenEvent(textTracks, \"add\", this._onAddTrack.bind(this));\n    listenEvent(textTracks, \"remove\", this._onRemoveTrack.bind(this));\n    listenEvent(textTracks, \"mode-change\", this._update.bind(this));\n  }\n  _video = null;\n  _textTracks;\n  _renderers = [];\n  _nativeDisplay = false;\n  _nativeRenderer = null;\n  _customRenderer = null;\n  _watchControls() {\n    const {\n      $store,\n      $iosControls\n    } = this._media;\n    this._nativeDisplay = $store.controls() || $iosControls();\n    this._update();\n  }\n  add(renderer) {\n    this._renderers.push(renderer);\n    this._update();\n  }\n  remove(renderer) {\n    renderer.detach();\n    this._renderers.splice(this._renderers.indexOf(renderer), 1);\n    this._update();\n  }\n  /* @internal */\n  [ATTACH_VIDEO](video) {\n    requestAnimationFrame(() => {\n      this._video = video;\n      if (video) {\n        this._nativeRenderer = new NativeTextRenderer();\n        this._nativeRenderer.attach(video);\n        for (const track of this._textTracks) this._addNativeTrack(track);\n      }\n      this._update();\n    });\n  }\n  _addNativeTrack(track) {\n    if (!isTrackCaptionKind(track)) return;\n    this._nativeRenderer?.addTrack(track);\n  }\n  _removeNativeTrack(track) {\n    if (!isTrackCaptionKind(track)) return;\n    this._nativeRenderer?.removeTrack(track);\n  }\n  _onAddTrack(event) {\n    this._addNativeTrack(event.detail);\n  }\n  _onRemoveTrack(event) {\n    this._removeNativeTrack(event.detail);\n  }\n  _update() {\n    if (!this._video) {\n      this._detach();\n      return;\n    }\n    const currentTrack = this._textTracks.selected;\n    if (this._nativeDisplay || currentTrack?.[TEXT_TRACK_NATIVE_HLS]) {\n      this._customRenderer?.changeTrack(null);\n      this._nativeRenderer.setDisplay(true);\n      this._nativeRenderer.changeTrack(currentTrack);\n      return;\n    }\n    this._nativeRenderer.setDisplay(false);\n    this._nativeRenderer.changeTrack(null);\n    if (!currentTrack) {\n      this._customRenderer?.changeTrack(null);\n      return;\n    }\n    const customRenderer = this._renderers.sort((a, b) => a.priority - b.priority).find(loader => loader.canRender(currentTrack));\n    if (this._customRenderer !== customRenderer) {\n      this._customRenderer?.detach();\n      customRenderer?.attach(this._video);\n      this._customRenderer = customRenderer ?? null;\n    }\n    customRenderer?.changeTrack(currentTrack);\n  }\n  _detach() {\n    this._nativeRenderer?.detach();\n    this._nativeRenderer = null;\n    this._customRenderer?.detach();\n    this._customRenderer = null;\n  }\n}\nclass TextTrackList extends List {\n  _canLoad = false;\n  _defaults = {};\n  /** @internal */\n  [TEXT_TRACK_CROSSORIGIN];\n  get selected() {\n    const track = this._items.find(t => t.mode === \"showing\" && isTrackCaptionKind(t));\n    return track ?? null;\n  }\n  add(init, trigger) {\n    const isTrack = init instanceof TextTrack,\n      track = isTrack ? init : new TextTrack(init);\n    if (this._defaults[init.kind] && init.default) delete init.default;\n    track.addEventListener(\"mode-change\", this._onTrackModeChangeBind);\n    this[LIST_ADD](track, trigger);\n    track[TEXT_TRACK_CROSSORIGIN] = this[TEXT_TRACK_CROSSORIGIN];\n    if (this._canLoad) track[TEXT_TRACK_CAN_LOAD]();\n    if (init.default) {\n      this._defaults[init.kind] = track;\n      track.mode = \"showing\";\n    }\n    return this;\n  }\n  remove(track, trigger) {\n    if (!this._items.includes(track)) return;\n    if (track === this._defaults[track.kind]) delete this._defaults[track.kind];\n    track.mode = \"disabled\";\n    track[TEXT_TRACK_ON_MODE_CHANGE] = null;\n    track.removeEventListener(\"mode-change\", this._onTrackModeChangeBind);\n    this[LIST_REMOVE](track, trigger);\n    return this;\n  }\n  clear(trigger) {\n    for (const track of this._items) this.remove(track, trigger);\n    return this;\n  }\n  getById(id) {\n    return this._items.find(track => track.id === id) ?? null;\n  }\n  getByKind(kind) {\n    const kinds = Array.isArray(kind) ? kind : [kind];\n    return this._items.filter(track => kinds.includes(track.kind));\n  }\n  /* @internal */\n  [TEXT_TRACK_CAN_LOAD]() {\n    if (this._canLoad) return;\n    for (const track of this._items) track[TEXT_TRACK_CAN_LOAD]();\n    this._canLoad = true;\n  }\n  _onTrackModeChangeBind = this._onTrackModeChange.bind(this);\n  _onTrackModeChange(event) {\n    const track = event.detail;\n    if (track.mode === \"showing\") {\n      const kinds = isTrackCaptionKind(track) ? [\"captions\", \"subtitles\"] : [track.kind];\n      for (const t of this._items) {\n        if (t.mode === \"showing\" && t != track && kinds.includes(t.kind)) {\n          t.mode = \"disabled\";\n        }\n      }\n    }\n    this.dispatchEvent(new DOMEvent(\"mode-change\", {\n      detail: event.detail,\n      trigger: event\n    }));\n  }\n}\nlet warned = /* @__PURE__ */new Set();\nclass SourceSelection {\n  constructor(_domSources, _media, _loader) {\n    this._domSources = _domSources;\n    this._media = _media;\n    this._loader = _loader;\n    const HLS_LOADER = new HLSProviderLoader(),\n      VIDEO_LOADER = new VideoProviderLoader(),\n      AUDIO_LOADER = new AudioProviderLoader();\n    this._loaders = computed(() => {\n      return _media.$props.preferNativeHLS() ? [VIDEO_LOADER, AUDIO_LOADER, HLS_LOADER] : [HLS_LOADER, VIDEO_LOADER, AUDIO_LOADER];\n    });\n    effect(this._onSourcesChange.bind(this));\n    effect(this._onSourceChange.bind(this));\n    effect(this._onPreconnect.bind(this));\n    effect(this._onLoadSource.bind(this));\n  }\n  _loaders;\n  _onSourcesChange() {\n    this._media.delegate._dispatch(\"sources-change\", {\n      detail: [...normalizeSrc(this._media.$props.src()), ...this._domSources()]\n    });\n  }\n  _onSourceChange() {\n    const {\n      $store\n    } = this._media;\n    const sources = $store.sources(),\n      currentSource = peek($store.source),\n      newSource = this._findNewSource(currentSource, sources),\n      noMatch = sources[0]?.src && !newSource.src && !newSource.type;\n    if (noMatch && !warned.has(newSource.src) && !peek(this._loader)) {\n      const source = sources[0];\n      console.warn(`[vidstack] could not find a loader for any of the given media sources, consider providing \\`type\\`:\n\n<media-outlet>\n  <source src=\"${source.src}\" type=\"video/mp4\" />\n</media-outlet>\"\n\nFalling back to fetching source headers...`);\n      warned.add(newSource.src);\n    }\n    if (noMatch) {\n      const {\n          crossorigin\n        } = $store,\n        credentials = getRequestCredentials(crossorigin()),\n        abort = new AbortController();\n      Promise.all(sources.map(source => isString(source.src) && source.type === \"?\" ? fetch(source.src, {\n        method: \"HEAD\",\n        credentials,\n        signal: abort.signal\n      }).then(res => {\n        source.type = res.headers.get(\"content-type\") || \"??\";\n        return source;\n      }).catch(() => source) : source)).then(sources2 => {\n        if (abort.signal.aborted) return;\n        this._findNewSource(peek($store.source), sources2);\n        tick();\n      });\n      return () => abort.abort();\n    }\n    tick();\n  }\n  _findNewSource(currentSource, sources) {\n    let newSource = {\n        src: \"\",\n        type: \"\"\n      },\n      newLoader = null;\n    for (const src of sources) {\n      const loader = peek(this._loaders).find(loader2 => loader2.canPlay(src));\n      if (loader) {\n        newSource = src;\n        newLoader = loader;\n      }\n    }\n    this._notifySourceChange(currentSource, newSource, newLoader);\n    this._notifyLoaderChange(peek(this._loader), newLoader);\n    return newSource;\n  }\n  _notifySourceChange(currentSource, newSource, newLoader) {\n    if (newSource.src === currentSource.src && newSource.type === currentSource.type) return;\n    this._media.delegate._dispatch(\"source-change\", {\n      detail: newSource\n    });\n    this._media.delegate._dispatch(\"media-type-change\", {\n      detail: newLoader?.mediaType(newSource) || \"unknown\"\n    });\n  }\n  _notifyLoaderChange(currentLoader, newLoader) {\n    if (newLoader === currentLoader) return;\n    this._media.delegate._dispatch(\"provider-change\", {\n      detail: null\n    });\n    newLoader && peek(() => newLoader.preconnect?.(this._media));\n    this._loader.set(newLoader);\n    this._media.delegate._dispatch(\"provider-loader-change\", {\n      detail: newLoader\n    });\n  }\n  _onPreconnect() {\n    const provider = this._media.$provider();\n    if (!provider) return;\n    if (this._media.$store.canLoad()) {\n      peek(() => provider.setup({\n        ...this._media,\n        player: this._media.player\n      }));\n      return;\n    }\n    peek(() => provider.preconnect?.(this._media));\n  }\n  _onLoadSource() {\n    const provider = this._media.$provider(),\n      source = this._media.$store.source();\n    if (this._media.$store.canLoad()) {\n      peek(() => provider?.loadSource(source, peek(this._media.$store.preload)));\n      return;\n    }\n    try {\n      isString(source.src) && preconnect(new URL(source.src).origin, \"preconnect\");\n    } catch (e) {\n      {\n        this._media.logger?.infoGroup(`Failed to preconnect to source: ${source.src}`).labelledLog(\"Error\", e).dispatch();\n      }\n    }\n  }\n}\nfunction normalizeSrc(src) {\n  return (isArray(src) ? src : [!isString(src) && \"src\" in src ? src : {\n    src\n  }]).map(({\n    src: src2,\n    type\n  }) => ({\n    src: src2,\n    type: type ?? (!isString(src2) || src2.startsWith(\"blob:\") ? \"video/object\" : \"?\")\n  }));\n}\nclass Tracks {\n  constructor(_domTracks, _media) {\n    this._domTracks = _domTracks;\n    this._media = _media;\n    effect(this._onTracksChange.bind(this));\n  }\n  _prevTracks = [];\n  _onTracksChange() {\n    const newTracks = [...this._media.$props.textTracks(), ...this._domTracks()];\n    for (const oldTrack of this._prevTracks) {\n      if (!newTracks.some(t => t.id === oldTrack.id)) {\n        const track = oldTrack.id && this._media.textTracks.getById(oldTrack.id);\n        if (track) this._media.textTracks.remove(track);\n      }\n    }\n    for (const newTrack of newTracks) {\n      const id = newTrack.id || TextTrack.createId(newTrack);\n      if (!this._media.textTracks.getById(id)) {\n        newTrack.id = id;\n        this._media.textTracks.add(newTrack);\n      }\n    }\n    this._prevTracks = newTracks;\n  }\n}\nclass Outlet extends Component {\n  static el = defineElement({\n    tagName: \"media-outlet\"\n  });\n  _media;\n  _domSources = signal([]);\n  _domTracks = signal([]);\n  _loader = signal(null);\n  constructor(instance) {\n    super(instance);\n    this._media = useMedia();\n    new SourceSelection(this._domSources, this._media, this._loader);\n    new Tracks(this._domTracks, this._media);\n  }\n  onAttach(el) {\n    el.setAttribute(\"keep-alive\", \"\");\n  }\n  onConnect(el) {\n    const resize = new ResizeObserver(animationFrameThrottle(this._onResize.bind(this)));\n    resize.observe(el);\n    const mutation = new MutationObserver(this._onMutation.bind(this));\n    mutation.observe(el, {\n      attributes: true,\n      childList: true\n    });\n    if (IS_SAFARI) {\n      listenEvent(el, \"touchstart\", e => e.preventDefault(), {\n        passive: false\n      });\n    }\n    scopedRaf(() => {\n      this._onResize();\n      this._onMutation();\n    });\n    return () => {\n      resize.disconnect();\n      mutation.disconnect();\n    };\n  }\n  onDestroy() {\n    this._media.$store.currentTime.set(0);\n  }\n  _onResize() {\n    const player = this._media.player,\n      width = this.el.offsetWidth,\n      height = this.el.offsetHeight;\n    if (!player) return;\n    player.$store.mediaWidth.set(width);\n    player.$store.mediaHeight.set(height);\n    setStyle(player, \"--media-width\", width + \"px\");\n    setStyle(player, \"--media-height\", height + \"px\");\n  }\n  _onMutation() {\n    const sources = [],\n      tracks = [],\n      children = this.el.children;\n    for (const el of children) {\n      if (el instanceof HTMLSourceElement) {\n        sources.push({\n          src: el.src,\n          type: el.type\n        });\n      } else if (el instanceof HTMLTrackElement) {\n        tracks.push({\n          id: el.id,\n          src: el.src,\n          kind: el.track.kind,\n          language: el.srclang,\n          label: el.label,\n          default: el.default,\n          type: el.getAttribute(\"data-type\")\n        });\n      }\n    }\n    this._domSources.set(sources);\n    this._domTracks.set(tracks);\n    tick();\n  }\n  render() {\n    let currentProvider;\n    onDispose(() => currentProvider?.destroy?.());\n    return () => {\n      currentProvider?.destroy();\n      const loader = this._loader();\n      if (!loader) return null;\n      const el = loader.render(this._media.$store);\n      {\n        peek(() => {\n          loader.load(this._media).then(provider => {\n            if (peek(this._loader) !== loader) return;\n            this._media.delegate._dispatch(\"provider-change\", {\n              detail: provider\n            });\n            currentProvider = provider;\n          });\n        });\n      }\n      return el;\n    };\n  }\n}\nclass LibASSTextRenderer {\n  constructor(loader, config) {\n    this.loader = loader;\n    this.config = config;\n  }\n  priority = 1;\n  _instance = null;\n  _track = null;\n  _typeRE = /(ssa|ass)$/;\n  canRender(track) {\n    return !!track.src && (isString(track.type) && this._typeRE.test(track.type) || this._typeRE.test(track.src));\n  }\n  attach(video) {\n    this.loader().then(async mod => {\n      this._instance = new mod.default({\n        ...this.config,\n        video,\n        subUrl: this._track?.src || \"\"\n      });\n      listenEvent(this._instance, \"ready\", () => {\n        const canvas = this._instance?._canvas;\n        if (canvas) canvas.style.pointerEvents = \"none\";\n      });\n      listenEvent(this._instance, \"error\", event => {\n        if (this._track) {\n          this._track[TEXT_TRACK_READY_STATE] = 3;\n          this._track.dispatchEvent(new DOMEvent(\"error\", {\n            trigger: event,\n            detail: event.error\n          }));\n        }\n      });\n    });\n  }\n  changeTrack(track) {\n    if (!track || track.readyState === 3) {\n      this._freeTrack();\n    } else if (this._track !== track) {\n      this._instance?.setTrackByUrl(track.src);\n      this._track = track;\n    }\n  }\n  detach() {\n    this._freeTrack();\n  }\n  _freeTrack() {\n    this._instance?.freeTrack();\n    this._track = null;\n  }\n}\nclass ARIAKeyShortcuts extends ComponentController {\n  constructor(instance, _shortcut) {\n    super(instance);\n    this._shortcut = _shortcut;\n  }\n  onAttach(el) {\n    const {\n        $props,\n        ariaKeys\n      } = useMedia(),\n      keys = el.getAttribute(\"aria-keyshortcuts\");\n    if (keys) {\n      ariaKeys[this._shortcut] = keys;\n      {\n        onDispose(() => {\n          delete ariaKeys[this._shortcut];\n        });\n      }\n      return;\n    }\n    const shortcuts = $props.keyShortcuts()[this._shortcut];\n    if (shortcuts) el.setAttribute(\"aria-keyshortcuts\", shortcuts);\n  }\n}\nexport { canUsePictureInPicture as $, ARIAKeyShortcuts as A, IS_IPHONE as B, MEDIA_ATTRIBUTES as C, canFullscreen as D, MediaRemoteControl as E, MediaRequestContext as F, ENABLE_AUTO_QUALITY as G, TextTrack as H, IS_SAFARI as I, TEXT_TRACK_READY_STATE as J, TEXT_TRACK_ON_MODE_CHANGE as K, LIST_SELECT as L, MediaStoreFactory as M, SET_AUTO_QUALITY as N, Outlet as O, LIST_ADD as P, IS_CHROME as Q, coerceToError as R, ScreenOrientationController as S, TextTrackList as T, loadScript as U, VideoQualityList as V, isHLSSupported as W, LIST_REMOVE as X, canPlayHLSNatively as Y, TEXT_TRACK_NATIVE as Z, TEXT_TRACK_NATIVE_HLS as _, setAttributeIfEmpty as a, canUseVideoPresentation as a0, ATTACH_VIDEO as a1, MediaUserController as a2, MEDIA_KEY_SHORTCUTS as a3, List as a4, FullscreenController as a5, softResetMediaStore as a6, TimeRange as a7, getTimeRangesStart as a8, getTimeRangesEnd as a9, LibASSTextRenderer as aa, setARIALabel as b, findActiveCue as c, canChangeVolume as d, onTrackChapterChange as e, functionThrottle as f, isElementParent as g, isCueActive as h, isTrackCaptionKind as i, MediaStoreSync as j, AudioTrackList as k, TEXT_TRACK_CROSSORIGIN as l, mediaPlayerProps as m, TextRenderers as n, onPress as o, preconnect as p, mediaContext as q, MediaKeyboardController as r, scopedRaf as s, ThumbnailsLoader as t, useMedia as u, MediaEventsLogger as v, MediaStateManager as w, MediaRequestManager as x, MediaPlayerDelegate as y, MediaLoadController as z };","map":{"version":3,"names":["ComponentController","defineProp","Component","defineElement","signal","peek","effect","getScope","scoped","createContext","useContext","StoreFactory","tick","onDispose","computed","EventsTarget","DOMEvent","listenEvent","isUndefined","isFunction","waitTimeout","isKeyboardClick","setAttribute","isArray","isNumber","isKeyboardEvent","appendTriggerEvent","isNull","deferredPromise","isString","noop","animationFrameThrottle","setStyle","i","isHTMLMediaElement","A","AudioProviderLoader","H","HLSProviderLoader","V","VideoProviderLoader","LIST_ADD","Symbol","LIST_REMOVE","LIST_RESET","LIST_SELECT","LIST_READONLY","LIST_SET_READONLY","LIST_ON_RESET","LIST_ON_REMOVE","LIST_ON_USER_SELECT","List","_items","length","readonly","toArray","iterator","values","item","trigger","index","Object","defineProperty","get","includes","push","dispatchEvent","detail","indexOf","splice","key","fullscreenEnabled","fullscreenElement","requestFullscreen","exitFullscreen","fullscreenchange","fullscreenerror","fullscreen","webkit","moz","ms","document$1","window","document","vendor","keys","fscreen","element","requestFullscreenFunction","bind","fullscreenPseudoClass","addEventListener","type","handler","options","removeEventListener","Boolean","val","onfullscreenchange","toLowerCase","onfullscreenerror","fscreen$1","CAN_FULLSCREEN","FullscreenController","_listening","_active","active","supported","onConnect","_onFullscreenChange","_onFullscreenError","onDisconnect","exit","event","isFullscreen","el","dispatch","enter","assertFullscreenAPI","error","canFullscreen","host","matches","Error","UA","navigator","userAgent","IS_IOS","test","IS_IPHONE","platform","IS_CHROME","chrome","IS_SAFARI","safari","canOrientScreen","screen","orientation","lock","unlock","canPlayHLSNatively","video","createElement","canPlayType","canUsePictureInPicture","pictureInPictureEnabled","disablePictureInPicture","canUseVideoPresentation","webkitSupportsPresentationMode","webkitSetPresentationMode","canChangeVolume","volume","getMediaSource","MediaSource","WebKitMediaSource","getSourceBuffer","SourceBuffer","WebKitSourceBuffer","isHLSSupported","isTypeSupported","isSourceBufferValid","prototype","appendBuffer","remove","CAN_USE_SCREEN_ORIENTATION_API","ScreenOrientationController","_type","getScreenOrientation","_locked","_currentLock","locked","portrait","startsWith","landscape","_onOrientationChange","query","matchMedia","onchange","set","lockType","assertScreenOrientationAPI","innerWidth","innerHeight","setAttributeIfEmpty","target","name","value","hasAttribute","setARIALabel","label","updateAriaDescription","isElementParent","owner","node","localName","parentElement","onPress","button","scopedRaf","callback","scope","requestAnimationFrame","mediaContext","useMedia","MEDIA_ATTRIBUTES","MEDIA_KEY_SHORTCUTS","togglePaused","toggleMuted","toggleFullscreen","togglePictureInPicture","toggleCaptions","seekBackward","seekForward","volumeUp","volumeDown","MODIFIER_KEYS","Set","BUTTON_SELECTORS","IGNORE_SELECTORS","MediaKeyboardController","constructor","instance","_media","_onTargetChange","keyDisabled","keyTarget","$props","$active","listen","contains","querySelector","activePlayer","composedPath","find","Element","_onKeyUp","_onKeyDown","_onPreventVideoKeys","capture","focused","activeElement","sliderFocused","$store","canSeek","method","_getMatchingMethod","preventDefault","stopPropagation","_timeSlider","_forwardTimeKeyboardEvent","remote","seek","_seekTotal","volumeSlider","has","metaKey","duration","Number","_seeking","shiftKey","changeVolume","keyShortcuts","ariaKeys","split","some","replaceSymbolKeys","replace","every","_calcSeekAmount","seekBy","Math","max","min","currentTime","seeking","SYMBOL_KEY_MAP","_","num","mediaPlayerProps","autoplay","aspectRatio","from","width","height","map","toFixed","controls","crossorigin","fullscreenOrientation","load","logLevel","loop","muted","paused","playsinline","playbackRate","poster","preload","preferNativeHLS","attribute","src","userIdleDelay","viewType","streamType","liveEdgeTolerance","minLiveDVRWindow","title","thumbnails","textTracks","smallBreakpointX","largeBreakpointX","smallBreakpointY","largeBreakpointY","TimeRange","_ranges","start","end","throwIfEmpty","throwIfOutOfRange","Infinity","getTimeRangesStart","range","getTimeRangesEnd","fnName","MediaStoreFactory","audioTracks","audioTrack","autoplayError","buffered","canLoad","canPictureInPicture","canPlay","ended","mediaType","played","playing","pictureInPicture","qualities","quality","autoQuality","canSetQuality","seekable","source","sources","started","textTrack","thumbnailCues","waiting","providedViewType","providedStreamType","inferredStreamType","currentSrc","bufferedStart","bufferedEnd","seekableStart","seekableEnd","seekableWindow","touchPointer","mediaWidth","mediaHeight","breakpointX","breakpointY","userIdle","userBehindLiveEdge","isFinite","live","liveEdgeStart","liveSyncPosition","liveEdge","liveEdgeWindow","autoplaying","DO_NOT_RESET_ON_SRC_CHANGE","softResetMediaStore","$media","reset","prop","SELECTED","SelectList","selected","selectedIndex","findIndex","prev","changed","current","SET_AUTO_QUALITY","ENABLE_AUTO_QUALITY","VideoQualityList","_auto","switch","auto","autoSelect","MEDIA_EVENTS","MediaEventsLogger","_onMediaEvent","eventType","logger","infoGroup","labelledLog","MediaLoadController","_callback","onAttach","waitIdlePeriod","observer","IntersectionObserver","entries","isIntersecting","disconnect","observe","MediaPlayerDelegate","_handle","_dispatch","init","_ready","info","_attemptAutoplay","player","play","Queue","_queue","Map","_enqueue","add","_serve","items","delete","_delete","_size","size","_reset","clear","coerceToError","JSON","stringify","MediaUserController","_idleTimer","_delay","_pausedTracking","_focusedItem","idling","idleDelay","newDelay","idle","delay","_clearIdleTimer","_requestIdleChange","pauseIdleTracking","_watchPaused","_onMediaPlay","_onMediaPause","onStopIdle","_onStopIdle","clearTimeout","MEDIA_GESTURE","focus","_onIdleChange","setTimeout","MediaRequestContext","_looping","_replaying","MediaRequestManager","_stateMgr","_request","_store","_provider","$provider","_user","_fullscreen","_orientation","_onIdleDelayChange","_onFullscreenSupportChange","_onPiPSupportChange","names","getOwnPropertyNames","getPrototypeOf","handle","_handleRequest","_play","provider","throwIfNotReadyForPlayback","errorEvent","createEvent","_pause","pause","_seekToLiveEdge","_wasPIPActive","_enterFullscreen","adapter","throwIfFullscreenNotSupported","_exitPictureInPicture","_exitFullscreen","result","_enterPictureInPicture","_throwIfPIPNotSupported","media-audio-track-change-request","warnGroup","track","media-enter-fullscreen-request","media-exit-fullscreen-request","e","media-enter-pip-request","_onPictureInPictureError","media-exit-pip-request","media-live-edge-request","media-loop-request","media-pause-request","media-play-request","media-rate-change-request","media-quality-change-request","media-resume-user-idle-request","media-pause-user-idle-request","media-seek-request","boundTime","isOriginTrusted","abs","media-seeking-request","media-start-loading","media-text-track-change-request","mode","setMode","media-mute-request","media-unmute-request","media-volume-change-request","newVolume","functionDebounce","debounce","fn","wait","callFirst","timeout","debouncedFn","flush","call","debounceWrapper","apply","arguments","context","args","callNow","cancel","functionThrottle","throttle","interval","timeoutId","throttledFn","leading","trailing","throttleWrapper","ATTACH_VIDEO","TEXT_TRACK_CROSSORIGIN","TEXT_TRACK_READY_STATE","TEXT_TRACK_UPDATE_ACTIVE_CUES","TEXT_TRACK_CAN_LOAD","TEXT_TRACK_ON_MODE_CHANGE","TEXT_TRACK_NATIVE","TEXT_TRACK_NATIVE_HLS","TRACKED_EVENT","MediaStateManager","_trackedEvents","_skipInitialSrcChange","_firingWaiting","_waitingTrigger","_addTextTrackListeners","_addQualityListeners","_addAudioTrackListeners","_resetTracking","_stopWaiting","_satisfyRequest","request","requestEvent","_onTextTracksChange","_onTextTrackModeChange","_onQualitiesChange","_onQualityChange","_onAutoQualityChange","_onCanSetQualityChange","_onAudioTracksChange","_onAudioTrackChange","provider-change","autoplay-fail","can-load","media-type-change","stream-type-change","rate-change","sources-change","source-change","abort","load-start","loaded-metadata","loaded-data","can-play","_onCanPlayDetail","can-play-through","duration-change","time","isNaN","progress","stopImmediatePropagation","play-fail","playEvent","time-update","volume-change","_fireWaiting","seeked","waitingEvent","origin","originEvent","isTrusted","fullscreen-change","fullscreen-error","picture-in-picture-change","picture-in-picture-error","MediaStoreSync","_onLogLevelChange","_onAutoplayChange","_onPosterChange","_onLoopChange","_onControlsChange","_onCrossOriginChange","_onPlaysinlineChange","_onLiveToleranceChange","_onLiveChange","_onLiveEdgeChange","_onThumbnailsChange","preconnect","url","rel","exists","link","href","crossOrigin","head","append","pendingRequests","loadScript","promise","resolve","script","onload","onerror","reject","getRequestCredentials","findActiveCue","cues","len","isCueActive","cue","startTime","endTime","onTrackChapterChange","tracks","currentTrack","onChange","track2","kind","readyState","once","TextTrack","createId","content","encoding","id","language","default","_canLoad","_currentTime","_mode","_metadata","_regions","_cues","_activeCues","metadata","regions","activeCues","then","parseText","VTTCue","VTTRegion","_parseJSON","_readyState","isTrackCaptionKind","addCue","removeCue","isActive","_activeCuesChanged","_load","parseResponse","response","fetch","headers","credentials","text","errors","code","_errorState","nativeTrack","loadEvent","json","parse","json2","assign","filter","console","captionRE","MediaRemoteControl","_logger","_target","_player","_prevTrackIndex","setTarget","getPlayer","bubbles","composed","setPlayer","startLoading","_dispatchRequest","mute","unmute","enterFullscreen","enterPictureInPicture","exitPictureInPicture","seekToLiveEdge","changeAudioTrack","changeQuality","changeTextTrackMode","changePlaybackRate","rate","resumeUserIdle","pauseUserIdle","_noPlayerWarning","state","toggleUserIdle","user","shouldUsePlayer","body","warn","ThumbnailsLoader","_onLoadCues","controller","AbortController","catch","AudioTrackList","getById","NativeTextRenderer","priority","_display","_video","_track","_tracks","canRender","attach","_onChange","addTrack","_attachTrack","removeTrack","changeTrack","setDisplay","display","detach","_createTrackElement","HTMLElement","isDefault","isSupported","srclang","_copyCues","native","isShowing","TextRenderers","_textTracks","_watchControls","_detach","_onAddTrack","_onRemoveTrack","_update","_renderers","_nativeDisplay","_nativeRenderer","_customRenderer","$iosControls","renderer","_addNativeTrack","_removeNativeTrack","customRenderer","sort","a","b","loader","TextTrackList","_defaults","t","isTrack","_onTrackModeChangeBind","getByKind","kinds","Array","_onTrackModeChange","warned","SourceSelection","_domSources","_loader","HLS_LOADER","VIDEO_LOADER","AUDIO_LOADER","_loaders","_onSourcesChange","_onSourceChange","_onPreconnect","_onLoadSource","delegate","normalizeSrc","currentSource","newSource","_findNewSource","noMatch","Promise","all","res","sources2","aborted","newLoader","loader2","_notifySourceChange","_notifyLoaderChange","currentLoader","setup","loadSource","URL","src2","Tracks","_domTracks","_onTracksChange","_prevTracks","newTracks","oldTrack","newTrack","Outlet","tagName","resize","ResizeObserver","_onResize","mutation","MutationObserver","_onMutation","attributes","childList","passive","onDestroy","offsetWidth","offsetHeight","children","HTMLSourceElement","HTMLTrackElement","getAttribute","render","currentProvider","destroy","LibASSTextRenderer","config","_instance","_typeRE","mod","subUrl","canvas","_canvas","style","pointerEvents","_freeTrack","setTrackByUrl","freeTrack","ARIAKeyShortcuts","_shortcut","shortcuts","$","B","C","D","E","F","G","I","J","K","L","M","N","O","P","Q","R","S","T","U","W","X","Y","Z","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","c","d","f","g","h","j","k","l","m","n","o","p","q","r","s","u","v","w","x","y","z"],"sources":["/Users/user/Documents/mobilestreamapp/client/node_modules/vidstack/dist/dev/media-core.js"],"sourcesContent":["import { ComponentController, defineProp, Component, defineElement } from 'maverick.js/element';\nimport { signal, peek, effect, getScope, scoped, createContext, useContext, StoreFactory, tick, onDispose, computed } from 'maverick.js';\nimport { EventsTarget, DOMEvent, listenEvent, isUndefined, isFunction, waitTimeout, isKeyboardClick, setAttribute, isArray, isNumber, isKeyboardEvent, appendTriggerEvent, isNull, deferredPromise, isString, noop, animationFrameThrottle, setStyle } from 'maverick.js/std';\nimport { i as isHTMLMediaElement } from './providers/type-check.js';\nimport { A as AudioProviderLoader } from './providers/audio/loader.js';\nimport { H as HLSProviderLoader } from './providers/hls/loader.js';\nimport { V as VideoProviderLoader } from './providers/video/loader.js';\n\nconst LIST_ADD = Symbol(\"LIST_ADD\" );\nconst LIST_REMOVE = Symbol(\"LIST_REMOVE\" );\nconst LIST_RESET = Symbol(\"LIST_RESET\" );\nconst LIST_SELECT = Symbol(\"LIST_SELECT\" );\nconst LIST_READONLY = Symbol(\"LIST_READONLY\" );\nconst LIST_SET_READONLY = Symbol(\"LIST_SET_READONLY\" );\nconst LIST_ON_RESET = Symbol(\"LIST_ON_RESET\" );\nconst LIST_ON_REMOVE = Symbol(\"LIST_ON_REMOVE\" );\nconst LIST_ON_USER_SELECT = Symbol(\"LIST_ON_USER_SELECT\" );\n\nclass List extends EventsTarget {\n  _items = [];\n  /* @internal */\n  [LIST_READONLY] = false;\n  get length() {\n    return this._items.length;\n  }\n  get readonly() {\n    return this[LIST_READONLY];\n  }\n  /**\n   * Transform list to an array.\n   */\n  toArray() {\n    return [...this._items];\n  }\n  [Symbol.iterator]() {\n    return this._items.values();\n  }\n  /* @internal */\n  [LIST_ADD](item, trigger) {\n    const index = this._items.length;\n    if (!(\"\" + index in this)) {\n      Object.defineProperty(this, index, {\n        get() {\n          return this._items[index];\n        }\n      });\n    }\n    if (this._items.includes(item))\n      return;\n    this._items.push(item);\n    this.dispatchEvent(new DOMEvent(\"add\", { detail: item, trigger }));\n  }\n  /* @internal */\n  [LIST_REMOVE](item, trigger) {\n    const index = this._items.indexOf(item);\n    if (index >= 0) {\n      this[LIST_ON_REMOVE]?.(item, trigger);\n      this._items.splice(index, 1);\n      this.dispatchEvent(new DOMEvent(\"remove\", { detail: item, trigger }));\n    }\n  }\n  /* @internal */\n  [LIST_RESET](trigger) {\n    for (const item of [...this._items])\n      this[LIST_REMOVE](item, trigger);\n    this._items = [];\n    this[LIST_SET_READONLY](false, trigger);\n    this[LIST_ON_RESET]?.();\n  }\n  /* @internal */\n  [LIST_SET_READONLY](readonly, trigger) {\n    if (this[LIST_READONLY] === readonly)\n      return;\n    this[LIST_READONLY] = readonly;\n    this.dispatchEvent(new DOMEvent(\"readonly-change\", { detail: readonly, trigger }));\n  }\n}\n\nvar key = {\r\n    fullscreenEnabled: 0,\r\n    fullscreenElement: 1,\r\n    requestFullscreen: 2,\r\n    exitFullscreen: 3,\r\n    fullscreenchange: 4,\r\n    fullscreenerror: 5,\r\n    fullscreen: 6\r\n};\r\nvar webkit = [\r\n    'webkitFullscreenEnabled',\r\n    'webkitFullscreenElement',\r\n    'webkitRequestFullscreen',\r\n    'webkitExitFullscreen',\r\n    'webkitfullscreenchange',\r\n    'webkitfullscreenerror',\r\n    '-webkit-full-screen',\r\n];\r\nvar moz = [\r\n    'mozFullScreenEnabled',\r\n    'mozFullScreenElement',\r\n    'mozRequestFullScreen',\r\n    'mozCancelFullScreen',\r\n    'mozfullscreenchange',\r\n    'mozfullscreenerror',\r\n    '-moz-full-screen',\r\n];\r\nvar ms = [\r\n    'msFullscreenEnabled',\r\n    'msFullscreenElement',\r\n    'msRequestFullscreen',\r\n    'msExitFullscreen',\r\n    'MSFullscreenChange',\r\n    'MSFullscreenError',\r\n    '-ms-fullscreen',\r\n];\r\n// so it doesn't throw if no window or document\r\nvar document$1 = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\r\nvar vendor = (('fullscreenEnabled' in document$1 && Object.keys(key)) ||\r\n    (webkit[0] in document$1 && webkit) ||\r\n    (moz[0] in document$1 && moz) ||\r\n    (ms[0] in document$1 && ms) ||\r\n    []);\r\nvar fscreen = {\r\n    requestFullscreen: function (element) { return element[vendor[key.requestFullscreen]](); },\r\n    requestFullscreenFunction: function (element) { return element[vendor[key.requestFullscreen]]; },\r\n    get exitFullscreen() { return document$1[vendor[key.exitFullscreen]].bind(document$1); },\r\n    get fullscreenPseudoClass() { return \":\" + vendor[key.fullscreen]; },\r\n    addEventListener: function (type, handler, options) { return document$1.addEventListener(vendor[key[type]], handler, options); },\r\n    removeEventListener: function (type, handler, options) { return document$1.removeEventListener(vendor[key[type]], handler, options); },\r\n    get fullscreenEnabled() { return Boolean(document$1[vendor[key.fullscreenEnabled]]); },\r\n    set fullscreenEnabled(val) { },\r\n    get fullscreenElement() { return document$1[vendor[key.fullscreenElement]]; },\r\n    set fullscreenElement(val) { },\r\n    get onfullscreenchange() { return document$1[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()]; },\r\n    set onfullscreenchange(handler) { return document$1[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()] = handler; },\r\n    get onfullscreenerror() { return document$1[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()]; },\r\n    set onfullscreenerror(handler) { return document$1[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()] = handler; },\r\n};\n\nvar fscreen$1 = fscreen;\n\nconst CAN_FULLSCREEN = fscreen$1.fullscreenEnabled;\nclass FullscreenController extends ComponentController {\n  /**\n   * Tracks whether we're the active fullscreen event listener. Fullscreen events can only be\n   * listened to globally on the document so we need to know if they relate to the current host\n   * element or not.\n   */\n  _listening = false;\n  _active = false;\n  get active() {\n    return this._active;\n  }\n  get supported() {\n    return CAN_FULLSCREEN;\n  }\n  onConnect() {\n    listenEvent(fscreen$1, \"fullscreenchange\", this._onFullscreenChange.bind(this));\n    listenEvent(fscreen$1, \"fullscreenerror\", this._onFullscreenError.bind(this));\n  }\n  async onDisconnect() {\n    if (CAN_FULLSCREEN)\n      await this.exit();\n  }\n  _onFullscreenChange(event) {\n    const active = isFullscreen(this.el);\n    if (active === this._active)\n      return;\n    if (!active)\n      this._listening = false;\n    this._active = active;\n    this.dispatch(\"fullscreen-change\", { detail: active, trigger: event });\n  }\n  _onFullscreenError(event) {\n    if (!this._listening)\n      return;\n    this.dispatch(\"fullscreen-error\", { detail: null, trigger: event });\n    this._listening = false;\n  }\n  async enter() {\n    try {\n      this._listening = true;\n      if (!this.el || isFullscreen(this.el))\n        return;\n      assertFullscreenAPI();\n      return fscreen$1.requestFullscreen(this.el);\n    } catch (error) {\n      this._listening = false;\n      throw error;\n    }\n  }\n  async exit() {\n    if (!this.el || !isFullscreen(this.el))\n      return;\n    assertFullscreenAPI();\n    return fscreen$1.exitFullscreen();\n  }\n}\nfunction canFullscreen() {\n  return CAN_FULLSCREEN;\n}\nfunction isFullscreen(host) {\n  if (fscreen$1.fullscreenElement === host)\n    return true;\n  try {\n    return host.matches(\n      // @ts-expect-error - `fullscreenPseudoClass` is missing from `@types/fscreen`.\n      fscreen$1.fullscreenPseudoClass\n    );\n  } catch (error) {\n    return false;\n  }\n}\nfunction assertFullscreenAPI() {\n  if (CAN_FULLSCREEN)\n    return;\n  throw Error(\n    \"[vidstack] fullscreen API is not enabled or supported in this environment\" \n  );\n}\n\nconst UA = navigator?.userAgent.toLowerCase();\nconst IS_IOS = /iphone|ipad|ipod|ios|crios|fxios/i.test(UA);\nconst IS_IPHONE = /(iphone|ipod)/gi.test(navigator?.platform);\nconst IS_CHROME = !!window.chrome;\nconst IS_SAFARI = !!window.safari || IS_IOS;\nfunction canOrientScreen() {\n  return !isUndefined(screen.orientation) && isFunction(screen.orientation.lock) && isFunction(screen.orientation.unlock);\n}\nfunction canPlayHLSNatively(video) {\n  if (!video)\n    video = document.createElement(\"video\");\n  return video.canPlayType(\"application/vnd.apple.mpegurl\").length > 0;\n}\nfunction canUsePictureInPicture(video) {\n  return !!document.pictureInPictureEnabled && !video.disablePictureInPicture;\n}\nfunction canUseVideoPresentation(video) {\n  return isFunction(video.webkitSupportsPresentationMode) && isFunction(video.webkitSetPresentationMode);\n}\nasync function canChangeVolume() {\n  const video = document.createElement(\"video\");\n  video.volume = 0.5;\n  await waitTimeout(0);\n  return video.volume === 0.5;\n}\nfunction getMediaSource() {\n  return window?.MediaSource ?? window?.WebKitMediaSource;\n}\nfunction getSourceBuffer() {\n  return window?.SourceBuffer ?? window?.WebKitSourceBuffer;\n}\nfunction isHLSSupported() {\n  const MediaSource = getMediaSource();\n  if (isUndefined(MediaSource))\n    return false;\n  const isTypeSupported = MediaSource && isFunction(MediaSource.isTypeSupported) && MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\n  const SourceBuffer = getSourceBuffer();\n  const isSourceBufferValid = isUndefined(SourceBuffer) || !isUndefined(SourceBuffer.prototype) && isFunction(SourceBuffer.prototype.appendBuffer) && isFunction(SourceBuffer.prototype.remove);\n  return !!isTypeSupported && !!isSourceBufferValid;\n}\n\nconst CAN_USE_SCREEN_ORIENTATION_API = canOrientScreen();\nclass ScreenOrientationController extends ComponentController {\n  _type = signal(getScreenOrientation());\n  _locked = signal(false);\n  _currentLock;\n  /**\n   * The current screen orientation type.\n   *\n   * @signal\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation}\n   * @see https://w3c.github.io/screen-orientation/#screen-orientation-types-and-locks\n   */\n  get type() {\n    return this._type();\n  }\n  /**\n   * Whether the screen orientation is currently locked.\n   *\n   * @signal\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation}\n   * @see https://w3c.github.io/screen-orientation/#screen-orientation-types-and-locks\n   */\n  get locked() {\n    return this._locked();\n  }\n  /**\n   * Whether the viewport is in a portrait orientation.\n   *\n   * @signal\n   */\n  get portrait() {\n    return this._type().startsWith(\"portrait\");\n  }\n  /**\n   * Whether the viewport is in a landscape orientation.\n   *\n   * @signal\n   */\n  get landscape() {\n    return this._type().startsWith(\"landscape\");\n  }\n  /**\n   * Whether the native Screen Orientation API is available.\n   */\n  get supported() {\n    return CAN_USE_SCREEN_ORIENTATION_API;\n  }\n  onConnect() {\n    if (CAN_USE_SCREEN_ORIENTATION_API) {\n      listenEvent(screen.orientation, \"change\", this._onOrientationChange.bind(this));\n    } else {\n      const query = window.matchMedia(\"(orientation: landscape)\");\n      query.onchange = this._onOrientationChange.bind(this);\n      return () => query.onchange = null;\n    }\n  }\n  async onDisconnect() {\n    if (CAN_USE_SCREEN_ORIENTATION_API && this._locked())\n      await this.unlock();\n  }\n  _onOrientationChange(event) {\n    this._type.set(getScreenOrientation());\n    this.dispatch(\"orientation-change\", {\n      detail: {\n        orientation: peek(this._type),\n        lock: this._currentLock\n      },\n      trigger: event\n    });\n  }\n  /**\n   * Locks the orientation of the screen to the desired orientation type using the\n   * Screen Orientation API.\n   *\n   * @param lockType - The screen lock orientation type.\n   * @throws Error - If screen orientation API is unavailable.\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation}\n   * @see {@link https://w3c.github.io/screen-orientation}\n   */\n  async lock(lockType) {\n    if (peek(this._locked) || this._currentLock === lockType)\n      return;\n    assertScreenOrientationAPI();\n    await screen.orientation.lock(lockType);\n    this._locked.set(true);\n    this._currentLock = lockType;\n  }\n  /**\n   * Unlocks the orientation of the screen to it's default state using the Screen Orientation\n   * API. This method will throw an error if the API is unavailable.\n   *\n   * @throws Error - If screen orientation API is unavailable.\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation}\n   * @see {@link https://w3c.github.io/screen-orientation}\n   */\n  async unlock() {\n    if (!peek(this._locked))\n      return;\n    assertScreenOrientationAPI();\n    this._currentLock = void 0;\n    await screen.orientation.unlock();\n    this._locked.set(false);\n  }\n}\nfunction assertScreenOrientationAPI() {\n  if (CAN_USE_SCREEN_ORIENTATION_API)\n    return;\n  throw Error(\n    \"[vidstack] screen orientation API is not available\" \n  );\n}\nfunction getScreenOrientation() {\n  if (CAN_USE_SCREEN_ORIENTATION_API)\n    return window.screen.orientation.type;\n  return window.innerWidth >= window.innerHeight ? \"landscape-primary\" : \"portrait-primary\";\n}\n\nfunction setAttributeIfEmpty(target, name, value) {\n  if (!target.hasAttribute(name))\n    target.setAttribute(name, value);\n}\nfunction setARIALabel(target, label) {\n  if (target.hasAttribute(\"aria-label\") || target.hasAttribute(\"aria-describedby\"))\n    return;\n  function updateAriaDescription() {\n    setAttribute(target, \"aria-label\", label());\n  }\n  effect(updateAriaDescription);\n}\nfunction isElementParent(owner, node, test) {\n  while (node) {\n    if (node === owner) {\n      return true;\n    } else if (node.localName === owner.localName || test?.(node)) {\n      break;\n    } else {\n      node = node.parentElement;\n    }\n  }\n  return false;\n}\nfunction onPress(target, handler) {\n  listenEvent(target, \"pointerup\", (event) => {\n    if (event.button === 0)\n      handler(event);\n  });\n  listenEvent(target, \"keydown\", (event) => {\n    if (isKeyboardClick(event))\n      handler(event);\n  });\n}\nfunction scopedRaf(callback) {\n  const scope = getScope();\n  requestAnimationFrame(() => scoped(callback, scope));\n}\n\nconst mediaContext = createContext();\nfunction useMedia() {\n  return useContext(mediaContext);\n}\n\nconst MEDIA_ATTRIBUTES = [\n  \"autoplay\",\n  \"autoplayError\",\n  \"canFullscreen\",\n  \"canPictureInPicture\",\n  \"canLoad\",\n  \"canPlay\",\n  \"canSeek\",\n  \"ended\",\n  \"error\",\n  \"fullscreen\",\n  \"loop\",\n  \"live\",\n  \"liveEdge\",\n  \"mediaType\",\n  \"muted\",\n  \"paused\",\n  \"pictureInPicture\",\n  \"playing\",\n  \"playsinline\",\n  \"seeking\",\n  \"started\",\n  \"streamType\",\n  \"userIdle\",\n  \"viewType\",\n  \"waiting\"\n];\n\nconst MEDIA_KEY_SHORTCUTS = {\n  togglePaused: \"k Space\",\n  toggleMuted: \"m\",\n  toggleFullscreen: \"f\",\n  togglePictureInPicture: \"i\",\n  toggleCaptions: \"c\",\n  seekBackward: \"ArrowLeft\",\n  seekForward: \"ArrowRight\",\n  volumeUp: \"ArrowUp\",\n  volumeDown: \"ArrowDown\"\n};\nconst MODIFIER_KEYS = /* @__PURE__ */ new Set([\"Shift\", \"Alt\", \"Meta\", \"Control\"]), BUTTON_SELECTORS = 'button, [role=\"button\"]', IGNORE_SELECTORS = 'input, textarea, select, [contenteditable], [role^=\"menuitem\"]';\nclass MediaKeyboardController extends ComponentController {\n  constructor(instance, _media) {\n    super(instance);\n    this._media = _media;\n  }\n  onConnect() {\n    effect(this._onTargetChange.bind(this));\n  }\n  _onTargetChange() {\n    const { keyDisabled, keyTarget } = this.$props;\n    if (keyDisabled())\n      return;\n    const target = keyTarget() === \"player\" ? this.el : document, $active = signal(false);\n    if (target === this.el) {\n      this.listen(\"focusin\", () => $active.set(true));\n      this.listen(\"focusout\", (event) => {\n        if (!this.el.contains(event.target))\n          $active.set(false);\n      });\n    } else {\n      if (!peek($active))\n        $active.set(document.querySelector(\"media-player\") === this.el);\n      listenEvent(document, \"focusin\", (event) => {\n        const activePlayer = event.composedPath().find((el) => el instanceof Element && el.localName === \"media-player\");\n        if (activePlayer !== void 0)\n          $active.set(this.el === activePlayer);\n      });\n    }\n    effect(() => {\n      if (!$active())\n        return;\n      listenEvent(target, \"keyup\", this._onKeyUp.bind(this));\n      listenEvent(target, \"keydown\", this._onKeyDown.bind(this));\n      listenEvent(target, \"keydown\", this._onPreventVideoKeys.bind(this), { capture: true });\n    });\n  }\n  _onKeyUp(event) {\n    const focused = document.activeElement, sliderFocused = focused?.hasAttribute(\"data-media-slider\");\n    if (!event.key || !this.$store.canSeek() || sliderFocused || focused?.matches(IGNORE_SELECTORS)) {\n      return;\n    }\n    const method = this._getMatchingMethod(event);\n    if (method?.startsWith(\"seek\")) {\n      event.preventDefault();\n      event.stopPropagation();\n      if (this._timeSlider) {\n        this._forwardTimeKeyboardEvent(event);\n        this._timeSlider = null;\n      } else {\n        this._media.remote.seek(this._seekTotal, event);\n        this._seekTotal = void 0;\n      }\n    }\n    if (method?.startsWith(\"volume\")) {\n      const volumeSlider = this.el.querySelector(\"media-volume-slider\");\n      volumeSlider?.dispatchEvent(new DOMEvent(\"keyup\", { trigger: event }));\n    }\n  }\n  _onKeyDown(event) {\n    if (!event.key || MODIFIER_KEYS.has(event.key))\n      return;\n    const focused = document.activeElement;\n    if (focused?.matches(IGNORE_SELECTORS) || isKeyboardClick(event) && focused?.matches(BUTTON_SELECTORS)) {\n      return;\n    }\n    const sliderFocused = focused?.hasAttribute(\"data-media-slider\"), method = this._getMatchingMethod(event);\n    if (!method && !event.metaKey && /[0-9]/.test(event.key) && !sliderFocused) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._media.remote.seek(this.$store.duration() / 10 * Number(event.key), event);\n      return;\n    }\n    if (!method || /volume|seek/.test(method) && sliderFocused)\n      return;\n    event.preventDefault();\n    event.stopPropagation();\n    switch (method) {\n      case \"seekForward\":\n      case \"seekBackward\":\n        this._seeking(event, method);\n        break;\n      case \"volumeUp\":\n      case \"volumeDown\":\n        const volumeSlider = this.el.querySelector(\"media-volume-slider\");\n        if (volumeSlider) {\n          volumeSlider.dispatchEvent(new DOMEvent(\"keydown\", { trigger: event }));\n        } else {\n          const value = event.shiftKey ? 0.1 : 0.05;\n          this._media.remote.changeVolume(\n            this.$store.volume() + (method === \"volumeUp\" ? +value : -value),\n            event\n          );\n        }\n        break;\n      case \"toggleFullscreen\":\n        this._media.remote.toggleFullscreen(\"prefer-media\", event);\n        break;\n      default:\n        this._media.remote[method]?.(event);\n    }\n  }\n  _onPreventVideoKeys(event) {\n    if (isHTMLMediaElement(event.target) && this._getMatchingMethod(event)) {\n      event.preventDefault();\n    }\n  }\n  _getMatchingMethod(event) {\n    const keyShortcuts = {\n      ...this.$props.keyShortcuts(),\n      ...this._media.ariaKeys\n    };\n    return Object.keys(keyShortcuts).find(\n      (method) => keyShortcuts[method].split(\" \").some(\n        (keys) => replaceSymbolKeys(keys).replace(/Control/g, \"Ctrl\").split(\"+\").every(\n          (key) => MODIFIER_KEYS.has(key) ? event[key.toLowerCase() + \"Key\"] : event.key === key.replace(\"Space\", \" \")\n        )\n      )\n    );\n  }\n  _seekTotal;\n  _calcSeekAmount(event, type) {\n    const seekBy = event.shiftKey ? 10 : 5;\n    return this._seekTotal = Math.max(\n      0,\n      Math.min(\n        (this._seekTotal ?? this.$store.currentTime()) + (type === \"seekForward\" ? +seekBy : -seekBy),\n        this.$store.duration()\n      )\n    );\n  }\n  _timeSlider = null;\n  _forwardTimeKeyboardEvent(event) {\n    this._timeSlider?.dispatchEvent(new DOMEvent(event.type, { trigger: event }));\n  }\n  _seeking(event, type) {\n    if (!this.$store.canSeek())\n      return;\n    if (!this._timeSlider)\n      this._timeSlider = this.el.querySelector(\"media-time-slider\");\n    if (this._timeSlider) {\n      this._forwardTimeKeyboardEvent(event);\n    } else {\n      this._media.remote.seeking(this._calcSeekAmount(event, type), event);\n    }\n  }\n}\nconst SYMBOL_KEY_MAP = [\"!\", \"@\", \"#\", \"$\", \"%\", \"^\", \"&\", \"*\", \"(\", \")\"];\nfunction replaceSymbolKeys(key) {\n  return key.replace(/Shift\\+(\\d)/g, (_, num) => SYMBOL_KEY_MAP[num - 1]);\n}\n\nconst mediaPlayerProps = {\n  autoplay: false,\n  aspectRatio: defineProp({\n    value: null,\n    type: {\n      from(value) {\n        if (!value)\n          return null;\n        if (!value.includes(\"/\"))\n          return +value;\n        const [width, height] = value.split(\"/\").map(Number);\n        return +(width / height).toFixed(4);\n      }\n    }\n  }),\n  controls: false,\n  currentTime: 0,\n  crossorigin: null,\n  fullscreenOrientation: \"landscape\",\n  load: \"visible\",\n  logLevel: \"silent\",\n  loop: false,\n  muted: false,\n  paused: true,\n  playsinline: false,\n  playbackRate: 1,\n  poster: \"\",\n  preload: \"metadata\",\n  preferNativeHLS: defineProp({\n    value: false,\n    attribute: \"prefer-native-hls\"\n  }),\n  src: \"\",\n  userIdleDelay: 2e3,\n  viewType: \"unknown\",\n  streamType: \"unknown\",\n  volume: 1,\n  liveEdgeTolerance: 10,\n  minLiveDVRWindow: 60,\n  keyDisabled: false,\n  keyTarget: \"player\",\n  keyShortcuts: MEDIA_KEY_SHORTCUTS,\n  title: \"\",\n  thumbnails: null,\n  textTracks: defineProp({\n    value: [],\n    attribute: false\n  }),\n  smallBreakpointX: 600,\n  largeBreakpointX: 980,\n  smallBreakpointY: 380,\n  largeBreakpointY: 600\n};\n\nclass TimeRange {\n  _ranges;\n  get length() {\n    return this._ranges.length;\n  }\n  constructor(start, end) {\n    if (isArray(start)) {\n      this._ranges = start;\n    } else if (!isUndefined(start) && !isUndefined(end)) {\n      this._ranges = [[start, end]];\n    } else {\n      this._ranges = [];\n    }\n  }\n  start(index) {\n    throwIfEmpty(this._ranges.length);\n    throwIfOutOfRange(\"start\", index, this._ranges.length - 1);\n    return this._ranges[index][0] ?? Infinity;\n  }\n  end(index) {\n    throwIfEmpty(this._ranges.length);\n    throwIfOutOfRange(\"end\", index, this._ranges.length - 1);\n    return this._ranges[index][1] ?? Infinity;\n  }\n}\nfunction getTimeRangesStart(range) {\n  if (!range.length)\n    return null;\n  let min = range.start(0);\n  for (let i = 1; i < range.length; i++) {\n    const value = range.start(i);\n    if (value < min)\n      min = value;\n  }\n  return min;\n}\nfunction getTimeRangesEnd(range) {\n  if (!range.length)\n    return null;\n  let max = range.end(0);\n  for (let i = 1; i < range.length; i++) {\n    const value = range.end(i);\n    if (value > max)\n      max = value;\n  }\n  return max;\n}\nfunction throwIfEmpty(length) {\n  if (!length)\n    throw new Error(\"`TimeRanges` object is empty.\" );\n}\nfunction throwIfOutOfRange(fnName, index, end) {\n  if (!isNumber(index) || index < 0 || index > end) {\n    throw new Error(\n      `Failed to execute '${fnName}' on 'TimeRanges': The index provided (${index}) is non-numeric or out of bounds (0-${end}).`\n    );\n  }\n}\n\nconst MediaStoreFactory = new StoreFactory({\n  audioTracks: [],\n  audioTrack: null,\n  autoplay: false,\n  autoplayError: void 0,\n  buffered: new TimeRange(),\n  duration: 0,\n  canLoad: false,\n  canFullscreen: false,\n  canPictureInPicture: false,\n  canPlay: false,\n  controls: false,\n  crossorigin: null,\n  poster: \"\",\n  currentTime: 0,\n  ended: false,\n  error: void 0,\n  fullscreen: false,\n  loop: false,\n  logLevel: \"warn\" ,\n  mediaType: \"unknown\",\n  muted: false,\n  paused: true,\n  played: new TimeRange(),\n  playing: false,\n  playsinline: false,\n  pictureInPicture: false,\n  preload: \"metadata\",\n  playbackRate: 1,\n  qualities: [],\n  quality: null,\n  autoQuality: false,\n  canSetQuality: true,\n  seekable: new TimeRange(),\n  seeking: false,\n  source: { src: \"\", type: \"\" },\n  sources: [],\n  started: false,\n  title: \"\",\n  textTracks: [],\n  textTrack: null,\n  thumbnails: null,\n  thumbnailCues: [],\n  volume: 1,\n  waiting: false,\n  get viewType() {\n    return this.providedViewType !== \"unknown\" ? this.providedViewType : this.mediaType;\n  },\n  get streamType() {\n    return this.providedStreamType !== \"unknown\" ? this.providedStreamType : this.inferredStreamType;\n  },\n  get currentSrc() {\n    return this.source;\n  },\n  get bufferedStart() {\n    return getTimeRangesStart(this.buffered) ?? 0;\n  },\n  get bufferedEnd() {\n    return getTimeRangesEnd(this.buffered) ?? 0;\n  },\n  get seekableStart() {\n    return getTimeRangesStart(this.seekable) ?? 0;\n  },\n  get seekableEnd() {\n    return this.canPlay ? getTimeRangesEnd(this.seekable) ?? Infinity : 0;\n  },\n  get seekableWindow() {\n    return Math.max(0, this.seekableEnd - this.seekableStart);\n  },\n  // ~~ responsive design ~~\n  touchPointer: false,\n  orientation: \"landscape\",\n  mediaWidth: 0,\n  mediaHeight: 0,\n  breakpointX: \"sm\",\n  breakpointY: \"sm\",\n  // ~~ user props ~~\n  userIdle: false,\n  userBehindLiveEdge: false,\n  // ~~ live props ~~\n  liveEdgeTolerance: 10,\n  minLiveDVRWindow: 60,\n  get canSeek() {\n    return /unknown|on-demand|:dvr/.test(this.streamType) && Number.isFinite(this.seekableWindow) && (!this.live || /:dvr/.test(this.streamType) && this.seekableWindow >= this.minLiveDVRWindow);\n  },\n  get live() {\n    return this.streamType.includes(\"live\") || !Number.isFinite(this.duration);\n  },\n  get liveEdgeStart() {\n    return this.live && Number.isFinite(this.seekableEnd) ? Math.max(0, (this.liveSyncPosition ?? this.seekableEnd) - this.liveEdgeTolerance) : 0;\n  },\n  get liveEdge() {\n    return this.live && (!this.canSeek || !this.userBehindLiveEdge && this.currentTime >= this.liveEdgeStart);\n  },\n  get liveEdgeWindow() {\n    return this.live && Number.isFinite(this.seekableEnd) ? this.seekableEnd - this.liveEdgeStart : 0;\n  },\n  // ~~ internal props ~~\n  autoplaying: false,\n  providedViewType: \"unknown\",\n  providedStreamType: \"unknown\",\n  inferredStreamType: \"unknown\",\n  liveSyncPosition: null\n});\nconst DO_NOT_RESET_ON_SRC_CHANGE = /* @__PURE__ */ new Set([\n  \"autoplay\",\n  \"breakpointX\",\n  \"breakpointY\",\n  \"canFullscreen\",\n  \"canLoad\",\n  \"canPictureInPicture\",\n  \"controls\",\n  \"fullscreen\",\n  \"logLevel\",\n  \"loop\",\n  \"mediaHeight\",\n  \"mediaWidth\",\n  \"muted\",\n  \"orientation\",\n  \"pictureInPicture\",\n  \"playsinline\",\n  \"poster\",\n  \"preload\",\n  \"providedStreamType\",\n  \"providedViewType\",\n  \"source\",\n  \"sources\",\n  \"textTrack\",\n  \"textTracks\",\n  \"thumbnailCues\",\n  \"thumbnails\",\n  \"title\",\n  \"touchPointer\",\n  \"volume\"\n]);\nfunction softResetMediaStore($media) {\n  MediaStoreFactory.reset($media, (prop) => !DO_NOT_RESET_ON_SRC_CHANGE.has(prop));\n  tick();\n}\n\nconst SELECTED = Symbol(\"SELECTED\" );\nclass SelectList extends List {\n  get selected() {\n    return this._items.find((item) => item.selected) ?? null;\n  }\n  get selectedIndex() {\n    return this._items.findIndex((item) => item.selected);\n  }\n  /* @internal */\n  [LIST_ON_REMOVE](item, trigger) {\n    this[LIST_SELECT](item, false, trigger);\n  }\n  /* @internal */\n  [LIST_ADD](item, trigger) {\n    item[SELECTED] = false;\n    Object.defineProperty(item, \"selected\", {\n      get() {\n        return this[SELECTED];\n      },\n      set: (selected) => {\n        if (this.readonly)\n          return;\n        this[LIST_ON_USER_SELECT]?.();\n        this[LIST_SELECT](item, selected);\n      }\n    });\n    super[LIST_ADD](item, trigger);\n  }\n  /* @internal */\n  [LIST_SELECT](item, selected, trigger) {\n    if (selected === item[SELECTED])\n      return;\n    const prev = this.selected;\n    item[SELECTED] = selected;\n    const changed = !selected ? prev === item : prev !== item;\n    if (changed) {\n      if (prev)\n        prev[SELECTED] = false;\n      this.dispatchEvent(\n        new DOMEvent(\"change\", {\n          detail: { prev, current: this.selected },\n          trigger\n        })\n      );\n    }\n  }\n}\n\nconst SET_AUTO_QUALITY = Symbol(\"SET_AUTO_QUALITY\" );\nconst ENABLE_AUTO_QUALITY = Symbol(\"ENABLE_AUTO_QUALITY\" );\n\nclass VideoQualityList extends SelectList {\n  _auto = false;\n  /**\n   * Configures quality switching:\n   *\n   * - `current`: Trigger an immediate quality level switch. This will abort the current fragment\n   * request if any, flush the whole buffer, and fetch fragment matching with current position\n   * and requested quality level.\n   *\n   * - `next`: Trigger a quality level switch for next fragment. This could eventually flush\n   * already buffered next fragment.\n   *\n   * - `load`: Set quality level for next loaded fragment.\n   *\n   * @see {@link https://vidstack.io/docs/player/core-concepts/quality#switch}\n   * @see {@link https://github.com/video-dev/hls.js/blob/master/docs/API.md#quality-switch-control-api}\n   */\n  switch = \"current\";\n  /**\n   * Whether automatic quality selection is enabled.\n   */\n  get auto() {\n    return this._auto || this.readonly;\n  }\n  /* @internal */\n  [ENABLE_AUTO_QUALITY];\n  /* @internal */\n  [LIST_ON_USER_SELECT]() {\n    this[SET_AUTO_QUALITY](false);\n  }\n  /* @internal */\n  [LIST_ON_RESET](trigger) {\n    this[SET_AUTO_QUALITY](false, trigger);\n  }\n  /**\n   * Request automatic quality selection (if supported). This will be a no-op if the list is\n   * `readonly` as that already implies auto-selection.\n   */\n  autoSelect(trigger) {\n    if (this.readonly || this._auto || !this[ENABLE_AUTO_QUALITY])\n      return;\n    this[ENABLE_AUTO_QUALITY]();\n    this[SET_AUTO_QUALITY](true, trigger);\n  }\n  /* @internal */\n  [SET_AUTO_QUALITY](auto, trigger) {\n    if (this._auto === auto)\n      return;\n    this._auto = auto;\n    this.dispatchEvent(\n      new DOMEvent(\"auto-change\", {\n        detail: auto,\n        trigger\n      })\n    );\n  }\n}\n\nconst MEDIA_EVENTS = [\n  \"abort\",\n  \"can-play\",\n  \"can-play-through\",\n  \"duration-change\",\n  \"emptied\",\n  \"ended\",\n  \"error\",\n  \"fullscreen-change\",\n  \"loaded-data\",\n  \"loaded-metadata\",\n  \"load-start\",\n  \"media-type-change\",\n  \"pause\",\n  \"play\",\n  \"playing\",\n  \"progress\",\n  \"seeked\",\n  \"seeking\",\n  \"source-change\",\n  \"sources-change\",\n  \"stalled\",\n  \"started\",\n  \"suspend\",\n  \"stream-type-change\",\n  \"replay\",\n  // 'time-update',\n  \"view-type-change\",\n  \"volume-change\",\n  \"waiting\"\n] ;\nclass MediaEventsLogger extends ComponentController {\n  constructor(instance, _media) {\n    super(instance);\n    this._media = _media;\n  }\n  onConnect() {\n    const handler = this._onMediaEvent.bind(this);\n    for (const eventType of MEDIA_EVENTS)\n      this.listen(eventType, handler);\n  }\n  _onMediaEvent(event) {\n    this._media.logger?.infoGroup(`\\u{1F4E1} dispatching \\`${event.type}\\``).labelledLog(\"Media Store\", { ...this.$store }).labelledLog(\"Event\", event).dispatch();\n  }\n}\n\nclass MediaLoadController extends ComponentController {\n  constructor(instance, _callback) {\n    super(instance);\n    this._callback = _callback;\n  }\n  async onAttach(el) {\n    const load = this.$props.load();\n    if (load === \"eager\") {\n      requestAnimationFrame(this._callback);\n    } else if (load === \"idle\") {\n      const { waitIdlePeriod } = await import('maverick.js/std');\n      waitIdlePeriod(this._callback);\n    } else if (load === \"visible\") {\n      const observer = new IntersectionObserver((entries) => {\n        if (entries[0].isIntersecting) {\n          observer.disconnect();\n          this._callback();\n        }\n      });\n      observer.observe(el);\n      return observer.disconnect.bind(observer);\n    }\n  }\n}\n\nclass MediaPlayerDelegate {\n  constructor(_handle, _media) {\n    this._handle = _handle;\n    this._media = _media;\n  }\n  _dispatch(type, ...init) {\n    this._handle(new DOMEvent(type, init?.[0]));\n  }\n  async _ready(info, trigger) {\n    const { $store, logger } = this._media;\n    if (peek($store.canPlay))\n      return;\n    this._dispatch(\"can-play\", { detail: info, trigger });\n    tick();\n    {\n      logger?.infoGroup(\"-~-~-~-~-~-~-~-~- \\u2705 MEDIA READY -~-~-~-~-~-~-~-~-\").labelledLog(\"Media Store\", { ...$store }).labelledLog(\"Trigger Event\", trigger).dispatch();\n    }\n    if ($store.canPlay() && $store.autoplay() && !$store.started()) {\n      await this._attemptAutoplay();\n    }\n  }\n  async _attemptAutoplay() {\n    const { player, $store } = this._media;\n    $store.autoplaying.set(true);\n    try {\n      await player.play();\n      this._dispatch(\"autoplay\", { detail: { muted: $store.muted() } });\n    } catch (error) {\n      this._dispatch(\"autoplay-fail\", {\n        detail: {\n          muted: $store.muted(),\n          error\n        }\n      });\n    } finally {\n      $store.autoplaying.set(false);\n    }\n  }\n}\n\nclass Queue {\n  _queue = /* @__PURE__ */ new Map();\n  /**\n   * Queue the given `item` under the given `key` to be processed at a later time by calling\n   * `serve(key)`.\n   */\n  _enqueue(key, item) {\n    if (!this._queue.has(key))\n      this._queue.set(key, /* @__PURE__ */ new Set());\n    this._queue.get(key).add(item);\n  }\n  /**\n   * Process all items in queue for the given `key`.\n   */\n  _serve(key, callback) {\n    const items = this._queue.get(key);\n    if (items)\n      for (const item of items)\n        callback(item);\n    this._queue.delete(key);\n  }\n  /**\n   * Removes all queued items under the given `key`.\n   */\n  _delete(key) {\n    this._queue.delete(key);\n  }\n  /**\n   * The number of items currently queued under the given `key`.\n   */\n  _size(key) {\n    return this._queue.get(key)?.size ?? 0;\n  }\n  /**\n   * Clear all items in the queue.\n   */\n  _reset() {\n    this._queue.clear();\n  }\n}\n\nfunction coerceToError(error) {\n  return error instanceof Error ? error : Error(JSON.stringify(error));\n}\n\nclass MediaUserController extends ComponentController {\n  _idleTimer = -2;\n  _delay = 2e3;\n  _pausedTracking = false;\n  _focusedItem = null;\n  /**\n   * Whether the media user is currently idle.\n   */\n  get idling() {\n    return this.$store.userIdle();\n  }\n  /**\n   * The amount of delay in milliseconds while media playback is progressing without user\n   * activity to indicate an idle state.\n   *\n   * @defaultValue 2000\n   */\n  get idleDelay() {\n    return this._delay;\n  }\n  set idleDelay(newDelay) {\n    this._delay = newDelay;\n  }\n  /**\n   * Change the user idle state.\n   */\n  idle(idle, delay = this._delay, trigger) {\n    this._clearIdleTimer();\n    if (!this._pausedTracking)\n      this._requestIdleChange(idle, delay, trigger);\n  }\n  /**\n   * Whether all idle tracking should be paused until resumed again.\n   */\n  pauseIdleTracking(paused, trigger) {\n    this._pausedTracking = paused;\n    if (paused) {\n      this._clearIdleTimer();\n      this._requestIdleChange(false, 0, trigger);\n    }\n  }\n  onConnect() {\n    effect(this._watchPaused.bind(this));\n    listenEvent(this.el, \"play\", this._onMediaPlay.bind(this));\n    listenEvent(this.el, \"pause\", this._onMediaPause.bind(this));\n  }\n  _watchPaused() {\n    if (this.$store.paused())\n      return;\n    const onStopIdle = this._onStopIdle.bind(this);\n    for (const eventType of [\"pointerup\", \"keydown\"]) {\n      listenEvent(this.el, eventType, onStopIdle);\n    }\n    effect(() => {\n      if (!this.$store.touchPointer())\n        listenEvent(this.el, \"pointermove\", onStopIdle);\n    });\n  }\n  _onMediaPlay(event) {\n    this.idle(true, this._delay, event);\n  }\n  _onMediaPause(event) {\n    this.idle(false, 0, event);\n  }\n  _clearIdleTimer() {\n    window.clearTimeout(this._idleTimer);\n    this._idleTimer = -1;\n  }\n  _onStopIdle(event) {\n    if (event.MEDIA_GESTURE)\n      return;\n    if (isKeyboardEvent(event)) {\n      if (event.key === \"Escape\") {\n        this.el?.focus();\n        this._focusedItem = null;\n      } else if (this._focusedItem) {\n        event.preventDefault();\n        requestAnimationFrame(() => {\n          this._focusedItem?.focus();\n          this._focusedItem = null;\n        });\n      }\n    }\n    this.idle(false, 0, event);\n    this.idle(true, this._delay, event);\n  }\n  _requestIdleChange(idle, delay, trigger) {\n    if (delay === 0) {\n      this._onIdleChange(idle, trigger);\n      return;\n    }\n    this._idleTimer = window.setTimeout(() => {\n      this._onIdleChange(idle && !this._pausedTracking, trigger);\n    }, delay);\n  }\n  _onIdleChange(idle, trigger) {\n    if (this.$store.userIdle() === idle)\n      return;\n    this.$store.userIdle.set(idle);\n    if (idle && document.activeElement && this.el?.contains(document.activeElement)) {\n      this._focusedItem = document.activeElement;\n      requestAnimationFrame(() => this.el?.focus());\n    }\n    this.dispatch(\"user-idle-change\", {\n      detail: idle,\n      trigger\n    });\n  }\n}\n\nclass MediaRequestContext {\n  _seeking = false;\n  _looping = false;\n  _replaying = false;\n  _queue = new Queue();\n}\nclass MediaRequestManager extends ComponentController {\n  constructor(instance, _stateMgr, _request, _media) {\n    super(instance);\n    this._stateMgr = _stateMgr;\n    this._request = _request;\n    this._media = _media;\n    this._store = _media.$store;\n    this._provider = _media.$provider;\n    this._user = new MediaUserController(instance);\n    this._fullscreen = new FullscreenController(instance);\n    this._orientation = new ScreenOrientationController(instance);\n  }\n  _user;\n  _fullscreen;\n  _orientation;\n  _store;\n  _provider;\n  onConnect() {\n    effect(this._onIdleDelayChange.bind(this));\n    effect(this._onFullscreenSupportChange.bind(this));\n    effect(this._onPiPSupportChange.bind(this));\n    const names = Object.getOwnPropertyNames(Object.getPrototypeOf(this)), handle = this._handleRequest.bind(this);\n    for (const name of names) {\n      if (name.startsWith(\"media-\")) {\n        this.listen(name, handle);\n      }\n    }\n    this.listen(\"fullscreen-change\", this._onFullscreenChange.bind(this));\n  }\n  _handleRequest(event) {\n    event.stopPropagation();\n    {\n      this._media.logger?.infoGroup(`\\u{1F4EC} received \\`${event.type}\\``).labelledLog(\"Request\", event).dispatch();\n    }\n    if (peek(this._provider))\n      this[event.type]?.(event);\n  }\n  async _play() {\n    const { canPlay, paused, ended, autoplaying, seekableStart } = this._store;\n    if (!peek(paused))\n      return;\n    try {\n      const provider = peek(this._provider);\n      throwIfNotReadyForPlayback(provider, peek(canPlay));\n      if (peek(ended)) {\n        provider.currentTime = seekableStart() + 0.1;\n      }\n      return provider.play();\n    } catch (error) {\n      const errorEvent = this.createEvent(\"play-fail\", { detail: coerceToError(error) });\n      errorEvent.autoplay = autoplaying();\n      this._stateMgr._handle(errorEvent);\n      throw error;\n    }\n  }\n  async _pause() {\n    const { canPlay, paused } = this._store;\n    if (peek(paused))\n      return;\n    const provider = peek(this._provider);\n    throwIfNotReadyForPlayback(provider, peek(canPlay));\n    return provider.pause();\n  }\n  _seekToLiveEdge() {\n    const { canPlay, live, liveEdge, canSeek, liveSyncPosition, seekableEnd, userBehindLiveEdge } = this._store;\n    userBehindLiveEdge.set(false);\n    if (peek(() => !live() || liveEdge() || !canSeek()))\n      return;\n    const provider = peek(this._provider);\n    throwIfNotReadyForPlayback(provider, peek(canPlay));\n    provider.currentTime = liveSyncPosition() ?? seekableEnd() - 2;\n  }\n  _wasPIPActive = false;\n  async _enterFullscreen(target = \"prefer-media\") {\n    const provider = peek(this._provider);\n    const adapter = target === \"prefer-media\" && this._fullscreen.supported || target === \"media\" ? this._fullscreen : provider?.fullscreen;\n    throwIfFullscreenNotSupported(target, adapter);\n    if (adapter.active)\n      return;\n    if (peek(this._store.pictureInPicture)) {\n      this._wasPIPActive = true;\n      await this._exitPictureInPicture();\n    }\n    return adapter.enter();\n  }\n  async _exitFullscreen(target = \"prefer-media\") {\n    const provider = peek(this._provider);\n    const adapter = target === \"prefer-media\" && this._fullscreen.supported || target === \"media\" ? this._fullscreen : provider?.fullscreen;\n    throwIfFullscreenNotSupported(target, adapter);\n    if (!adapter.active)\n      return;\n    if (this._orientation.locked)\n      await this._orientation.unlock();\n    try {\n      const result = await adapter.exit();\n      if (this._wasPIPActive && peek(this._store.canPictureInPicture)) {\n        await this._enterPictureInPicture();\n      }\n      return result;\n    } finally {\n      this._wasPIPActive = false;\n    }\n  }\n  async _enterPictureInPicture() {\n    this._throwIfPIPNotSupported();\n    if (this._store.pictureInPicture())\n      return;\n    return await this._provider().pictureInPicture.enter();\n  }\n  async _exitPictureInPicture() {\n    this._throwIfPIPNotSupported();\n    if (!this._store.pictureInPicture())\n      return;\n    return await this._provider().pictureInPicture.exit();\n  }\n  _throwIfPIPNotSupported() {\n    if (this._store.canPictureInPicture())\n      return;\n    throw Error(\n      `[vidstack] picture-in-picture is not currently available` \n    );\n  }\n  _onIdleDelayChange() {\n    this._user.idleDelay = this.$props.userIdleDelay();\n  }\n  _onFullscreenSupportChange() {\n    const { canLoad, canFullscreen } = this._store, supported = this._fullscreen.supported || this._provider()?.fullscreen?.supported || false;\n    if (canLoad() && peek(canFullscreen) === supported)\n      return;\n    canFullscreen.set(supported);\n  }\n  _onPiPSupportChange() {\n    const { canLoad, canPictureInPicture } = this._store, supported = this._provider()?.pictureInPicture?.supported || false;\n    if (canLoad() && peek(canPictureInPicture) === supported)\n      return;\n    canPictureInPicture.set(supported);\n  }\n  [\"media-audio-track-change-request\"](event) {\n    if (this._media.audioTracks.readonly) {\n      {\n        this._media.logger?.warnGroup(`[vidstack] attempted to change audio track but it is currently read-only`).labelledLog(\"Event\", event).dispatch();\n      }\n      return;\n    }\n    const index = event.detail, track = this._media.audioTracks[index];\n    if (track) {\n      this._request._queue._enqueue(\"audioTrack\", event);\n      track.selected = true;\n    } else {\n      this._media.logger?.warnGroup(\"[vidstack] failed audio track change request (invalid index)\").labelledLog(\"Audio Tracks\", this._media.audioTracks.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n  async [\"media-enter-fullscreen-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"fullscreen\", event);\n      await this._enterFullscreen(event.detail);\n    } catch (error) {\n      this._onFullscreenError(error);\n    }\n  }\n  async [\"media-exit-fullscreen-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"fullscreen\", event);\n      await this._exitFullscreen(event.detail);\n    } catch (error) {\n      this._onFullscreenError(error);\n    }\n  }\n  async _onFullscreenChange(event) {\n    if (!event.detail)\n      return;\n    try {\n      const lockType = peek(this.$props.fullscreenOrientation);\n      if (this._orientation.supported && !isUndefined(lockType)) {\n        await this._orientation.lock(lockType);\n      }\n    } catch (e) {\n    }\n  }\n  _onFullscreenError(error) {\n    this._stateMgr._handle(\n      this.createEvent(\"fullscreen-error\", {\n        detail: coerceToError(error)\n      })\n    );\n  }\n  async [\"media-enter-pip-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"pip\", event);\n      await this._enterPictureInPicture();\n    } catch (error) {\n      this._onPictureInPictureError(error);\n    }\n  }\n  async [\"media-exit-pip-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"pip\", event);\n      await this._exitPictureInPicture();\n    } catch (error) {\n      this._onPictureInPictureError(error);\n    }\n  }\n  _onPictureInPictureError(error) {\n    this._stateMgr._handle(\n      this.createEvent(\"picture-in-picture-error\", {\n        detail: coerceToError(error)\n      })\n    );\n  }\n  [\"media-live-edge-request\"](event) {\n    const { live, liveEdge, canSeek } = this._store;\n    if (!live() || liveEdge() || !canSeek())\n      return;\n    this._request._queue._enqueue(\"seeked\", event);\n    try {\n      this._seekToLiveEdge();\n    } catch (e) {\n      this._media.logger?.error(\"seek to live edge fail\", e);\n    }\n  }\n  [\"media-loop-request\"]() {\n    window.requestAnimationFrame(async () => {\n      try {\n        this._request._looping = true;\n        this._request._replaying = true;\n        await this._play();\n      } catch (e) {\n        this._request._looping = false;\n        this._request._replaying = false;\n      }\n    });\n  }\n  async [\"media-pause-request\"](event) {\n    if (this._store.paused())\n      return;\n    try {\n      this._request._queue._enqueue(\"pause\", event);\n      await this._provider().pause();\n    } catch (e) {\n      this._request._queue._delete(\"pause\");\n      this._media.logger?.error(\"pause-fail\", e);\n    }\n  }\n  async [\"media-play-request\"](event) {\n    if (!this._store.paused())\n      return;\n    try {\n      this._request._queue._enqueue(\"play\", event);\n      await this._provider().play();\n    } catch (e) {\n      const errorEvent = this.createEvent(\"play-fail\", { detail: coerceToError(e) });\n      this._stateMgr._handle(errorEvent);\n    }\n  }\n  [\"media-rate-change-request\"](event) {\n    if (this._store.playbackRate() === event.detail)\n      return;\n    this._request._queue._enqueue(\"rate\", event);\n    this._provider().playbackRate = event.detail;\n  }\n  [\"media-quality-change-request\"](event) {\n    if (this._media.qualities.readonly) {\n      {\n        this._media.logger?.warnGroup(`[vidstack] attempted to change video quality but it is currently read-only`).labelledLog(\"Event\", event).dispatch();\n      }\n      return;\n    }\n    this._request._queue._enqueue(\"quality\", event);\n    const index = event.detail;\n    if (index < 0) {\n      this._media.qualities.autoSelect(event);\n    } else {\n      const quality = this._media.qualities[index];\n      if (quality) {\n        quality.selected = true;\n      } else {\n        this._media.logger?.warnGroup(\"[vidstack] failed quality change request (invalid index)\").labelledLog(\"Qualities\", this._media.qualities.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n      }\n    }\n  }\n  [\"media-resume-user-idle-request\"](event) {\n    this._request._queue._enqueue(\"userIdle\", event);\n    this._user.pauseIdleTracking(false, event);\n  }\n  [\"media-pause-user-idle-request\"](event) {\n    this._request._queue._enqueue(\"userIdle\", event);\n    this._user.pauseIdleTracking(true, event);\n  }\n  [\"media-seek-request\"](event) {\n    const { seekableStart, seekableEnd, ended, canSeek, live, userBehindLiveEdge } = this._store;\n    if (ended())\n      this._request._replaying = true;\n    this._request._seeking = false;\n    this._request._queue._delete(\"seeking\");\n    const boundTime = Math.min(Math.max(seekableStart() + 0.1, event.detail), seekableEnd() - 0.1);\n    if (!Number.isFinite(boundTime) || !canSeek())\n      return;\n    this._request._queue._enqueue(\"seeked\", event);\n    this._provider().currentTime = boundTime;\n    if (live() && event.isOriginTrusted && Math.abs(seekableEnd() - boundTime) >= 2) {\n      userBehindLiveEdge.set(true);\n    }\n  }\n  [\"media-seeking-request\"](event) {\n    this._request._queue._enqueue(\"seeking\", event);\n    this._store.seeking.set(true);\n    this._request._seeking = true;\n  }\n  [\"media-start-loading\"](event) {\n    if (this._store.canLoad())\n      return;\n    this._request._queue._enqueue(\"load\", event);\n    this._stateMgr._handle(this.createEvent(\"can-load\"));\n  }\n  [\"media-text-track-change-request\"](event) {\n    const { index, mode } = event.detail, track = this._media.textTracks[index];\n    if (track) {\n      this._request._queue._enqueue(\"textTrack\", event);\n      track.setMode(mode, event);\n    } else {\n      this._media.logger?.warnGroup(\"[vidstack] failed text track change request (invalid index)\").labelledLog(\"Text Tracks\", this._media.textTracks.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n  [\"media-mute-request\"](event) {\n    if (this._store.muted())\n      return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._provider().muted = true;\n  }\n  [\"media-unmute-request\"](event) {\n    const { muted, volume } = this._store;\n    if (!muted())\n      return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._media.$provider().muted = false;\n    if (volume() === 0) {\n      this._request._queue._enqueue(\"volume\", event);\n      this._provider().volume = 0.25;\n    }\n  }\n  [\"media-volume-change-request\"](event) {\n    const { muted, volume } = this._store;\n    const newVolume = event.detail;\n    if (volume() === newVolume)\n      return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._provider().volume = newVolume;\n    if (newVolume > 0 && muted()) {\n      this._request._queue._enqueue(\"volume\", event);\n      this._provider().muted = false;\n    }\n  }\n}\nfunction throwIfNotReadyForPlayback(provider, canPlay) {\n  if (provider && canPlay)\n    return;\n  throw Error(\n    `[vidstack] media is not ready - wait for \\`can-play\\` event.` \n  );\n}\nfunction throwIfFullscreenNotSupported(target, fullscreen) {\n  if (fullscreen?.supported)\n    return;\n  throw Error(\n    `[vidstack] fullscreen is not currently available on target \\`${target}\\`` \n  );\n}\n\nvar functionDebounce = debounce;\n\nfunction debounce(fn, wait, callFirst) {\n  var timeout = null;\n  var debouncedFn = null;\n\n  var clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n\n      debouncedFn = null;\n      timeout = null;\n    }\n  };\n\n  var flush = function() {\n    var call = debouncedFn;\n    clear();\n\n    if (call) {\n      call();\n    }\n  };\n\n  var debounceWrapper = function() {\n    if (!wait) {\n      return fn.apply(this, arguments);\n    }\n\n    var context = this;\n    var args = arguments;\n    var callNow = callFirst && !timeout;\n    clear();\n\n    debouncedFn = function() {\n      fn.apply(context, args);\n    };\n\n    timeout = setTimeout(function() {\n      timeout = null;\n\n      if (!callNow) {\n        var call = debouncedFn;\n        debouncedFn = null;\n\n        return call();\n      }\n    }, wait);\n\n    if (callNow) {\n      return debouncedFn();\n    }\n  };\n\n  debounceWrapper.cancel = clear;\n  debounceWrapper.flush = flush;\n\n  return debounceWrapper;\n}\n\nvar functionThrottle = throttle;\n\nfunction throttle(fn, interval, options) {\n  var timeoutId = null;\n  var throttledFn = null;\n  var leading = (options && options.leading);\n  var trailing = (options && options.trailing);\n\n  if (leading == null) {\n    leading = true; // default\n  }\n\n  if (trailing == null) {\n    trailing = !leading; //default\n  }\n\n  if (leading == true) {\n    trailing = false; // forced because there should be invocation per call\n  }\n\n  var cancel = function() {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n      timeoutId = null;\n    }\n  };\n\n  var flush = function() {\n    var call = throttledFn;\n    cancel();\n\n    if (call) {\n      call();\n    }\n  };\n\n  var throttleWrapper = function() {\n    var callNow = leading && !timeoutId;\n    var context = this;\n    var args = arguments;\n\n    throttledFn = function() {\n      return fn.apply(context, args);\n    };\n\n    if (!timeoutId) {\n      timeoutId = setTimeout(function() {\n        timeoutId = null;\n\n        if (trailing) {\n          return throttledFn();\n        }\n      }, interval);\n    }\n\n    if (callNow) {\n      callNow = false;\n      return throttledFn();\n    }\n  };\n\n  throttleWrapper.cancel = cancel;\n  throttleWrapper.flush = flush;\n\n  return throttleWrapper;\n}\n\nconst ATTACH_VIDEO = Symbol(\"ATTACH_VIDEO\" );\nconst TEXT_TRACK_CROSSORIGIN = Symbol(\"TEXT_TRACK_CROSSORIGIN\" );\nconst TEXT_TRACK_READY_STATE = Symbol(\"TEXT_TRACK_READY_STATE\" );\nconst TEXT_TRACK_UPDATE_ACTIVE_CUES = Symbol(\"TEXT_TRACK_UPDATE_ACTIVE_CUES\" );\nconst TEXT_TRACK_CAN_LOAD = Symbol(\"TEXT_TRACK_CAN_LOAD\" );\nconst TEXT_TRACK_ON_MODE_CHANGE = Symbol(\"TEXT_TRACK_ON_MODE_CHANGE\" );\nconst TEXT_TRACK_NATIVE = Symbol(\"TEXT_TRACK_NATIVE\" );\nconst TEXT_TRACK_NATIVE_HLS = Symbol(\"TEXT_TRACK_NATIVE_HLS\" );\n\nconst TRACKED_EVENT = /* @__PURE__ */ new Set([\n  \"autoplay\",\n  \"autoplay-fail\",\n  \"can-load\",\n  \"sources-change\",\n  \"source-change\",\n  \"load-start\",\n  \"abort\",\n  \"error\",\n  \"loaded-metadata\",\n  \"loaded-data\",\n  \"can-play\",\n  \"play\",\n  \"play-fail\",\n  \"pause\",\n  \"playing\",\n  \"seeking\",\n  \"seeked\",\n  \"waiting\"\n]);\n\nclass MediaStateManager extends ComponentController {\n  constructor(instance, _request, _media) {\n    super(instance);\n    this._request = _request;\n    this._media = _media;\n    this._store = _media.$store;\n  }\n  _store;\n  _trackedEvents = /* @__PURE__ */ new Map();\n  _skipInitialSrcChange = true;\n  _firingWaiting = false;\n  _waitingTrigger;\n  onAttach(el) {\n    el.setAttribute(\"aria-busy\", \"true\");\n  }\n  onConnect(el) {\n    this._addTextTrackListeners();\n    this._addQualityListeners();\n    this._addAudioTrackListeners();\n    this.listen(\"fullscreen-change\", this[\"fullscreen-change\"].bind(this));\n    this.listen(\"fullscreen-error\", this[\"fullscreen-error\"].bind(this));\n  }\n  _handle(event) {\n    const type = event.type;\n    this[event.type]?.(event);\n    {\n      if (TRACKED_EVENT.has(type))\n        this._trackedEvents.set(type, event);\n      this.el?.dispatchEvent(event);\n    }\n  }\n  _resetTracking() {\n    this._stopWaiting();\n    this._request._replaying = false;\n    this._request._looping = false;\n    this._firingWaiting = false;\n    this._waitingTrigger = void 0;\n    this._trackedEvents.clear();\n  }\n  _satisfyRequest(request, event) {\n    this._request._queue._serve(request, (requestEvent) => {\n      event.request = requestEvent;\n      appendTriggerEvent(event, requestEvent);\n    });\n  }\n  _addTextTrackListeners() {\n    this._onTextTracksChange();\n    this._onTextTrackModeChange();\n    const textTracks = this._media.textTracks;\n    listenEvent(textTracks, \"add\", this._onTextTracksChange.bind(this));\n    listenEvent(textTracks, \"remove\", this._onTextTracksChange.bind(this));\n    listenEvent(textTracks, \"mode-change\", this._onTextTrackModeChange.bind(this));\n  }\n  _addQualityListeners() {\n    const qualities = this._media.qualities;\n    listenEvent(qualities, \"add\", this._onQualitiesChange.bind(this));\n    listenEvent(qualities, \"remove\", this._onQualitiesChange.bind(this));\n    listenEvent(qualities, \"change\", this._onQualityChange.bind(this));\n    listenEvent(qualities, \"auto-change\", this._onAutoQualityChange.bind(this));\n    listenEvent(qualities, \"readonly-change\", this._onCanSetQualityChange.bind(this));\n  }\n  _addAudioTrackListeners() {\n    const audioTracks = this._media.audioTracks;\n    listenEvent(audioTracks, \"add\", this._onAudioTracksChange.bind(this));\n    listenEvent(audioTracks, \"remove\", this._onAudioTracksChange.bind(this));\n    listenEvent(audioTracks, \"change\", this._onAudioTrackChange.bind(this));\n  }\n  _onTextTracksChange(event) {\n    const { textTracks } = this._store;\n    textTracks.set(this._media.textTracks.toArray());\n    this.dispatch(\"text-tracks-change\", {\n      detail: textTracks(),\n      trigger: event\n    });\n  }\n  _onTextTrackModeChange(event) {\n    if (event)\n      this._satisfyRequest(\"textTrack\", event);\n    const current = this._media.textTracks.selected, { textTrack } = this._store;\n    if (textTrack() !== current) {\n      textTrack.set(current);\n      this.dispatch(\"text-track-change\", {\n        detail: current,\n        trigger: event\n      });\n    }\n  }\n  _onAudioTracksChange(event) {\n    const { audioTracks } = this._store;\n    audioTracks.set(this._media.audioTracks.toArray());\n    this.dispatch(\"audio-tracks-change\", {\n      detail: audioTracks(),\n      trigger: event\n    });\n  }\n  _onAudioTrackChange(event) {\n    const { audioTrack } = this._store;\n    audioTrack.set(this._media.audioTracks.selected);\n    this._satisfyRequest(\"audioTrack\", event);\n    this.dispatch(\"audio-track-change\", {\n      detail: audioTrack(),\n      trigger: event\n    });\n  }\n  _onQualitiesChange(event) {\n    const { qualities } = this._store;\n    qualities.set(this._media.qualities.toArray());\n    this.dispatch(\"qualities-change\", {\n      detail: qualities(),\n      trigger: event\n    });\n  }\n  _onQualityChange(event) {\n    const { quality } = this._store;\n    quality.set(this._media.qualities.selected);\n    this._satisfyRequest(\"quality\", event);\n    this.dispatch(\"quality-change\", {\n      detail: quality(),\n      trigger: event\n    });\n  }\n  _onAutoQualityChange() {\n    this._store.autoQuality.set(this._media.qualities.auto);\n  }\n  _onCanSetQualityChange() {\n    this._store.canSetQuality.set(!this._media.qualities.readonly);\n  }\n  [\"provider-change\"](event) {\n    this._media.$provider.set(event.detail);\n  }\n  [\"autoplay\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n    this._store.autoplayError.set(void 0);\n  }\n  [\"autoplay-fail\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play-fail\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n    this._store.autoplayError.set(event.detail);\n    this._resetTracking();\n  }\n  [\"can-load\"](event) {\n    this._store.canLoad.set(true);\n    this._trackedEvents.set(\"can-load\", event);\n    this._satisfyRequest(\"load\", event);\n    this._media.textTracks[TEXT_TRACK_CAN_LOAD]();\n  }\n  [\"media-type-change\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    const viewType = this._store.viewType();\n    this._store.mediaType.set(event.detail);\n    if (viewType !== this._store.viewType()) {\n      setTimeout(\n        () => this.dispatch(\"view-type-change\", {\n          detail: this._store.viewType(),\n          trigger: event\n        }),\n        0\n      );\n    }\n  }\n  [\"stream-type-change\"](event) {\n    const { streamType, inferredStreamType } = this._store;\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    inferredStreamType.set(event.detail);\n    event.detail = streamType();\n  }\n  [\"rate-change\"](event) {\n    this._store.playbackRate.set(event.detail);\n    this._satisfyRequest(\"rate\", event);\n  }\n  [\"sources-change\"](event) {\n    this._store.sources.set(event.detail);\n  }\n  [\"source-change\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"sources-change\"));\n    this._store.source.set(event.detail);\n    this.el?.setAttribute(\"aria-busy\", \"true\");\n    {\n      this._media.logger?.infoGroup(\"\\u{1F4FC} Media source change\").labelledLog(\"Source\", event.detail).dispatch();\n    }\n    if (this._skipInitialSrcChange) {\n      this._skipInitialSrcChange = false;\n      return;\n    }\n    this._media.audioTracks[LIST_RESET](event);\n    this._media.qualities[LIST_RESET](event);\n    this._resetTracking();\n    softResetMediaStore(this._media.$store);\n    this._trackedEvents.set(event.type, event);\n  }\n  [\"abort\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-load\"));\n  }\n  [\"load-start\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n  }\n  [\"error\"](event) {\n    this._store.error.set(event.detail);\n    appendTriggerEvent(event, this._trackedEvents.get(\"abort\"));\n  }\n  [\"loaded-metadata\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"load-start\"));\n  }\n  [\"loaded-data\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"load-start\"));\n  }\n  [\"can-play\"](event) {\n    if (event.trigger?.type !== \"loadedmetadata\") {\n      appendTriggerEvent(event, this._trackedEvents.get(\"loaded-metadata\"));\n    }\n    this._onCanPlayDetail(event.detail);\n    this.el?.setAttribute(\"aria-busy\", \"false\");\n  }\n  [\"can-play-through\"](event) {\n    this._onCanPlayDetail(event.detail);\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n  }\n  _onCanPlayDetail(detail) {\n    const { seekable, seekableEnd, buffered, duration, canPlay } = this._store;\n    seekable.set(detail.seekable);\n    buffered.set(detail.buffered);\n    duration.set(seekableEnd);\n    canPlay.set(true);\n  }\n  [\"duration-change\"](event) {\n    const { live, duration } = this._store, time = event.detail;\n    if (!live())\n      duration.set(!Number.isNaN(time) ? time : 0);\n  }\n  [\"progress\"](event) {\n    const { buffered, seekable, live, duration, seekableEnd } = this._store, detail = event.detail;\n    buffered.set(detail.buffered);\n    seekable.set(detail.seekable);\n    if (live()) {\n      duration.set(seekableEnd);\n      this.dispatch(\"duration-change\", {\n        detail: seekableEnd(),\n        trigger: event\n      });\n    }\n  }\n  [\"play\"](event) {\n    const { paused, autoplayError, ended, autoplaying } = this._store;\n    event.autoplay = autoplaying();\n    if (this._request._looping || !paused()) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    appendTriggerEvent(event, this._trackedEvents.get(\"waiting\"));\n    this._satisfyRequest(\"play\", event);\n    paused.set(false);\n    autoplayError.set(void 0);\n    if (ended() || this._request._replaying) {\n      this._request._replaying = false;\n      ended.set(false);\n      this._handle(this.createEvent(\"replay\", { trigger: event }));\n    }\n  }\n  [\"play-fail\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play\"));\n    this._satisfyRequest(\"play\", event);\n    const { paused, playing } = this._store;\n    paused.set(true);\n    playing.set(false);\n    this._resetTracking();\n  }\n  [\"playing\"](event) {\n    const playEvent = this._trackedEvents.get(\"play\");\n    if (playEvent) {\n      appendTriggerEvent(event, this._trackedEvents.get(\"waiting\"));\n      appendTriggerEvent(event, playEvent);\n    } else {\n      appendTriggerEvent(event, this._trackedEvents.get(\"seeked\"));\n    }\n    setTimeout(() => this._resetTracking(), 0);\n    const { paused, playing, seeking, ended } = this._store;\n    paused.set(false);\n    playing.set(true);\n    seeking.set(false);\n    ended.set(false);\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      this._request._looping = false;\n      return;\n    }\n    this[\"started\"](event);\n  }\n  [\"started\"](event) {\n    const { started, live, liveSyncPosition, seekableEnd } = this._store;\n    if (!started()) {\n      if (live()) {\n        const end = liveSyncPosition() ?? seekableEnd() - 2;\n        if (Number.isFinite(end))\n          this._media.$provider().currentTime = end;\n      }\n      started.set(true);\n      this._handle(this.createEvent(\"started\", { trigger: event }));\n    }\n  }\n  [\"pause\"](event) {\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    appendTriggerEvent(event, this._trackedEvents.get(\"seeked\"));\n    this._satisfyRequest(\"pause\", event);\n    const { paused, playing, seeking } = this._store;\n    paused.set(true);\n    playing.set(false);\n    seeking.set(false);\n    this._resetTracking();\n  }\n  [\"time-update\"](event) {\n    const { currentTime, played, waiting } = this._store, detail = event.detail;\n    currentTime.set(detail.currentTime);\n    played.set(detail.played);\n    waiting.set(false);\n    for (const track of this._media.textTracks) {\n      track[TEXT_TRACK_UPDATE_ACTIVE_CUES](detail.currentTime, event);\n    }\n  }\n  [\"volume-change\"](event) {\n    const { volume, muted } = this._store, detail = event.detail;\n    volume.set(detail.volume);\n    muted.set(detail.muted || detail.volume === 0);\n    this._satisfyRequest(\"volume\", event);\n  }\n  [\"seeking\"] = functionThrottle(\n    (event) => {\n      const { seeking, currentTime, paused } = this._store;\n      seeking.set(true);\n      currentTime.set(event.detail);\n      this._satisfyRequest(\"seeking\", event);\n      if (paused()) {\n        this._waitingTrigger = event;\n        this._fireWaiting();\n      }\n    },\n    150,\n    { leading: true }\n  );\n  [\"seeked\"](event) {\n    const { seeking, currentTime, paused, duration, ended } = this._store;\n    if (this._request._seeking) {\n      seeking.set(true);\n      event.stopImmediatePropagation();\n    } else if (seeking()) {\n      const waitingEvent = this._trackedEvents.get(\"waiting\");\n      appendTriggerEvent(event, waitingEvent);\n      if (waitingEvent?.trigger?.type !== \"seeking\") {\n        appendTriggerEvent(event, this._trackedEvents.get(\"seeking\"));\n      }\n      if (paused())\n        this._stopWaiting();\n      seeking.set(false);\n      if (event.detail !== duration())\n        ended.set(false);\n      currentTime.set(event.detail);\n      this._satisfyRequest(\"seeked\", event);\n      const origin = event.originEvent;\n      if (origin && origin.isTrusted && !/seek/.test(origin.type)) {\n        this[\"started\"](event);\n      }\n    }\n  }\n  [\"waiting\"](event) {\n    if (this._firingWaiting || this._request._seeking)\n      return;\n    event.stopImmediatePropagation();\n    this._waitingTrigger = event;\n    this._fireWaiting();\n  }\n  _fireWaiting = functionDebounce(() => {\n    if (!this._waitingTrigger)\n      return;\n    this._firingWaiting = true;\n    const { waiting, playing } = this._store;\n    waiting.set(true);\n    playing.set(false);\n    const event = this.createEvent(\"waiting\", { trigger: this._waitingTrigger });\n    this._trackedEvents.set(\"waiting\", event);\n    this.el.dispatchEvent(event);\n    this._waitingTrigger = void 0;\n    this._firingWaiting = false;\n  }, 300);\n  [\"ended\"](event) {\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    const { paused, playing, seeking, ended } = this._store;\n    paused.set(true);\n    playing.set(false);\n    seeking.set(false);\n    ended.set(true);\n    this._resetTracking();\n  }\n  _stopWaiting() {\n    this._fireWaiting.cancel();\n    this._store.waiting.set(false);\n  }\n  [\"fullscreen-change\"](event) {\n    this._store.fullscreen.set(event.detail);\n    this._satisfyRequest(\"fullscreen\", event);\n  }\n  [\"fullscreen-error\"](event) {\n    this._satisfyRequest(\"fullscreen\", event);\n  }\n  [\"picture-in-picture-change\"](event) {\n    this._store.pictureInPicture.set(event.detail);\n    this._satisfyRequest(\"pip\", event);\n  }\n  [\"picture-in-picture-error\"](event) {\n    this._satisfyRequest(\"pip\", event);\n  }\n}\n\nclass MediaStoreSync extends ComponentController {\n  onAttach(el) {\n    effect(this._onLogLevelChange.bind(this));\n    effect(this._onAutoplayChange.bind(this));\n    effect(this._onPosterChange.bind(this));\n    effect(this._onLoopChange.bind(this));\n    effect(this._onControlsChange.bind(this));\n    effect(this._onCrossOriginChange.bind(this));\n    effect(this._onPlaysinlineChange.bind(this));\n    effect(this._onLiveToleranceChange.bind(this));\n    effect(this._onLiveChange.bind(this));\n    effect(this._onLiveEdgeChange.bind(this));\n    effect(this._onThumbnailsChange.bind(this));\n  }\n  _onLogLevelChange() {\n    this.$store.logLevel.set(this.$props.logLevel());\n  }\n  _onAutoplayChange() {\n    const autoplay = this.$props.autoplay();\n    this.$store.autoplay.set(autoplay);\n    this.dispatch(\"autoplay-change\", { detail: autoplay });\n  }\n  _onLoopChange() {\n    const loop = this.$props.loop();\n    this.$store.loop.set(loop);\n    this.dispatch(\"loop-change\", { detail: loop });\n  }\n  _onControlsChange() {\n    const controls = this.$props.controls();\n    this.$store.controls.set(controls);\n    this.dispatch(\"controls-change\", { detail: controls });\n  }\n  _onPosterChange() {\n    const poster = this.$props.poster();\n    this.$store.poster.set(poster);\n    this.dispatch(\"poster-change\", { detail: poster });\n  }\n  _onCrossOriginChange() {\n    this.$store.crossorigin.set(this.$props.crossorigin());\n  }\n  _onPlaysinlineChange() {\n    const playsinline = this.$props.playsinline();\n    this.$store.playsinline.set(playsinline);\n    this.dispatch(\"playsinline-change\", { detail: playsinline });\n  }\n  _onLiveChange() {\n    this.dispatch(\"live-change\", { detail: this.$store.live() });\n  }\n  _onLiveToleranceChange() {\n    this.$store.liveEdgeTolerance.set(this.$props.liveEdgeTolerance());\n    this.$store.minLiveDVRWindow.set(this.$props.minLiveDVRWindow());\n  }\n  _onLiveEdgeChange() {\n    this.dispatch(\"live-edge-change\", { detail: this.$store.liveEdge() });\n  }\n  _onThumbnailsChange() {\n    this.$store.thumbnails.set(this.$props.thumbnails());\n  }\n}\n\nfunction preconnect(url, rel = \"preconnect\") {\n  const exists = document.querySelector(`link[href=\"${url}\"]`);\n  if (!isNull(exists))\n    return true;\n  const link = document.createElement(\"link\");\n  link.rel = rel;\n  link.href = url;\n  link.crossOrigin = \"true\";\n  document.head.append(link);\n  return true;\n}\nconst pendingRequests = {};\nfunction loadScript(src) {\n  if (pendingRequests[src])\n    return pendingRequests[src].promise;\n  const promise = deferredPromise(), exists = document.querySelector(`script[src=\"${src}\"]`);\n  if (!isNull(exists)) {\n    promise.resolve();\n    return promise.promise;\n  }\n  const script = document.createElement(\"script\");\n  script.src = src;\n  script.onload = () => {\n    promise.resolve();\n    delete pendingRequests[src];\n  };\n  script.onerror = () => {\n    promise.reject();\n    delete pendingRequests[src];\n  };\n  setTimeout(() => document.head.append(script), 0);\n  return promise.promise;\n}\nfunction getRequestCredentials(crossorigin) {\n  return crossorigin === \"use-credentials\" ? \"include\" : isString(crossorigin) ? \"same-origin\" : void 0;\n}\n\nfunction findActiveCue(time, cues) {\n  for (let i = 0, len = cues.length; i < len; i++) {\n    if (isCueActive(cues[i], time))\n      return cues[i];\n  }\n  return null;\n}\nfunction isCueActive(cue, time) {\n  return time >= cue.startTime && time < cue.endTime;\n}\nfunction onTrackChapterChange(tracks, currentTrack, onChange) {\n  const track = tracks.toArray().find((track2) => track2.kind === \"chapters\" && track2.mode === \"showing\");\n  if (track === currentTrack)\n    return;\n  if (!track) {\n    onChange(null);\n    return;\n  }\n  if (track.readyState == 2) {\n    onChange(track);\n  } else {\n    onChange(null);\n    track.addEventListener(\"load\", () => onChange(track), { once: true });\n  }\n}\n\nclass TextTrack extends EventsTarget {\n  static createId(track) {\n    return `id::${track.type}-${track.kind}-${track.src ?? track.label}`;\n  }\n  src;\n  content;\n  type;\n  encoding;\n  id = \"\";\n  label = \"\";\n  language = \"\";\n  kind;\n  default = false;\n  _canLoad = false;\n  _currentTime = 0;\n  _mode = \"disabled\";\n  _metadata = {};\n  _regions = [];\n  _cues = [];\n  _activeCues = [];\n  /* @internal */\n  [TEXT_TRACK_READY_STATE] = 0;\n  /* @internal */\n  [TEXT_TRACK_CROSSORIGIN];\n  /* @internal */\n  [TEXT_TRACK_ON_MODE_CHANGE] = null;\n  /* @internal */\n  [TEXT_TRACK_NATIVE] = null;\n  get metadata() {\n    return this._metadata;\n  }\n  get regions() {\n    return this._regions;\n  }\n  get cues() {\n    return this._cues;\n  }\n  get activeCues() {\n    return this._activeCues;\n  }\n  /**\n   * - 0: Not Loading\n   * - 1: Loading\n   * - 2: Ready\n   * - 3: Error\n   */\n  get readyState() {\n    return this[TEXT_TRACK_READY_STATE];\n  }\n  get mode() {\n    return this._mode;\n  }\n  set mode(mode) {\n    this.setMode(mode);\n  }\n  constructor(init) {\n    super();\n    for (const prop of Object.keys(init))\n      this[prop] = init[prop];\n    if (!this.type)\n      this.type = \"vtt\";\n    if (init.content) {\n      import('media-captions').then(({ parseText, VTTCue, VTTRegion }) => {\n        if (init.type === \"json\") {\n          this._parseJSON(init.content, VTTCue, VTTRegion);\n        } else {\n          parseText(init.content, { type: init.type }).then(({ cues, regions }) => {\n            this._cues = cues;\n            this._regions = regions;\n            this._readyState();\n          });\n        }\n      });\n    } else if (!init.src)\n      this[TEXT_TRACK_READY_STATE] = 2;\n    if (isTrackCaptionKind(this) && !this.label) {\n      throw Error(`[vidstack]: captions text track created without label: \\`${this.src}\\``);\n    }\n  }\n  addCue(cue, trigger) {\n    let i = 0, length = this._cues.length;\n    for (i = 0; i < length; i++)\n      if (cue.endTime <= this._cues[i].startTime)\n        break;\n    if (i === length)\n      this._cues.push(cue);\n    else\n      this._cues.splice(i, 0, cue);\n    if (trigger?.type !== \"cuechange\") {\n      this[TEXT_TRACK_NATIVE]?.track.addCue(cue);\n    }\n    this.dispatchEvent(new DOMEvent(\"add-cue\", { detail: cue, trigger }));\n    if (isCueActive(cue, this._currentTime)) {\n      this[TEXT_TRACK_UPDATE_ACTIVE_CUES](this._currentTime, trigger);\n    }\n  }\n  removeCue(cue, trigger) {\n    const index = this._cues.indexOf(cue);\n    if (index >= 0) {\n      const isActive = this._activeCues.includes(cue);\n      this._cues.splice(index, 1);\n      this[TEXT_TRACK_NATIVE]?.track.removeCue(cue);\n      this.dispatchEvent(new DOMEvent(\"remove-cue\", { detail: cue, trigger }));\n      if (isActive) {\n        this[TEXT_TRACK_UPDATE_ACTIVE_CUES](this._currentTime, trigger);\n      }\n    }\n  }\n  setMode(mode, trigger) {\n    if (this._mode === mode)\n      return;\n    this._mode = mode;\n    if (mode === \"disabled\") {\n      this._activeCues = [];\n      this._activeCuesChanged();\n    } else if (this.readyState === 2) {\n      this[TEXT_TRACK_UPDATE_ACTIVE_CUES](this._currentTime, trigger);\n    } else {\n      this._load();\n    }\n    this.dispatchEvent(new DOMEvent(\"mode-change\", { detail: this, trigger }));\n    this[TEXT_TRACK_ON_MODE_CHANGE]?.();\n  }\n  /* @internal */\n  [TEXT_TRACK_UPDATE_ACTIVE_CUES](currentTime, trigger) {\n    this._currentTime = currentTime;\n    if (this.mode === \"disabled\" || !this._cues.length)\n      return;\n    const activeCues = [];\n    for (let i = 0, length = this._cues.length; i < length; i++) {\n      const cue = this._cues[i];\n      if (isCueActive(cue, currentTime))\n        activeCues.push(cue);\n    }\n    let changed = activeCues.length !== this._activeCues.length;\n    if (!changed) {\n      for (let i = 0; i < activeCues.length; i++) {\n        if (!this._activeCues.includes(activeCues[i])) {\n          changed = true;\n          break;\n        }\n      }\n    }\n    this._activeCues = activeCues;\n    if (changed)\n      this._activeCuesChanged(trigger);\n  }\n  /* @internal */\n  [TEXT_TRACK_CAN_LOAD]() {\n    this._canLoad = true;\n    if (this._mode !== \"disabled\")\n      this._load();\n  }\n  async _load() {\n    if (!this._canLoad || !this.src || this[TEXT_TRACK_READY_STATE] > 0)\n      return;\n    this[TEXT_TRACK_READY_STATE] = 1;\n    this.dispatchEvent(new DOMEvent(\"load-start\"));\n    try {\n      const { parseResponse, VTTCue, VTTRegion } = await import('media-captions'), crossorigin = this[TEXT_TRACK_CROSSORIGIN]?.();\n      const response = fetch(this.src, {\n        headers: this.type === \"json\" ? { \"Content-Type\": \"application/json\" } : void 0,\n        credentials: getRequestCredentials(crossorigin)\n      });\n      if (this.type === \"json\") {\n        this._parseJSON(await (await response).text(), VTTCue, VTTRegion);\n      } else {\n        const { errors, metadata, regions, cues } = await parseResponse(response, {\n          type: this.type,\n          encoding: this.encoding\n        });\n        if (errors[0]?.code === 0) {\n          throw errors[0];\n        } else {\n          this._metadata = metadata;\n          this._regions = regions;\n          this._cues = cues;\n        }\n      }\n      this._readyState();\n    } catch (error) {\n      this._errorState(error);\n    }\n  }\n  _readyState() {\n    this[TEXT_TRACK_READY_STATE] = 2;\n    if (!this.src || this.type !== \"vtt\") {\n      const nativeTrack = this[TEXT_TRACK_NATIVE]?.track;\n      if (nativeTrack)\n        for (const cue of this._cues)\n          nativeTrack.addCue(cue);\n    }\n    const loadEvent = new DOMEvent(\"load\");\n    this[TEXT_TRACK_UPDATE_ACTIVE_CUES](this._currentTime, loadEvent);\n    this.dispatchEvent(loadEvent);\n  }\n  _errorState(error) {\n    this[TEXT_TRACK_READY_STATE] = 3;\n    this.dispatchEvent(new DOMEvent(\"error\", { detail: error }));\n  }\n  _parseJSON(json, VTTCue, VTTRegion) {\n    try {\n      json = JSON.parse(json);\n      if (json.regions) {\n        this._regions = json.regions.map((json2) => Object.assign(new VTTRegion(), json2));\n      }\n      if (json.cues) {\n        this._cues = json.cues.filter((json2) => isNumber(json2.startTime) && isNumber(json2.endTime)).map((json2) => Object.assign(new VTTCue(0, 0, \"\"), json2));\n      }\n    } catch (error) {\n      {\n        console.error(`[vidstack] failed to parse JSON captions at: \\`${this.src}\\`\n\n`, error);\n      }\n      this._errorState(error);\n    }\n  }\n  _activeCuesChanged(trigger) {\n    this.dispatchEvent(new DOMEvent(\"cue-change\", { trigger }));\n  }\n}\nconst captionRE = /captions|subtitles/;\nfunction isTrackCaptionKind(track) {\n  return captionRE.test(track.kind);\n}\n\nclass MediaRemoteControl {\n  constructor(_logger) {\n    this._logger = _logger;\n  }\n  _target = null;\n  _player = null;\n  _prevTrackIndex = -1;\n  /**\n   * Set the target from which to dispatch media requests events from. The events should bubble\n   * up from this target to the `<media-player>` element.\n   *\n   * @example\n   * ```ts\n   * const button = document.querySelector('button');\n   * remote.setTarget(button);\n   * ```\n   */\n  setTarget(target) {\n    this._target = target;\n    this._logger?.setTarget(target);\n  }\n  /**\n   * Returns the current `<media-player>` element. This method will attempt to find the player by\n   * searching up from either the given `target` or default target set via `remote.setTarget`.\n   *\n   * @example\n   * ```ts\n   * const player = remote.getPlayer();\n   * ```\n   */\n  getPlayer(target) {\n    if (this._player)\n      return this._player;\n    (target ?? this._target)?.dispatchEvent(\n      new DOMEvent(\"find-media-player\", {\n        detail: (player) => void (this._player = player),\n        bubbles: true,\n        composed: true\n      })\n    );\n    return this._player;\n  }\n  /**\n   * Set the current `<media-player>` element so the remote can support toggle methods such as\n   * `togglePaused` as they rely on the current media state.\n   */\n  setPlayer(player) {\n    this._player = player;\n  }\n  /**\n   * Dispatch a request to start the media loading process. This will only work if the media\n   * player has been initialized with a custom loading strategy `<media-player load=\"custom\">`.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/loading#loading-strategies}\n   */\n  startLoading(trigger) {\n    this._dispatchRequest(\"media-start-loading\", trigger);\n  }\n  /**\n   * Dispatch a request to begin/resume media playback.\n   */\n  play(trigger) {\n    this._dispatchRequest(\"media-play-request\", trigger);\n  }\n  /**\n   * Dispatch a request to pause media playback.\n   */\n  pause(trigger) {\n    this._dispatchRequest(\"media-pause-request\", trigger);\n  }\n  /**\n   * Dispatch a request to set the media volume to mute (0).\n   */\n  mute(trigger) {\n    this._dispatchRequest(\"media-mute-request\", trigger);\n  }\n  /**\n   * Dispatch a request to unmute the media volume and set it back to it's previous state.\n   */\n  unmute(trigger) {\n    this._dispatchRequest(\"media-unmute-request\", trigger);\n  }\n  /**\n   * Dispatch a request to enter fullscreen.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  enterFullscreen(target, trigger) {\n    this._dispatchRequest(\"media-enter-fullscreen-request\", trigger, target);\n  }\n  /**\n   * Dispatch a request to exit fullscreen.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  exitFullscreen(target, trigger) {\n    this._dispatchRequest(\"media-exit-fullscreen-request\", trigger, target);\n  }\n  /**\n   * Dispatch a request to enter picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  enterPictureInPicture(trigger) {\n    this._dispatchRequest(\"media-enter-pip-request\", trigger);\n  }\n  /**\n   * Dispatch a request to exit picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  exitPictureInPicture(trigger) {\n    this._dispatchRequest(\"media-exit-pip-request\", trigger);\n  }\n  /**\n   * Notify the media player that a seeking process is happening and to seek to the given `time`.\n   */\n  seeking(time, trigger) {\n    this._dispatchRequest(\"media-seeking-request\", trigger, time);\n  }\n  /**\n   * Notify the media player that a seeking operation has completed and to seek to the given `time`.\n   * This is generally called after a series of `remote.seeking()` calls.\n   */\n  seek(time, trigger) {\n    this._dispatchRequest(\"media-seek-request\", trigger, time);\n  }\n  seekToLiveEdge(trigger) {\n    this._dispatchRequest(\"media-live-edge-request\", trigger);\n  }\n  /**\n   * Dispatch a request to update the media volume to the given `volume` level which is a value\n   * between 0 and 1.\n   *\n   * @example\n   * ```ts\n   * remote.changeVolume(0); // 0%\n   * remote.changeVolume(0.05); // 5%\n   * remote.changeVolume(0.5); // 50%\n   * remote.changeVolume(0.75); // 70%\n   * remote.changeVolume(1); // 100%\n   * ```\n   */\n  changeVolume(volume, trigger) {\n    this._dispatchRequest(\"media-volume-change-request\", trigger, Math.max(0, Math.min(1, volume)));\n  }\n  /**\n   * Dispatch a request to change the current audio track.\n   *\n   * @example\n   * ```ts\n   * remote.changeAudioTrack(1); // track at index 1\n   * ```\n   */\n  changeAudioTrack(index, trigger) {\n    this._dispatchRequest(\"media-audio-track-change-request\", trigger, index);\n  }\n  /**\n   * Dispatch a request to change the video quality. The special value `-1` represents auto quality\n   * selection.\n   *\n   * @example\n   * ```ts\n   * remote.changeQuality(-1); // auto\n   * remote.changeQuality(1); // quality at index 1\n   * ```\n   */\n  changeQuality(index, trigger) {\n    this._dispatchRequest(\"media-quality-change-request\", trigger, index);\n  }\n  /**\n   * Dispatch a request to change the mode of the text track at the given index.\n   *\n   * @example\n   * ```ts\n   * remote.changeTextTrackMode(1, 'showing'); // track at index 1\n   * ```\n   */\n  changeTextTrackMode(index, mode, trigger) {\n    this._dispatchRequest(\"media-text-track-change-request\", trigger, {\n      index,\n      mode\n    });\n  }\n  /**\n   * Dispatch a request to change the media playback rate.\n   *\n   * @example\n   * ```ts\n   * remote.changePlaybackRate(0.5); // Half the normal speed\n   * remote.changePlaybackRate(1); // Normal speed\n   * remote.changePlaybackRate(1.5); // 50% faster than normal\n   * remote.changePlaybackRate(2); // Double the normal speed\n   * ```\n   */\n  changePlaybackRate(rate, trigger) {\n    this._dispatchRequest(\"media-rate-change-request\", trigger, rate);\n  }\n  /**\n   * Dispatch a request to resume user idle tracking. Refer to {@link MediaRemoteControl.pauseUserIdle}\n   * for more information.\n   */\n  resumeUserIdle(trigger) {\n    this._dispatchRequest(\"media-resume-user-idle-request\", trigger);\n  }\n  /**\n   * Dispatch a request to pause user idle tracking. Pausing tracking will result in the `user-idle`\n   * attribute and state being `false` until `remote.resumeUserIdle()` is called. This method\n   * is generally used when building custom controls and you'd like to prevent the UI from\n   * dissapearing.\n   *\n   * @example\n   * ```ts\n   * // Prevent user idling while menu is being interacted with.\n   * function onSettingsOpen() {\n   *   remote.pauseUserIdle();\n   * }\n   *\n   * function onSettingsClose() {\n   *   remote.resumeUserIdle();\n   * }\n   * ```\n   */\n  pauseUserIdle(trigger) {\n    this._dispatchRequest(\"media-pause-user-idle-request\", trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media playback state.\n   */\n  togglePaused(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.togglePaused.name);\n      return;\n    }\n    if (player.state.paused)\n      this.play(trigger);\n    else\n      this.pause(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the user idle state.\n   */\n  toggleUserIdle(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleUserIdle.name);\n      return;\n    }\n    player.user.idle(!player.user.idling, 0, trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media muted state.\n   */\n  toggleMuted(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleMuted.name);\n      return;\n    }\n    if (player.state.muted)\n      this.unmute(trigger);\n    else\n      this.mute(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media fullscreen state.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  toggleFullscreen(target, trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleFullscreen.name);\n      return;\n    }\n    if (player.state.fullscreen)\n      this.exitFullscreen(target, trigger);\n    else\n      this.enterFullscreen(target, trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  togglePictureInPicture(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.togglePictureInPicture.name);\n      return;\n    }\n    if (player.state.pictureInPicture)\n      this.exitPictureInPicture(trigger);\n    else\n      this.enterPictureInPicture(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the current captions mode.\n   */\n  toggleCaptions(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleCaptions.name);\n      return;\n    }\n    const tracks = player.state.textTracks, track = player.state.textTrack;\n    if (track) {\n      const index = tracks.indexOf(track);\n      this.changeTextTrackMode(index, \"disabled\", trigger);\n      this._prevTrackIndex = index;\n    } else {\n      let index = this._prevTrackIndex;\n      if (!tracks[index] || !isTrackCaptionKind(tracks[index])) {\n        index = -1;\n      }\n      if (index === -1) {\n        index = tracks.findIndex((track2) => isTrackCaptionKind(track2) && track2.default);\n      }\n      if (index === -1) {\n        index = tracks.findIndex((track2) => isTrackCaptionKind(track2));\n      }\n      if (index >= 0)\n        this.changeTextTrackMode(index, \"showing\", trigger);\n      this._prevTrackIndex = -1;\n    }\n  }\n  _dispatchRequest(type, trigger, detail) {\n    const request = new DOMEvent(type, {\n      bubbles: true,\n      composed: true,\n      detail,\n      trigger\n    });\n    const shouldUsePlayer = trigger?.target && (trigger.target === document || trigger.target === window || trigger.target === document.body || this._player && !this._player.contains(trigger.target));\n    const target = shouldUsePlayer ? this._target ?? this.getPlayer() : trigger?.target ?? this._target;\n    {\n      this._logger?.infoGroup(`\\u{1F4E8} dispatching \\`${type}\\``).labelledLog(\"Target\", target).labelledLog(\"Player\", this._player).labelledLog(\"Request Event\", request).labelledLog(\"Trigger Event\", trigger).dispatch();\n    }\n    target?.dispatchEvent(request);\n  }\n  _noPlayerWarning(method) {\n    {\n      console.warn(\n        `[vidstack] attempted to call \\`MediaRemoteControl.${method}\\`() that requires player but failed because remote could not find a parent player element from target`\n      );\n    }\n  }\n}\n\nclass ThumbnailsLoader extends ComponentController {\n  _media;\n  onConnect() {\n    this._media = useMedia();\n    effect(this._onLoadCues.bind(this));\n  }\n  _onLoadCues() {\n    const { canLoad, thumbnailCues } = this._media.$store;\n    if (!canLoad())\n      return;\n    const controller = new AbortController(), { crossorigin, thumbnails } = this._media.$store;\n    const src = thumbnails();\n    if (!src)\n      return;\n    import('media-captions').then(({ parseResponse }) => {\n      parseResponse(\n        fetch(src, {\n          signal: controller.signal,\n          credentials: getRequestCredentials(crossorigin())\n        })\n      ).then(({ cues }) => thumbnailCues.set(cues)).catch(noop);\n    });\n    return () => {\n      controller.abort();\n      thumbnailCues.set([]);\n    };\n  }\n}\n\nclass AudioTrackList extends SelectList {\n  getById(id) {\n    if (id === \"\")\n      return null;\n    return this._items.find((track) => track.id === id) ?? null;\n  }\n}\n\nclass NativeTextRenderer {\n  priority = 0;\n  _display = true;\n  _video = null;\n  _track = null;\n  _tracks = /* @__PURE__ */ new Set();\n  canRender() {\n    return true;\n  }\n  attach(video) {\n    this._video = video;\n    video.textTracks.onchange = this._onChange.bind(this);\n  }\n  addTrack(track) {\n    this._tracks.add(track);\n    this._attachTrack(track);\n  }\n  removeTrack(track) {\n    track[TEXT_TRACK_NATIVE]?.remove?.();\n    track[TEXT_TRACK_NATIVE] = null;\n    this._tracks.delete(track);\n  }\n  changeTrack(track) {\n    const current = track?.[TEXT_TRACK_NATIVE];\n    if (current && current.track.mode !== \"showing\") {\n      current.track.mode = \"showing\";\n    }\n    this._track = track;\n  }\n  setDisplay(display) {\n    this._display = display;\n    this._onChange();\n  }\n  detach() {\n    if (this._video)\n      this._video.textTracks.onchange = null;\n    for (const track of this._tracks)\n      this.removeTrack(track);\n    this._tracks.clear();\n    this._video = null;\n    this._track = null;\n  }\n  _attachTrack(track) {\n    if (!this._video)\n      return;\n    const el = track[TEXT_TRACK_NATIVE] ??= this._createTrackElement(track);\n    if (el instanceof HTMLElement) {\n      this._video.append(el);\n      el.track.mode = el.default ? \"showing\" : \"hidden\";\n    }\n  }\n  _createTrackElement(track) {\n    const el = document.createElement(\"track\"), isDefault = track.default || track.mode === \"showing\", isSupported = track.src && track.type === \"vtt\";\n    el.id = track.id;\n    el.src = isSupported ? track.src : \"https://cdn.jsdelivr.net/npm/vidstack@0.6.12/empty.vtt\";\n    el.label = track.label;\n    el.kind = track.kind;\n    el.default = isDefault;\n    track.language && (el.srclang = track.language);\n    if (isDefault && !isSupported) {\n      this._copyCues(track, el.track);\n    }\n    return el;\n  }\n  _copyCues(track, native) {\n    if (track.src && track.type === \"vtt\" || native.cues?.length)\n      return;\n    for (const cue of track.cues)\n      native.addCue(cue);\n  }\n  _onChange(event) {\n    for (const track of this._tracks) {\n      const nativeTrack = track[TEXT_TRACK_NATIVE]?.track;\n      if (!nativeTrack)\n        continue;\n      if (!this._display) {\n        nativeTrack.mode = \"disabled\";\n        continue;\n      }\n      const isShowing = nativeTrack.mode === \"showing\";\n      if (isShowing)\n        this._copyCues(track, nativeTrack);\n      track.setMode(isShowing ? \"showing\" : \"disabled\", event);\n    }\n  }\n}\n\nclass TextRenderers {\n  constructor(_media) {\n    this._media = _media;\n    const textTracks = _media.textTracks;\n    this._textTracks = textTracks;\n    effect(this._watchControls.bind(this));\n    onDispose(this._detach.bind(this));\n    listenEvent(textTracks, \"add\", this._onAddTrack.bind(this));\n    listenEvent(textTracks, \"remove\", this._onRemoveTrack.bind(this));\n    listenEvent(textTracks, \"mode-change\", this._update.bind(this));\n  }\n  _video = null;\n  _textTracks;\n  _renderers = [];\n  _nativeDisplay = false;\n  _nativeRenderer = null;\n  _customRenderer = null;\n  _watchControls() {\n    const { $store, $iosControls } = this._media;\n    this._nativeDisplay = $store.controls() || $iosControls();\n    this._update();\n  }\n  add(renderer) {\n    this._renderers.push(renderer);\n    this._update();\n  }\n  remove(renderer) {\n    renderer.detach();\n    this._renderers.splice(this._renderers.indexOf(renderer), 1);\n    this._update();\n  }\n  /* @internal */\n  [ATTACH_VIDEO](video) {\n    requestAnimationFrame(() => {\n      this._video = video;\n      if (video) {\n        this._nativeRenderer = new NativeTextRenderer();\n        this._nativeRenderer.attach(video);\n        for (const track of this._textTracks)\n          this._addNativeTrack(track);\n      }\n      this._update();\n    });\n  }\n  _addNativeTrack(track) {\n    if (!isTrackCaptionKind(track))\n      return;\n    this._nativeRenderer?.addTrack(track);\n  }\n  _removeNativeTrack(track) {\n    if (!isTrackCaptionKind(track))\n      return;\n    this._nativeRenderer?.removeTrack(track);\n  }\n  _onAddTrack(event) {\n    this._addNativeTrack(event.detail);\n  }\n  _onRemoveTrack(event) {\n    this._removeNativeTrack(event.detail);\n  }\n  _update() {\n    if (!this._video) {\n      this._detach();\n      return;\n    }\n    const currentTrack = this._textTracks.selected;\n    if (this._nativeDisplay || currentTrack?.[TEXT_TRACK_NATIVE_HLS]) {\n      this._customRenderer?.changeTrack(null);\n      this._nativeRenderer.setDisplay(true);\n      this._nativeRenderer.changeTrack(currentTrack);\n      return;\n    }\n    this._nativeRenderer.setDisplay(false);\n    this._nativeRenderer.changeTrack(null);\n    if (!currentTrack) {\n      this._customRenderer?.changeTrack(null);\n      return;\n    }\n    const customRenderer = this._renderers.sort((a, b) => a.priority - b.priority).find((loader) => loader.canRender(currentTrack));\n    if (this._customRenderer !== customRenderer) {\n      this._customRenderer?.detach();\n      customRenderer?.attach(this._video);\n      this._customRenderer = customRenderer ?? null;\n    }\n    customRenderer?.changeTrack(currentTrack);\n  }\n  _detach() {\n    this._nativeRenderer?.detach();\n    this._nativeRenderer = null;\n    this._customRenderer?.detach();\n    this._customRenderer = null;\n  }\n}\n\nclass TextTrackList extends List {\n  _canLoad = false;\n  _defaults = {};\n  /** @internal */\n  [TEXT_TRACK_CROSSORIGIN];\n  get selected() {\n    const track = this._items.find((t) => t.mode === \"showing\" && isTrackCaptionKind(t));\n    return track ?? null;\n  }\n  add(init, trigger) {\n    const isTrack = init instanceof TextTrack, track = isTrack ? init : new TextTrack(init);\n    if (this._defaults[init.kind] && init.default)\n      delete init.default;\n    track.addEventListener(\"mode-change\", this._onTrackModeChangeBind);\n    this[LIST_ADD](track, trigger);\n    track[TEXT_TRACK_CROSSORIGIN] = this[TEXT_TRACK_CROSSORIGIN];\n    if (this._canLoad)\n      track[TEXT_TRACK_CAN_LOAD]();\n    if (init.default) {\n      this._defaults[init.kind] = track;\n      track.mode = \"showing\";\n    }\n    return this;\n  }\n  remove(track, trigger) {\n    if (!this._items.includes(track))\n      return;\n    if (track === this._defaults[track.kind])\n      delete this._defaults[track.kind];\n    track.mode = \"disabled\";\n    track[TEXT_TRACK_ON_MODE_CHANGE] = null;\n    track.removeEventListener(\"mode-change\", this._onTrackModeChangeBind);\n    this[LIST_REMOVE](track, trigger);\n    return this;\n  }\n  clear(trigger) {\n    for (const track of this._items)\n      this.remove(track, trigger);\n    return this;\n  }\n  getById(id) {\n    return this._items.find((track) => track.id === id) ?? null;\n  }\n  getByKind(kind) {\n    const kinds = Array.isArray(kind) ? kind : [kind];\n    return this._items.filter((track) => kinds.includes(track.kind));\n  }\n  /* @internal */\n  [TEXT_TRACK_CAN_LOAD]() {\n    if (this._canLoad)\n      return;\n    for (const track of this._items)\n      track[TEXT_TRACK_CAN_LOAD]();\n    this._canLoad = true;\n  }\n  _onTrackModeChangeBind = this._onTrackModeChange.bind(this);\n  _onTrackModeChange(event) {\n    const track = event.detail;\n    if (track.mode === \"showing\") {\n      const kinds = isTrackCaptionKind(track) ? [\"captions\", \"subtitles\"] : [track.kind];\n      for (const t of this._items) {\n        if (t.mode === \"showing\" && t != track && kinds.includes(t.kind)) {\n          t.mode = \"disabled\";\n        }\n      }\n    }\n    this.dispatchEvent(\n      new DOMEvent(\"mode-change\", {\n        detail: event.detail,\n        trigger: event\n      })\n    );\n  }\n}\n\nlet warned = /* @__PURE__ */ new Set() ;\nclass SourceSelection {\n  constructor(_domSources, _media, _loader) {\n    this._domSources = _domSources;\n    this._media = _media;\n    this._loader = _loader;\n    const HLS_LOADER = new HLSProviderLoader(), VIDEO_LOADER = new VideoProviderLoader(), AUDIO_LOADER = new AudioProviderLoader();\n    this._loaders = computed(() => {\n      return _media.$props.preferNativeHLS() ? [VIDEO_LOADER, AUDIO_LOADER, HLS_LOADER] : [HLS_LOADER, VIDEO_LOADER, AUDIO_LOADER];\n    });\n    effect(this._onSourcesChange.bind(this));\n    effect(this._onSourceChange.bind(this));\n    effect(this._onPreconnect.bind(this));\n    effect(this._onLoadSource.bind(this));\n  }\n  _loaders;\n  _onSourcesChange() {\n    this._media.delegate._dispatch(\"sources-change\", {\n      detail: [...normalizeSrc(this._media.$props.src()), ...this._domSources()]\n    });\n  }\n  _onSourceChange() {\n    const { $store } = this._media;\n    const sources = $store.sources(), currentSource = peek($store.source), newSource = this._findNewSource(currentSource, sources), noMatch = sources[0]?.src && !newSource.src && !newSource.type;\n    if (noMatch && !warned.has(newSource.src) && !peek(this._loader)) {\n      const source = sources[0];\n      console.warn(\n        `[vidstack] could not find a loader for any of the given media sources, consider providing \\`type\\`:\n\n<media-outlet>\n  <source src=\"${source.src}\" type=\"video/mp4\" />\n</media-outlet>\"\n\nFalling back to fetching source headers...`\n      );\n      warned.add(newSource.src);\n    }\n    if (noMatch) {\n      const { crossorigin } = $store, credentials = getRequestCredentials(crossorigin()), abort = new AbortController();\n      Promise.all(\n        sources.map(\n          (source) => isString(source.src) && source.type === \"?\" ? fetch(source.src, {\n            method: \"HEAD\",\n            credentials,\n            signal: abort.signal\n          }).then((res) => {\n            source.type = res.headers.get(\"content-type\") || \"??\";\n            return source;\n          }).catch(() => source) : source\n        )\n      ).then((sources2) => {\n        if (abort.signal.aborted)\n          return;\n        this._findNewSource(peek($store.source), sources2);\n        tick();\n      });\n      return () => abort.abort();\n    }\n    tick();\n  }\n  _findNewSource(currentSource, sources) {\n    let newSource = { src: \"\", type: \"\" }, newLoader = null;\n    for (const src of sources) {\n      const loader = peek(this._loaders).find((loader2) => loader2.canPlay(src));\n      if (loader) {\n        newSource = src;\n        newLoader = loader;\n      }\n    }\n    this._notifySourceChange(currentSource, newSource, newLoader);\n    this._notifyLoaderChange(peek(this._loader), newLoader);\n    return newSource;\n  }\n  _notifySourceChange(currentSource, newSource, newLoader) {\n    if (newSource.src === currentSource.src && newSource.type === currentSource.type)\n      return;\n    this._media.delegate._dispatch(\"source-change\", { detail: newSource });\n    this._media.delegate._dispatch(\"media-type-change\", {\n      detail: newLoader?.mediaType(newSource) || \"unknown\"\n    });\n  }\n  _notifyLoaderChange(currentLoader, newLoader) {\n    if (newLoader === currentLoader)\n      return;\n    this._media.delegate._dispatch(\"provider-change\", { detail: null });\n    newLoader && peek(() => newLoader.preconnect?.(this._media));\n    this._loader.set(newLoader);\n    this._media.delegate._dispatch(\"provider-loader-change\", { detail: newLoader });\n  }\n  _onPreconnect() {\n    const provider = this._media.$provider();\n    if (!provider)\n      return;\n    if (this._media.$store.canLoad()) {\n      peek(\n        () => provider.setup({\n          ...this._media,\n          player: this._media.player\n        })\n      );\n      return;\n    }\n    peek(() => provider.preconnect?.(this._media));\n  }\n  _onLoadSource() {\n    const provider = this._media.$provider(), source = this._media.$store.source();\n    if (this._media.$store.canLoad()) {\n      peek(() => provider?.loadSource(source, peek(this._media.$store.preload)));\n      return;\n    }\n    try {\n      isString(source.src) && preconnect(new URL(source.src).origin, \"preconnect\");\n    } catch (e) {\n      {\n        this._media.logger?.infoGroup(`Failed to preconnect to source: ${source.src}`).labelledLog(\"Error\", e).dispatch();\n      }\n    }\n  }\n}\nfunction normalizeSrc(src) {\n  return (isArray(src) ? src : [!isString(src) && \"src\" in src ? src : { src }]).map(\n    ({ src: src2, type }) => ({\n      src: src2,\n      type: type ?? (!isString(src2) || src2.startsWith(\"blob:\") ? \"video/object\" : \"?\")\n    })\n  );\n}\n\nclass Tracks {\n  constructor(_domTracks, _media) {\n    this._domTracks = _domTracks;\n    this._media = _media;\n    effect(this._onTracksChange.bind(this));\n  }\n  _prevTracks = [];\n  _onTracksChange() {\n    const newTracks = [...this._media.$props.textTracks(), ...this._domTracks()];\n    for (const oldTrack of this._prevTracks) {\n      if (!newTracks.some((t) => t.id === oldTrack.id)) {\n        const track = oldTrack.id && this._media.textTracks.getById(oldTrack.id);\n        if (track)\n          this._media.textTracks.remove(track);\n      }\n    }\n    for (const newTrack of newTracks) {\n      const id = newTrack.id || TextTrack.createId(newTrack);\n      if (!this._media.textTracks.getById(id)) {\n        newTrack.id = id;\n        this._media.textTracks.add(newTrack);\n      }\n    }\n    this._prevTracks = newTracks;\n  }\n}\n\nclass Outlet extends Component {\n  static el = defineElement({\n    tagName: \"media-outlet\"\n  });\n  _media;\n  _domSources = signal([]);\n  _domTracks = signal([]);\n  _loader = signal(null);\n  constructor(instance) {\n    super(instance);\n    this._media = useMedia();\n    new SourceSelection(this._domSources, this._media, this._loader);\n    new Tracks(this._domTracks, this._media);\n  }\n  onAttach(el) {\n    el.setAttribute(\"keep-alive\", \"\");\n  }\n  onConnect(el) {\n    const resize = new ResizeObserver(animationFrameThrottle(this._onResize.bind(this)));\n    resize.observe(el);\n    const mutation = new MutationObserver(this._onMutation.bind(this));\n    mutation.observe(el, { attributes: true, childList: true });\n    if (IS_SAFARI) {\n      listenEvent(el, \"touchstart\", (e) => e.preventDefault(), { passive: false });\n    }\n    scopedRaf(() => {\n      this._onResize();\n      this._onMutation();\n    });\n    return () => {\n      resize.disconnect();\n      mutation.disconnect();\n    };\n  }\n  onDestroy() {\n    this._media.$store.currentTime.set(0);\n  }\n  _onResize() {\n    const player = this._media.player, width = this.el.offsetWidth, height = this.el.offsetHeight;\n    if (!player)\n      return;\n    player.$store.mediaWidth.set(width);\n    player.$store.mediaHeight.set(height);\n    setStyle(player, \"--media-width\", width + \"px\");\n    setStyle(player, \"--media-height\", height + \"px\");\n  }\n  _onMutation() {\n    const sources = [], tracks = [], children = this.el.children;\n    for (const el of children) {\n      if (el instanceof HTMLSourceElement) {\n        sources.push({\n          src: el.src,\n          type: el.type\n        });\n      } else if (el instanceof HTMLTrackElement) {\n        tracks.push({\n          id: el.id,\n          src: el.src,\n          kind: el.track.kind,\n          language: el.srclang,\n          label: el.label,\n          default: el.default,\n          type: el.getAttribute(\"data-type\")\n        });\n      }\n    }\n    this._domSources.set(sources);\n    this._domTracks.set(tracks);\n    tick();\n  }\n  render() {\n    let currentProvider;\n    onDispose(() => currentProvider?.destroy?.());\n    return () => {\n      currentProvider?.destroy();\n      const loader = this._loader();\n      if (!loader)\n        return null;\n      const el = loader.render(this._media.$store);\n      {\n        peek(() => {\n          loader.load(this._media).then((provider) => {\n            if (peek(this._loader) !== loader)\n              return;\n            this._media.delegate._dispatch(\"provider-change\", {\n              detail: provider\n            });\n            currentProvider = provider;\n          });\n        });\n      }\n      return el;\n    };\n  }\n}\n\nclass LibASSTextRenderer {\n  constructor(loader, config) {\n    this.loader = loader;\n    this.config = config;\n  }\n  priority = 1;\n  _instance = null;\n  _track = null;\n  _typeRE = /(ssa|ass)$/;\n  canRender(track) {\n    return !!track.src && (isString(track.type) && this._typeRE.test(track.type) || this._typeRE.test(track.src));\n  }\n  attach(video) {\n    this.loader().then(async (mod) => {\n      this._instance = new mod.default({\n        ...this.config,\n        video,\n        subUrl: this._track?.src || \"\"\n      });\n      listenEvent(this._instance, \"ready\", () => {\n        const canvas = this._instance?._canvas;\n        if (canvas)\n          canvas.style.pointerEvents = \"none\";\n      });\n      listenEvent(this._instance, \"error\", (event) => {\n        if (this._track) {\n          this._track[TEXT_TRACK_READY_STATE] = 3;\n          this._track.dispatchEvent(\n            new DOMEvent(\"error\", {\n              trigger: event,\n              detail: event.error\n            })\n          );\n        }\n      });\n    });\n  }\n  changeTrack(track) {\n    if (!track || track.readyState === 3) {\n      this._freeTrack();\n    } else if (this._track !== track) {\n      this._instance?.setTrackByUrl(track.src);\n      this._track = track;\n    }\n  }\n  detach() {\n    this._freeTrack();\n  }\n  _freeTrack() {\n    this._instance?.freeTrack();\n    this._track = null;\n  }\n}\n\nclass ARIAKeyShortcuts extends ComponentController {\n  constructor(instance, _shortcut) {\n    super(instance);\n    this._shortcut = _shortcut;\n  }\n  onAttach(el) {\n    const { $props, ariaKeys } = useMedia(), keys = el.getAttribute(\"aria-keyshortcuts\");\n    if (keys) {\n      ariaKeys[this._shortcut] = keys;\n      {\n        onDispose(() => {\n          delete ariaKeys[this._shortcut];\n        });\n      }\n      return;\n    }\n    const shortcuts = $props.keyShortcuts()[this._shortcut];\n    if (shortcuts)\n      el.setAttribute(\"aria-keyshortcuts\", shortcuts);\n  }\n}\n\nexport { canUsePictureInPicture as $, ARIAKeyShortcuts as A, IS_IPHONE as B, MEDIA_ATTRIBUTES as C, canFullscreen as D, MediaRemoteControl as E, MediaRequestContext as F, ENABLE_AUTO_QUALITY as G, TextTrack as H, IS_SAFARI as I, TEXT_TRACK_READY_STATE as J, TEXT_TRACK_ON_MODE_CHANGE as K, LIST_SELECT as L, MediaStoreFactory as M, SET_AUTO_QUALITY as N, Outlet as O, LIST_ADD as P, IS_CHROME as Q, coerceToError as R, ScreenOrientationController as S, TextTrackList as T, loadScript as U, VideoQualityList as V, isHLSSupported as W, LIST_REMOVE as X, canPlayHLSNatively as Y, TEXT_TRACK_NATIVE as Z, TEXT_TRACK_NATIVE_HLS as _, setAttributeIfEmpty as a, canUseVideoPresentation as a0, ATTACH_VIDEO as a1, MediaUserController as a2, MEDIA_KEY_SHORTCUTS as a3, List as a4, FullscreenController as a5, softResetMediaStore as a6, TimeRange as a7, getTimeRangesStart as a8, getTimeRangesEnd as a9, LibASSTextRenderer as aa, setARIALabel as b, findActiveCue as c, canChangeVolume as d, onTrackChapterChange as e, functionThrottle as f, isElementParent as g, isCueActive as h, isTrackCaptionKind as i, MediaStoreSync as j, AudioTrackList as k, TEXT_TRACK_CROSSORIGIN as l, mediaPlayerProps as m, TextRenderers as n, onPress as o, preconnect as p, mediaContext as q, MediaKeyboardController as r, scopedRaf as s, ThumbnailsLoader as t, useMedia as u, MediaEventsLogger as v, MediaStateManager as w, MediaRequestManager as x, MediaPlayerDelegate as y, MediaLoadController as z };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}